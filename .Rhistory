delte <- subset(ceps,schids == ceps1[1])
#遍历抽中的学校id，纵向合并数据框
for (i in ceps1) delte <- rbind(delte, subset(ceps,schids == i))
#箱线图
delte$schids <- as.factor(delte$schids)
ggplot(delte, aes(schids,stdmat)) +
geom_boxplot(size=0.1,outlier.colour ='sky blue',fill='sky blue') +
xlab('学校代码') + ylab('数学原始成绩')+
theme_bw()
#setwd("E:/edu/data2")
library(readr)
#ceps <- read_dta('C:/Users/xsong/Desktop/table/cepscleaned.dta')
ceps <- read_csv("C:/Users/xsong/Desktop/table/cepscleaned.csv")
#ceps$schids <- as.numeric(ceps$schids)
#ceps$schids <- ceps$schids %>% formatC(.,format="g")
ceps1 <- ceps %>%
group_by(schids) %>%
summarize(mathmean = mean(stdmat,na.rm = T))
set.seed(2018)
sample <- sample(1:nrow(ceps1),30,replace = F)#随机抽取30个学校
ceps1 <- ceps1[sample,]
ceps1 <- ceps1$schids #提取抽中学校编号的向量
delte <- subset(ceps,schids == ceps1[1])
#遍历抽中的学校id，纵向合并数据框
for (i in ceps1) delte <- rbind(delte, subset(ceps,schids == i))
#箱线图
delte$schids <- as.factor(delte$schids)
ggplot(delte, aes(schids,stdmat)) +
geom_boxplot(size=0.1,outlier.colour ='sky blue',fill='sky blue') +
xlab('学校代码') + ylab('数学原始成绩')+
theme_bw()
ceps1 <- ceps %>%
group_by(schids) %>%
summarize(mathmean = mean(stdmat,na.rm = T))
set.seed(2018)
sample <- sample(1:nrow(ceps1),30,replace = F)#随机抽取30个学校
ceps1 <- ceps1[sample,]
ceps1 <- ceps1$schids #提取抽中学校编号的向量
delte <- subset(ceps,schids == ceps1[1])
#遍历抽中的学校id，纵向合并数据框
for (i in ceps1) delte <- rbind(delte, subset(ceps,schids == i))
#箱线图
delte$schids <- as.factor(delte$schids)
box1 <- ggplot(delte, aes(schids,stdmat)) +
geom_boxplot(size=0.1,outlier.colour ='sky blue',fill='sky blue') +
xlab('学校代码') + ylab('数学原始成绩')+
theme_bw()
#setwd("E:/edu/data2")
library(readr)
#ceps <- read_dta('C:/Users/xsong/Desktop/table/cepscleaned.dta')
ceps <- read_csv("C:/Users/xsong/Desktop/table/cepscleaned.csv")
#ceps$schids <- as.numeric(ceps$schids)
#ceps$schids <- ceps$schids %>% formatC(.,format="g")
ceps1 <- ceps %>%
group_by(schids) %>%
summarize(mathmean = mean(stdmat,na.rm = T))
set.seed(2018)
sample <- sample(1:nrow(ceps1),30,replace = F)#随机抽取30个学校
ceps1 <- ceps1[sample,]
ceps1 <- ceps1$schids #提取抽中学校编号的向量
delte <- subset(ceps,schids == ceps1[1])
#遍历抽中的学校id，纵向合并数据框
for (i in ceps1) delte <- rbind(delte, subset(ceps,schids == i))
#箱线图
delte$schids <- as.factor(delte$schids)
box1 <- ggplot(delte, aes(schids,stdmat)) +
geom_boxplot(size=0.1,outlier.colour ='sky blue',fill='sky blue') +
xlab('学校代码') + ylab('数学标准成绩')+
theme_bw()
ceps <- read_dta("E:/edu/data2/ceps.dta")
#ceps$schids <- as.numeric(ceps$schids)
#ceps$schids <- ceps$schids %>% formatC(.,format="g")
ceps1 <- ceps %>%
group_by(schids) %>%
summarize(mathmean = mean(stdmat,na.rm = T))
set.seed(2018)
sample <- sample(1:nrow(ceps1),30,replace = F)#随机抽取30个学校
ceps1 <- ceps1[sample,]
ceps1 <- ceps1$schids #提取抽中学校编号的向量
delte <- subset(ceps,schids == ceps1[1])
#遍历抽中的学校id，纵向合并数据框
for (i in ceps1) delte <- rbind(delte, subset(ceps,schids == i))
#箱线图
delte$schids <- as.factor(delte$schids)
box2 <- ggplot(delte, aes(schids,stdmat)) +
geom_boxplot(size=0.1,outlier.colour ='sky blue',fill='sky blue') +
xlab('学校代码') + ylab('数学原始成绩')+
theme_bw()
library(easyGgplot2)
multiplot <- ggplot2.multiplot(box2,box1)
multiplot
#setwd("E:/edu/data2")
library(readr)
#ceps <- read_dta('C:/Users/xsong/Desktop/table/cepscleaned.dta')
ceps <- read_csv("C:/Users/xsong/Desktop/table/cepscleaned.csv")
#ceps$schids <- as.numeric(ceps$schids)
#ceps$schids <- ceps$schids %>% formatC(.,format="g")
ceps1 <- ceps %>%
group_by(schids) %>%
summarize(mathmean = mean(stdmat,na.rm = T))
set.seed(2018)
sample <- sample(1:nrow(ceps1),30,replace = F)#随机抽取30个学校
ceps1 <- ceps1[sample,]
ceps1 <- ceps1$schids #提取抽中学校编号的向量
delte <- subset(ceps,schids == ceps1[1])
#遍历抽中的学校id，纵向合并数据框
for (i in ceps1) delte <- rbind(delte, subset(ceps,schids == i))
#箱线图
delte$schids <- as.factor(delte$schids)
box1 <- ggplot(delte, aes(schids,stdmat)) +
geom_boxplot(size=0.1,outlier.colour ='sky blue',fill='sky blue') +
xlab('学校代码') + ylab('数学标准成绩')+
theme_bw()
ceps <- read_dta("E:/edu/data2/ceps.dta")
#ceps$schids <- as.numeric(ceps$schids)
#ceps$schids <- ceps$schids %>% formatC(.,format="g")
ceps1 <- ceps %>%
group_by(schids) %>%
summarize(mathmean = mean(tr_mat,na.rm = T))
set.seed(2018)
sample <- sample(1:nrow(ceps1),30,replace = F)#随机抽取30个学校
ceps1 <- ceps1[sample,]
ceps1 <- ceps1$schids #提取抽中学校编号的向量
delte <- subset(ceps,schids == ceps1[1])
#遍历抽中的学校id，纵向合并数据框
for (i in ceps1) delte <- rbind(delte, subset(ceps,schids == i))
#箱线图
delte$schids <- as.factor(delte$schids)
box2 <- ggplot(delte, aes(schids,tr_mat)) +
geom_boxplot(size=0.1,outlier.colour ='sky blue',fill='sky blue') +
xlab('学校代码') + ylab('数学原始成绩')+
theme_bw()
library(easyGgplot2)
gplot2.multiplot(box2,box1)
#setwd("E:/edu/data2")
library(readr)
#ceps <- read_dta('C:/Users/xsong/Desktop/table/cepscleaned.dta')
ceps <- read_csv("C:/Users/xsong/Desktop/table/cepscleaned.csv")
#ceps$schids <- as.numeric(ceps$schids)
#ceps$schids <- ceps$schids %>% formatC(.,format="g")
ceps1 <- ceps %>%
group_by(schids) %>%
summarize(mathmean = mean(stdmat,na.rm = T))
set.seed(2018)
sample <- sample(1:nrow(ceps1),30,replace = F)#随机抽取30个学校
ceps1 <- ceps1[sample,]
ceps1 <- ceps1$schids #提取抽中学校编号的向量
delte <- subset(ceps,schids == ceps1[1])
#遍历抽中的学校id，纵向合并数据框
for (i in ceps1) delte <- rbind(delte, subset(ceps,schids == i))
#箱线图
delte$schids <- as.factor(delte$schids)
box1 <- ggplot(delte, aes(schids,stdmat)) +
geom_boxplot(size=0.1,outlier.colour ='sky blue',fill='sky blue') +
xlab('学校代码') + ylab('数学标准成绩')+
theme_bw()
ceps <- read_dta("E:/edu/data2/ceps.dta")
#ceps$schids <- as.numeric(ceps$schids)
#ceps$schids <- ceps$schids %>% formatC(.,format="g")
ceps1 <- ceps %>%
group_by(schids) %>%
summarize(mathmean = mean(tr_mat,na.rm = T))
set.seed(2018)
sample <- sample(1:nrow(ceps1),30,replace = F)#随机抽取30个学校
ceps1 <- ceps1[sample,]
ceps1 <- ceps1$schids #提取抽中学校编号的向量
delte <- subset(ceps,schids == ceps1[1])
#遍历抽中的学校id，纵向合并数据框
for (i in ceps1) delte <- rbind(delte, subset(ceps,schids == i))
#箱线图
delte$schids <- as.factor(delte$schids)
box2 <- ggplot(delte, aes(schids,tr_mat)) +
geom_boxplot(size=0.1,outlier.colour ='sky blue',fill='sky blue') +
xlab('学校代码') + ylab('数学原始成绩')+
theme_bw()
library(easyGgplot2)
gglot2.multiplot(box2,box1)
library(easyGgplot2)
ggplot2.multiplot(box2,box1)
#setwd("E:/edu/data2")
library(readr)
#ceps <- read_dta('C:/Users/xsong/Desktop/table/cepscleaned.dta')
ceps <- read_csv("C:/Users/xsong/Desktop/table/cepscleaned.csv")
#ceps$schids <- as.numeric(ceps$schids)
#ceps$schids <- ceps$schids %>% formatC(.,format="g")
ceps1 <- ceps %>%
group_by(schids) %>%
summarize(mathmean = mean(stdmat,na.rm = T))
set.seed(2018)
sample <- sample(1:nrow(ceps1),30,replace = F)#随机抽取30个学校
ceps1 <- ceps1[sample,]
ceps1 <- ceps1$schids #提取抽中学校编号的向量
delte <- subset(ceps,schids == ceps1[1])
#遍历抽中的学校id，纵向合并数据框
for (i in ceps1) delte <- rbind(delte, subset(ceps,schids == i))
#箱线图
delte$schids <- as.factor(delte$schids)
box1 <- ggplot(delte, aes(schids,stdmat)) +
geom_boxplot(size=0.1,outlier.colour ='sky blue',fill='sky blue') +
xlab('学校代码') + ylab('数学标准成绩')+
theme_bw()
ceps <- read_dta("E:/edu/data2/ceps.dta")
#ceps$schids <- as.numeric(ceps$schids)
#ceps$schids <- ceps$schids %>% formatC(.,format="g")
ceps1 <- ceps %>%
group_by(schids) %>%
summarize(mathmean = mean(tr_mat,na.rm = T))
set.seed(2018)
sample <- sample(1:nrow(ceps1),30,replace = F)#随机抽取30个学校
ceps1 <- ceps1[sample,]
ceps1 <- ceps1$schids #提取抽中学校编号的向量
delte <- subset(ceps,schids == ceps1[1])
#遍历抽中的学校id，纵向合并数据框
for (i in ceps1) delte <- rbind(delte, subset(ceps,schids == i))
#箱线图
delte$schids <- as.factor(delte$schids)
box2 <- ggplot(delte, aes(schids,tr_mat)) +
geom_boxplot(size=0.1,outlier.colour ='sky blue',fill='sky blue') +
xlab('学校代码') + ylab('数学原始成绩')+
theme_bw()
library(easyGgplot2)
ggplot2.multiplot(box2,box1)
setwd("E:/edu/data2")
ceps <- read_dta("E:/edu/data2/ceps.dta")
ceps <- lapply(ceps, unclass)
ceps <- data.frame(ceps)
ceps$schids <- as.factor(ceps$schids)
ceps <- select(ceps,matgreat,matgrt,tr_mat,everything()) #排序变量
ceps$grade9 <- as.factor(ceps$grade9)
dus <- ggplot(ceps, aes(x = sdtotal,group=grade9,fill=grade9)) +
geom_histogram(density = 70)+
labs(x='总成绩',y='频数')+
theme_light()
#七年级和九年级的比较
shux <- ggplot(ceps, aes(x = sdtotal,group=grade9,fill=grade9,color=grade9)) +
geom_density(alpha=1/2) +
labs(x='总成绩',y='密度') +
theme_light()
library(easyGgplot2)
multiplot <- ggplot2.multiplot(dus,shux)
multiplot
#setwd("E:/edu/data2")
#ceps <- read_dta('C:/Users/xsong/Desktop/table/cepscleaned.dta')
ceps <- read_csv("C:/Users/xsong/Desktop/table/cepscleaned.csv")
#ceps$schids <- as.numeric(ceps$schids)
#ceps$schids <- ceps$schids %>% formatC(.,format="g")
ceps1 <- ceps %>%
group_by(schids) %>%
summarize(mathmean = mean(stdmat,na.rm = T))
set.seed(2018)
sample <- sample(1:nrow(ceps1),30,replace = F)#随机抽取30个学校
ceps1 <- ceps1[sample,]
ceps1 <- ceps1$schids #提取抽中学校编号的向量
delte <- subset(ceps,schids == ceps1[1])
#遍历抽中的学校id，纵向合并数据框
for (i in ceps1) delte <- rbind(delte, subset(ceps,schids == i))
#箱线图
delte$schids <- as.factor(delte$schids)
box1 <- ggplot(delte, aes(schids,stdmat)) +
geom_boxplot(size=0.1,outlier.colour ='sky blue',fill='sky blue') +
xlab('学校代码') + ylab('数学标准成绩')+
theme_bw()
ceps <- read_dta("E:/edu/data2/ceps.dta")
#ceps$schids <- as.numeric(ceps$schids)
#ceps$schids <- ceps$schids %>% formatC(.,format="g")
ceps1 <- ceps %>%
group_by(schids) %>%
summarize(mathmean = mean(tr_mat,na.rm = T))
set.seed(2018)
sample <- sample(1:nrow(ceps1),30,replace = F)#随机抽取30个学校
ceps1 <- ceps1[sample,]
ceps1 <- ceps1$schids #提取抽中学校编号的向量
delte <- subset(ceps,schids == ceps1[1])
#遍历抽中的学校id，纵向合并数据框
for (i in ceps1) delte <- rbind(delte, subset(ceps,schids == i))
#箱线图
delte$schids <- as.factor(delte$schids)
box2 <- ggplot(delte, aes(schids,tr_mat)) +
geom_boxplot(size=0.1,outlier.colour ='sky blue',fill='sky blue') +
xlab('学校代码') + ylab('数学原始成绩')+
theme_bw()
library(easyGgplot2)
ggplot2.multiplot(box2,box1)
View(box1)
View(box1)
remove.packages('knitr')
install.packages('knitr')
install.packages("knitr")
#setwd("E:/edu/data2")
#ceps <- read_dta('C:/Users/xsong/Desktop/table/cepscleaned.dta')
ceps <- read_csv("C:/Users/xsong/Desktop/table/cepscleaned.csv")
#ceps$schids <- as.numeric(ceps$schids)
#ceps$schids <- ceps$schids %>% formatC(.,format="g")
ceps1 <- ceps %>%
group_by(schids) %>%
summarize(mathmean = mean(stdmat,na.rm = T))
set.seed(2018)
sample <- sample(1:nrow(ceps1),30,replace = F)#随机抽取30个学校
ceps1 <- ceps1[sample,]
ceps1 <- ceps1$schids #提取抽中学校编号的向量
delte <- subset(ceps,schids == ceps1[1])
#遍历抽中的学校id，纵向合并数据框
for (i in ceps1) delte <- rbind(delte, subset(ceps,schids == i))
#箱线图
delte$schids <- as.factor(delte$schids)
box1 <- ggplot(delte, aes(schids,stdmat)) +
geom_boxplot(notch = T,size=0.1,outlier.colour ='sky blue',fill='sky blue') +
xlab('学校代码') + ylab('数学标准成绩')+
theme_bw()
ceps <- read_dta("E:/edu/data2/ceps.dta")
#ceps$schids <- as.numeric(ceps$schids)
#ceps$schids <- ceps$schids %>% formatC(.,format="g")
ceps1 <- ceps %>%
group_by(schids) %>%
summarize(mathmean = mean(tr_mat,na.rm = T))
set.seed(2018)
sample <- sample(1:nrow(ceps1),30,replace = F)#随机抽取30个学校
ceps1 <- ceps1[sample,]
ceps1 <- ceps1$schids #提取抽中学校编号的向量
delte <- subset(ceps,schids == ceps1[1])
#遍历抽中的学校id，纵向合并数据框
for (i in ceps1) delte <- rbind(delte, subset(ceps,schids == i))
#箱线图
delte$schids <- as.factor(delte$schids)
box2 <- ggplot(delte, aes(schids,tr_mat)) +
geom_boxplot(notch = T,size=0.1,outlier.colour ='sky blue',fill='sky blue') +
xlab('学校代码') + ylab('数学原始成绩')+
theme_bw()
library(easyGgplot2)
ggplot2.multiplot(box2,box1)
library(haven)
library(ggplot2)
library(dplyr)
library(plyr)
library(rpart)
library(rpart.plot)
library(pROC)
library(tidyr)
library(randomForest)
library(mice)
library(xgboost)
library(readr)
`%>%` <- magrittr::`%>%`
#setwd("E:/edu/data2")
#ceps <- read_dta('C:/Users/xsong/Desktop/table/cepscleaned.dta')
ceps <- read_csv("C:/Users/xsong/Desktop/table/cepscleaned.csv")
#ceps$schids <- as.numeric(ceps$schids)
#ceps$schids <- ceps$schids %>% formatC(.,format="g")
ceps1 <- ceps %>%
group_by(schids) %>%
summarize(mathmean = mean(stdmat,na.rm = T))
set.seed(2018)
sample <- sample(1:nrow(ceps1),30,replace = F)#随机抽取30个学校
ceps1 <- ceps1[sample,]
ceps1 <- ceps1$schids #提取抽中学校编号的向量
delte <- subset(ceps,schids == ceps1[1])
#遍历抽中的学校id，纵向合并数据框
for (i in ceps1) delte <- rbind(delte, subset(ceps,schids == i))
#箱线图
delte$schids <- as.factor(delte$schids)
box1 <- ggplot(delte, aes(schids,stdmat)) +
geom_boxplot(notch = T,size=0.1,outlier.colour ='sky blue',fill='sky blue') +
xlab('学校代码') + ylab('数学标准成绩')+
theme_bw()
ceps <- read_dta("E:/edu/data2/ceps.dta")
#ceps$schids <- as.numeric(ceps$schids)
#ceps$schids <- ceps$schids %>% formatC(.,format="g")
ceps1 <- ceps %>%
group_by(schids) %>%
summarize(mathmean = mean(tr_mat,na.rm = T))
set.seed(2018)
sample <- sample(1:nrow(ceps1),30,replace = F)#随机抽取30个学校
ceps1 <- ceps1[sample,]
ceps1 <- ceps1$schids #提取抽中学校编号的向量
delte <- subset(ceps,schids == ceps1[1])
#遍历抽中的学校id，纵向合并数据框
for (i in ceps1) delte <- rbind(delte, subset(ceps,schids == i))
#箱线图
delte$schids <- as.factor(delte$schids)
box2 <- ggplot(delte, aes(schids,tr_mat)) +
geom_boxplot(notch = T,size=0.1,outlier.colour ='sky blue',fill='sky blue') +
xlab('学校代码') + ylab('数学原始成绩')+
theme_bw()
library(easyGgplot2)
ggplot2.multiplot(box2,box1)
ggplot2.multiplot(box2,box1)
box1
ceps <- read_csv("C:/Users/xsong/Desktop/table/cepscleaned.csv")
#ceps$schids <- as.numeric(ceps$schids)
#ceps$schids <- ceps$schids %>% formatC(.,format="g")
ceps1 <- ceps %>%
group_by(schids) %>%
summarize(mathmean = mean(stdmat,na.rm = T))
set.seed(2018)
sample <- sample(1:nrow(ceps1),30,replace = F)#随机抽取30个学校
ceps1 <- ceps1[sample,]
ceps1 <- ceps1$schids #提取抽中学校编号的向量
delte <- subset(ceps,schids == ceps1[1])
#遍历抽中的学校id，纵向合并数据框
for (i in ceps1) delte <- rbind(delte, subset(ceps,schids == i))
#箱线图
delte$schids <- as.factor(delte$schids)
box1 <- ggplot(delte, aes(schids,stdmat)) +
geom_boxplot(notch = T,size=0.1,outlier.colour ='sky blue',fill='sky blue') +
xlab('学校代码') + ylab('数学标准成绩')+
theme_bw()
ceps <- read_dta("E:/edu/data2/ceps.dta")
#ceps$schids <- as.numeric(ceps$schids)
#ceps$schids <- ceps$schids %>% formatC(.,format="g")
ceps1 <- ceps %>%
group_by(schids) %>%
summarize(mathmean = mean(tr_mat,na.rm = T))
set.seed(2018)
sample <- sample(1:nrow(ceps1),30,replace = F)#随机抽取30个学校
ceps1 <- ceps1[sample,]
ceps1 <- ceps1$schids #提取抽中学校编号的向量
delte <- subset(ceps,schids == ceps1[1])
#遍历抽中的学校id，纵向合并数据框
for (i in ceps1) delte <- rbind(delte, subset(ceps,schids == i))
#箱线图
delte$schids <- as.factor(delte$schids)
box2 <- ggplot(delte, aes(schids,tr_mat)) +
geom_boxplot(notch = T,size=0.1,outlier.colour ='sky blue',fill='sky blue') +
xlab('学校代码') + ylab('数学原始成绩')+
theme_bw()
box2
par(mar = c(4.5, 4.5, 2, 0.2), mfrow = c(1, 2), cex.main = 1)
sq <- 1:10
x <- rep(sq, 10)
z <- rep(sq, each = 10)
y <- c(outer(sq, sq, function(x, z) 2 + x + 0.5 * z + 0.5 * x * z + runif(1))) # 有交互效应
symbols(x, z, y, xlab = "$x$", ylab = "$z$",
bg = rgb(0, 1, 0, 0.3), fg = "blue", inches = 0.4,
main = "$y = 2 + x + 0.5 z + 0.5 x z + \\epsilon$"
)
y <- c(outer(sq, sq, function(x, z) 2 + x + 0.5 * z + runif(1))) # 无交互效应
symbols(x, z, y,
bg = rgb(0, 1, 0, 0.3), fg = "blue", xlab = "$x$", ylab = "$z$",
main = "$y = 2 + x + 0.5 z + \\epsilon$", inches = 0.2
)
#library(readr)
#ceps <- read_csv("C:/Users/xsong/Desktop/table/ceps.imputed.csv")
ceps <- ceps %>%
select(stdmat,everything()) %>%
na.omit()
#options(na.action="na.fail")
library(glmnet)
x_train <- model.matrix(stdmat ~ grade9+sex+onechi+drunk+qurel+relation+desk+net+maedu+faedu+eduexp+dialect+chmwk+chcos+qianzi+futcfd+dial+chidia+eduyexp+huko+eduy+dangy+houspro+classtm+clpre+revitm+know+subject+drsmok+commhr+schcsrm+comno+buget+eduqua+teainc+schtype+fight+brkpb+smok+drink
,ceps)[,-1]
#schids+clsids+ids
y_train <- ceps %>%
select(stdmat) %>%
unlist() %>%
as.numeric()
#cepsmat <- ceps %>%
# select(sex,onechi,maedu,faedu, drunk,qurel,relation,desk,net,dialect,chkhmwk, chkcouse , classtm,clpre,revitm,subject,know, drsmok,commhr,schtype,schcsrm,comno,bknum, buget,eduqua,fight,brkpb,smok,drink, teainc,money,clfee,qianzi,lifetm,dial,chidia,futcfd,huko,eduy,dangy,houspro) %>%
#  as.matrix() %>%
#  na.omit()
#sdtotal <- as.matrix(ceps$sdtotal)
lasso_mod <- glmnet(x_train,
y_train,
alpha = 1)
library(plotmo) # for plot_glmnet
plot_glmnet(lasso_mod,xvar='lambda',label=10)
#plot(lasso_mod,xvar="lambda",label=F,ylab='系数')
#lasso_mod
#cof <- coef(lasso_mod)
cvfit <- cv.glmnet(x_train,
y_train,
alpha = 1)
cvfit$lambda.min
cvfit$lambda.1se
#library(readr)
ceps <- read_csv("C:/Users/xsong/Desktop/table/cepscleaned.csv")
ceps <- ceps %>%
select(stdmat,everything()) %>%
na.omit()
#options(na.action="na.fail")
library(glmnet)
x_train <- model.matrix(stdmat ~ grade9+sex+onechi+drunk+qurel+relation+desk+net+maedu+faedu+eduexp+dialect+chmwk+chcos+qianzi+futcfd+dial+chidia+eduyexp+huko+eduy+dangy+houspro+classtm+clpre+revitm+know+subject+drsmok+commhr+schcsrm+comno+buget+eduqua+teainc+schtype+fight+brkpb+smok+drink
,ceps)[,-1]
#schids+clsids+ids
y_train <- ceps %>%
select(stdmat) %>%
unlist() %>%
as.numeric()
#cepsmat <- ceps %>%
# select(sex,onechi,maedu,faedu, drunk,qurel,relation,desk,net,dialect,chkhmwk, chkcouse , classtm,clpre,revitm,subject,know, drsmok,commhr,schtype,schcsrm,comno,bknum, buget,eduqua,fight,brkpb,smok,drink, teainc,money,clfee,qianzi,lifetm,dial,chidia,futcfd,huko,eduy,dangy,houspro) %>%
#  as.matrix() %>%
#  na.omit()
#sdtotal <- as.matrix(ceps$sdtotal)
lasso_mod <- glmnet(x_train,
y_train,
alpha = 1)
library(plotmo) # for plot_glmnet
plot_glmnet(lasso_mod,xvar='lambda',label=10)
#plot(lasso_mod,xvar="lambda",label=F,ylab='系数')
#lasso_mod
#cof <- coef(lasso_mod)
cvfit <- cv.glmnet(x_train,
y_train,
alpha = 1)
cvfit$lambda.min
cvfit$lambda.1se
plot_glmnet(lasso_mod,xvar='lambda',label=10)
plot(density(ceps$stdmat), main = "")
rug(ceps$stdmat)
str(ceps)
class(ceps)
?view
setwd('F:\\Mysite\\Mysite')
blogdown:::serve_site()
