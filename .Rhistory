# cp = .02 for small demo tree
rpart.plot(binary.model,
main = "titanic survived\n(binary response)")
rpart.plot(binary.model, type = 3, clip.right.labs = FALSE,
branch = .4,
box.palette = "Grays",       # override default GnBu palette
main = "type = 3, clip.right.labs = FALSE, ...\n")
anova.model <- rpart(Mileage ~ ., data = cu.summary)
rpart.plot(anova.model,
shadow.col = "gray",         # add shadows just for kicks
main = "miles per gallon\n(continuous response)\n")
multi.class.model <- rpart(Reliability ~ ., data = cu.summary)
rpart.plot(multi.class.model,
main = "vehicle reliability\n(multi class response)")
par(old.par)
print(fit)
fit2 <- prune(fit, cp = 0.016)
rpart.plot(fit2,shadow.col = 'gray')
print(fit)
fit2 <- prune(fit, cp = 0.016)
rpart.plot(fit2,shadow.col = 'gray')
knitr::opts_chunk$set(echo=F,comment=NA,error=T,message = F,warning = F,fig.align='center',out.width ='100%',fig.showtext=T,dev='pdf')
library(MASS)
library(modelr)
library(ggplot2)
library(magrittr)
library(plyr)
library(dplyr)
library(readxl)
library(readr)
library(reshape2)
library(haven)
library(rgdal)
library(cowplot)
q10 <- seq(0.1,0.9, by = 0.1)
ggplot(mpg, aes(displ, 1 / hwy)) +
geom_jitter(width=0.5,height = 0.01) +
geom_quantile(aes(colour = ..quantile..),quantiles = q10)+
theme_bw()
q10 <- seq(0.1,0.9, by = 0.1)
ggplot(mpg, aes(displ, 1 / hwy)) +
geom_jitter(width=0.5,height = 0.01) +
geom_quantile(aes(colour = ..quantile..),quantiles = q10)+
theme(axis.text.x = element_blank(),
axis.text.y = element_blank(),
axis.ticks = element_blank()) +
theme_bw()
q10 <- seq(0.1,0.9, by = 0.1)
ggplot(mpg, aes(displ, 1 / hwy)) +
geom_jitter(width=0.5,height = 0.01) +
geom_quantile(aes(colour = ..quantile..),quantiles = q10) +
theme(axis.text.x = element_blank(),
axis.text.y = element_blank(),
axis.ticks = element_blank())
q10 <- seq(0.1,0.9, by = 0.1)
ggplot(mpg, aes(displ, 1 / hwy)) +
geom_jitter(width=0.5,height = 0.01) +
geom_quantile(aes(colour = ..quantile..),quantiles = q10)+
theme_bw()+
theme(axis.text.x = element_blank(),
axis.text.y = element_blank(),
axis.ticks = element_blank())
q10 <- seq(0.1,0.9, by = 0.1)
ggplot(mpg, aes(displ, 1 / hwy)) +
geom_jitter(width=0.5,height = 0.01) +
geom_quantile(aes(colour = ..quantile..),quantiles = q10)+
theme_bw()+
theme(axis.text.x = element_blank(),
axis.text.y = element_blank(),
axis.ticks = element_blank(),
axis.title.x = element_blank(),
axis.title.y = element_blank())
library(haven)
paneldata <- read_dta("E:/do_files/land/data/paneldata.dta")
View(paneldata)
knitr::opts_chunk$set(echo=F,comment=NA,error=T,message = F,warning = F,fig.align='center',out.width ='100%',fig.showtext=T,dev='pdf')
library(MASS)
library(modelr)
library(ggplot2)
library(magrittr)
library(plyr)
library(dplyr)
library(readxl)
library(readr)
library(reshape2)
library(haven)
library(rgdal)
library(cowplot)
paneldata <- read_dta('E:/do_files/land/data/paneldata.dta')
library(plm)
?plm
paneldata <- read_dta('E:/do_files/land/data/paneldata.dta')
fe <- plm(lnpfinc ~ reland +urban hukou+mlabor+depro+lnldv+lndebt+famsiz+agem+agem2+nofarm+eduym+party+lnconic+agrato+dist,data=paneldata,index = c('fidmerge10','year'),model = "within")
fe <- plm(lnpfinc ~ reland +urban+hukou+mlabor+depro+lnldv+lndebt+famsiz+agem+agem2+nofarm+eduym+party+lnconic+agrato+dist,data=paneldata,index = c('fidmerge10','year'),model = "within")
fe <- plm(lnfinc ~ reland +urban+hukou+mlabor+depro+lnldv+lndebt+famsiz+agem+agem2+nofarm+eduym+party+lnconic+agrato+dist,data=paneldata,index = c('fidmerge10','year'),model = "within")
pndt <- paneldata %>%
filter(year>2010)
View(pndt)
paneldata <- read_dta('E:\MaLearning\paneldata.dta')
paneldata <- read_dta('E:/MaLearning/paneldata.dta')
pndt <- paneldata %>%
filter(year>2010) %>%
mutate(agem2=agem2/10)
fe <- plm(lnfinc ~ reland +urban+hukou+mlabor+depro+lnldv+lndebt+famsiz+agem+agem2+nofarm+eduym+party+lnconic+agrato+dist,data=pndt,index = c('fidmerge10','year'),model = "within")
paneldata <- read_dta('E:/MaLearning/paneldata.dta')
pndt <- paneldata %>%
filter(year>2010) %>%
mutate(agem2=agem2/10)
fe <- plm(lnfinc ~ reland +urban+hukou+mlabor+depro+lnldv+lndebt+famsiz+agem+agem2+nofarm+eduym+party+lnconic+agrato+dist,data=pndt,index = c('fidmerge10','year'),model = 'within')
summary(fe)
fe <- plm(lnfinc ~ reland +urban+hukou+mlabor+depro+lnldv+lndebt+famsiz+agem+agem2+nofarm+eduym+party+lnconic+agrato+dist+hkprov,data=pndt,index = c('fidmerge10','year'),model = 'within')
summary(fe)
fe <- plm(lnfinc ~ reland +urban+hukou+mlabor+depro+lnldv+lndebt+famsiz+agem+agem2+nofarm+eduym+party+lnconic+agrato+dist+factor(hkprov),data=pndt,index = c('fidmerge10','year'),model = 'within')
summary(fe)
pndt <- paneldata %>%
filter(year>2010) %>%
mutate(agem2=agem2/10,
hkprov=as.factor(hkprov))
#fe <- plm(lnfinc ~ reland +urban+hukou+mlabor+depro+lnldv+lndebt+famsiz+agem+agem2+nofarm+eduym+party+lnconic+agrato+dist+factor(hkprov),data=pndt,index = c('fidmerge10','year'),model = 'within')
#summary(fe)
ggplot()
ggplot(pndt,aes(lnfinc,hkprov,fill=lnfinc)) +
ggridges::geom_density_ridges() +
theme(legend.position = 'none') +
scale_fill_viridis_d(guide =F) +
labs(x = ' ', y = ' ')
ggplot(pndt,aes(lnfinc,hkprov,fill=lnfinc)) +
ggridges::geom_density_ridges() +
theme(legend.position = 'none') +
scale_fill_viridis_d(guide =F) +
labs(x = ' ', y = ' ')
ggplot(pndt,aes(lnfinc,hkprov,fill=lnfinc)) +
ggridges::geom_density_ridges() +
theme(legend.position = 'none') +
scale_fill_viridis_d(guide =F)
ggplot(pndt,aes(lnfinc,hkprov)) +
geom_boxplot()
ggplot(pndt,aes(hkprov,lnfinc)) +
geom_boxplot()
ggplot(pndt,aes(hkprov,lnfinc)) +
geom_boxplot(notch = T)
ggplot(pndt,aes(hkprov,lnfinc)) +
geom_boxplot( )
ggplot(pndt,aes(reland,lnfinc)) +
geom_boxplot()
pndt <- paneldata %>%
filter(year>2010) %>%
mutate(agem2=agem2/10,
hkprov=as.factor(hkprov)) %>%
drop_na(reland)
library(tidyr)
pndt <- paneldata %>%
filter(year>2010) %>%
mutate(agem2=agem2/10,
hkprov=as.factor(hkprov)) %>%
drop_na(reland)
ggplot(pndt,aes(hkprov,lnfinc)) +
geom_boxplot()
ggplot(pndt,aes(reland,lnfinc)) +
geom_boxplot()
ggplot(pndt,aes(factor(reland),lnfinc)) +
geom_boxplot()
library(readr)
library(dplyr)
library(tidyr)
library(reshape2)
library(magrittr)
library(party)
library(rpart)
library(rpart.plot)
library(ggplot2)
raptorsplayoffs <- read_csv("E:/MaLearning/nba/raptorsplayoffs.csv")
raptorsreg <- read_csv("E:/MaLearning/nba/raptors_regulars.csv")
raptors_players <- read_csv("E:/MaLearning/nba/raptors_players.csv")
View(raptorsplayoffs)
View(raptorsplayoffs)
View(raptorsreg)
View(raptors_players)
raptors_players <- raptors_players %>%
arrange(DATE) %>%
na_if('-')
?reshape
players <- reshape(raptors_players, idvar = 'DATE', direction = 'wide',timevar = 'PLAYER', sep = '_')
View(players)
players <- raptors_players %>%
dcast(DATE~PLAYER)
players <- reshape(raptors_players, idvar = 'DATE', direction = 'wide')
library(tidyr)
players <- raptors_players %>%
gather(key, value, -group, -player)
library(tidyr)
players <- raptors_players %>%
gather(key, value, -DATE, -PLAYER)
raptors_players <- raptors_players %>%
na_if('-') %>%
rename('TPP'='3P%','FTP'='FT%',
'FGP'='FG%','win'='W/L') %>%
mutate_if(sapply(.,is.character),as.factor)
colnames(raptors_players)
playoffs <- raptorsplayoffs %>%
arrange(DATE) %>%
na_if('-') %>%
rename('TPP'='3P%','FTP'='FT%',
'FGP'='FG%','win'='W/L') %>%
mutate_if(sapply(.,is.character),as.factor) %>%
select(-'+/-')
colnames(raptors_players)
raptors_players <- raptors_players %>%
na_if('-') %>%
rename('TPP'='3P%','FTP'='FT%',
'FGP'='FG%','win'='W/L') %>%
mutate_if(sapply(.,is.character),as.factor) %>%
select(-'+/-')
raptors_players <- read_csv("E:/MaLearning/nba/raptors_players.csv")
raptors_players <- raptors_players %>%
na_if('-') %>%
rename('TPP'='3P%','FTP'='FT%',
'FGP'='FG%','win'='W/L') %>%
mutate_if(sapply(.,is.character),as.factor) %>%
select(-'+/-')
colnames(raptors_players)
library(tidyr)
players <- raptors_players %>%
gather(key, value, -DATE, -PLAYER) %>%
unite(col, key, times) %>%
spread(col, value)
library(tidyr)
players <- raptors_players %>%
gather(key, value, -DATE, -PLAYER) %>%
unite(col, key, PLAYER) %>%
spread(col, value)
?gather
library(tidyr)
players <- raptors_players %>%
gather(key,value,-DATE, -PLAYER,-win) %>%
unite(col, key, PLAYER) %>%
spread(col,value)
table(raptors_players$PLAYER)
library(tidyr)
players <- raptors_players %>%
gather(key,value,-TEAM,-MATCHUP,-DATE,-PLAYER,-win) %>%
unite(col, key,PLAYER) %>%
spread(col,value)
players <- raptors_players %>%
gather(key,value,-TEAM,-MATCHUP,-DATE,-PLAYER,-win) %>%
unite(col, key,PLAYER) %>%
spread(col,value) %>%
select(-TEAM,-MATCHUP,-DATE)
players <- raptors_players %>%
gather(key,value,-TEAM,-MATCHUP,-DATE,-PLAYER,-win) %>%
unite(col, key,PLAYER) %>%
spread(col,value) %>%
select(-TEAM,-MATCHUP,-DATE) %>%
replace_na(0)
?replace_na
players <- raptors_players %>%
gather(key,value,-TEAM,-MATCHUP,-DATE,-PLAYER,-win) %>%
unite(col, key,PLAYER) %>%
spread(col,value) %>%
select(-TEAM,-MATCHUP,-DATE) %>%
replace_na(0)
library(tidyr)
players <- raptors_players %>%
gather(key,value,-TEAM,-MATCHUP,-DATE,-PLAYER,-win) %>%
unite(col, key,PLAYER) %>%
spread(col,value) %>%
select(-TEAM,-MATCHUP,-DATE) %>%
replace_na('0')
?recode
library(tidyr)
players <- raptors_players %>%
gather(key,value,-TEAM,-MATCHUP,-DATE,-PLAYER,-win) %>%
unite(col, key,PLAYER) %>%
spread(col,value) %>%
select(-TEAM,-MATCHUP,-DATE) %>%
recode(NA=0)
class(raptors_players)
library(tidyr)
players <- raptors_players %>%
gather(key,value,-TEAM,-MATCHUP,-DATE,-PLAYER,-win) %>%
unite(col, key,PLAYER) %>%
spread(col,value) %>%
select(-TEAM,-MATCHUP,-DATE) %>%
replace_na(0)
library(tidyr)
players <- raptors_players %>%
gather(key,value,-TEAM,-MATCHUP,-DATE,-PLAYER,-win) %>%
unite(col, key,PLAYER) %>%
spread(col,value) %>%
select(-TEAM,-MATCHUP,-DATE) %>%
replace(is.na(.), 0)
tree <- ctree(win~.,players,
controls = ctree_control(mincriterion = 0.01,minsplit=3))
library(tidyr)
players <- raptors_players %>%
gather(key,value,-TEAM,-MATCHUP,-DATE,-PLAYER,-win) %>%
unite(col, key,PLAYER) %>%
spread(col,value) %>%
select(-TEAM,-MATCHUP,-DATE) %>%
replace(is.na(.), 0) %>%
mutate_if(sapply(.,is.character),as.factor)
tree <- ctree(win~.,players,
controls = ctree_control(mincriterion = 0.01,minsplit=3))
tree <- ctree(win~.,players,
controls = ctree_control(mincriterion = 0.01,minsplit=3))
plot(tree)
tree <- ctree(win~.,players,
controls = ctree_control(mincriterion = 0.01,minsplit=2))
plot(tree)
tree <- ctree(win~.,players,
controls = ctree_control(mincriterion = 0.001,minsplit=2))
plot(tree)
treept <- rpart(win~.,players,
control = rpart.control(cp=0.001,minsplit=3))
rpart.plot(treept, branch = 0.4)
treept <- rpart(win~.,players,
control = rpart.control(cp=0.0001,minsplit=9))
rpart.plot(treept, branch = 0.4)
treept <- rpart(win~.,players,
control = rpart.control(cp=0.0001,minsplit=2))
rpart.plot(treept, branch = 0.4)
class(players)
str(players)
library(tidyr)
players <- raptors_players %>%
gather(key,value,-TEAM,-MATCHUP,-DATE,-PLAYER,-win) %>%
unite(col, key,PLAYER) %>%
spread(col,value) %>%
select(-TEAM,-MATCHUP,-DATE) %>%
replace(is.na(.), 0) %>%
mutate_if(sapply(.,is.character),as.numeric)
treept <- rpart(win~.,players,
control = rpart.control(cp=0.0001,minsplit=2))
rpart.plot(treept, branch = 0.4)
treept <- rpart(win~.,players,
control = rpart.control(cp=0.0001,minsplit=6))
rpart.plot(treept, branch = 0.4)
raptorsplayoffs <- read_csv("E:/MaLearning/nba/raptorsplayoffs.csv")
raptorsreg <- read_csv("E:/MaLearning/nba/raptors_regulars.csv")
raptors_players <- read_csv("E:/MaLearning/nba/raptors_players.csv")
regular_players <- read_csv("E:/MaLearning/nba/regular_players.csv")
library(tidyr)
players <- regular_players %>%
gather(key,value,-TEAM,-MATCHUP,-DATE,-PLAYER,-win) %>%
unite(col, key,PLAYER) %>%
spread(col,value) %>%
select(-TEAM,-MATCHUP,-DATE) %>%
replace(is.na(.), 0) %>%
mutate_if(sapply(.,is.character),as.numeric)
regular_players <- regular_players %>%
na_if('-') %>%
filter()
rename('TPP'='3P%','FTP'='FT%',
'FGP'='FG%','win'='W/L') %>%
mutate_if(sapply(.,is.character),as.factor) %>%
select(-'+/-')
regular_players <- regular_players %>%
na_if('-') %>%
rename('TPP'='3P%','FTP'='FT%',
'FGP'='FG%','win'='W/L') %>%
mutate_if(sapply(.,is.character),as.factor) %>%
select(-'+/-')
players <- regular_players %>%
gather(key,value,-TEAM,-MATCHUP,-DATE,-PLAYER,-win) %>%
unite(col, key,PLAYER) %>%
spread(col,value) %>%
select(-TEAM,-MATCHUP,-DATE) %>%
replace(is.na(.), 0) %>%
mutate_if(sapply(.,is.character),as.numeric)
treept <- rpart(win~.,players,
control = rpart.control(cp=0.0001,minsplit=6))
rpart.plot(treept, branch = 0.4)
View(players)
raptorsplayoffs <- read_csv("E:/MaLearning/nba/raptorsplayoffs.csv")
raptorsreg <- read_csv("E:/MaLearning/nba/raptors_regulars.csv")
raptors_players <- read_csv("E:/MaLearning/nba/raptors_players.csv")
regular_players <- read_csv("E:/MaLearning/nba/regular_players.csv")
regular_players <- read_csv("E:/MaLearning/nba/regular_players.csv")
regular_players <- regular_players %>%
na_if('-') %>%
rename('TPP'='3P%','FTP'='FT%',
'FGP'='FG%','win'='W/L') %>%
mutate_if(sapply(.,is.character),as.factor) %>%
select(-'+/-')
library(tidyr)
players <- regular_players %>%
gather(key,value,-TEAM,-MATCHUP,-DATE,-PLAYER,-win) %>%
unite(col, key,PLAYER) %>%
spread(col,value) %>%
select(-TEAM,-MATCHUP,-DATE) %>%
replace(is.na(.), 0) %>%
mutate_if(sapply(.,is.character),as.numeric)
treept <- rpart(win~.,players,
control = rpart.control(cp=0.0001,minsplit=6))
rpart.plot(treept, branch = 0.4)
View(players)
players <- regular_players %>%
gather(key,value,-TEAM,-MATCHUP,-DATE,-PLAYER,-win) %>%
unite(col, key,PLAYER) %>%
spread(col,value) %>%
select(-TEAM,-MATCHUP,-DATE) %>%
mutate_if(sapply(.,is.character),as.numeric)
treept <- rpart(win~.,players,
control = rpart.control(cp=0.0001,minsplit=6))
rpart.plot(treept, branch = 0.4)
treept <- rpart(win~.,players,
control = rpart.control(cp=0.0001,minsplit=6))
rpart.plot(treept, branch = 0.4)
treept <- rpart(formula,playoffs,
control = rpart.control(cp=0.01,minsplit=3))
treept <- rpart(win~.,players,
control = rpart.control(cp=0.001,minsplit=6))
rpart.plot(treept, branch = 0.4)
treept <- rpart(win~.,players,
control = rpart.control(cp=0.01,minsplit=6))
rpart.plot(treept, branch = 0.4)
treept <- rpart(win~.,players,
control = rpart.control(cp=0.1,minsplit=6))
rpart.plot(treept, branch = 0.4)
treept <- rpart(win~.,players,
control = rpart.control(cp=0.05,minsplit=6))
rpart.plot(treept, branch = 0.4)
treept <- rpart(win~.,players,
control = rpart.control(cp=0.05,minsplit=6))
rpart.plot(treept, branch = 0.4)
players <- regular_players %>%
gather(key,value,-TEAM,-MATCHUP,-DATE,-PLAYER,-win) %>%
unite(col, key,PLAYER) %>%
spread(col,value) %>%
select(-TEAM,-MATCHUP,-DATE) %>%
replace(is.na(.), 0) %>%
mutate_if(sapply(.,is.character),as.numeric)
treept <- rpart(win~.,players,
control = rpart.control(cp=0.0001,minsplit=6))
rpart.plot(treept, branch = 0.4)
tree <- ctree(win~.,players,
controls = ctree_control(mincriterion = 0.001,minsplit=2))
plot(tree)
tree <- ctree(win~.,players,
controls = ctree_control(mincriterion = 0.00001,minsplit=2))
plot(tree)
tree <- ctree(win~.,players,
controls = ctree_control(mincriterion = 0.00001,minsplit=9))
plot(tree)
#Kawhi Leonard Kyle Lowry Malcolm Miller
#Serge Ibaka Danny Green
regular_players <- regular_players %>%
na_if('-') %>%
rename('TPP'='3P%','FTP'='FT%',
'FGP'='FG%','win'='W/L') %>%
mutate_if(sapply(.,is.character),as.factor) %>%
select(-'+/-')
raptorsplayoffs <- read_csv("E:/MaLearning/nba/raptorsplayoffs.csv")
raptorsreg <- read_csv("E:/MaLearning/nba/raptors_regulars.csv")
raptors_players <- read_csv("E:/MaLearning/nba/raptors_players.csv")
regular_players <- read_csv("E:/MaLearning/nba/regular_players.csv")
#Kawhi Leonard Kyle Lowry Malcolm Miller
#Serge Ibaka Danny Green
regular_players <- regular_players %>%
na_if('-') %>%
rename('TPP'='3P%','FTP'='FT%',
'FGP'='FG%','win'='W/L') %>%
mutate_if(sapply(.,is.character),as.factor) %>%
select(-'+/-')
#long to wide
players <- raptors_players %>%
dcast(DATE~PLAYER)
#date=group, player=time
library(tidyr)
players <- regular_players %>%
gather(key,value,-TEAM,-MATCHUP,-DATE,-PLAYER,-win) %>%
unite(col, key,PLAYER) %>%
spread(col,value) %>%
select(-TEAM,-MATCHUP,-DATE) %>%
replace(is.na(.), 0) %>%
mutate_if(sapply(.,is.character),as.numeric)
head(data.frame(players))
head(data.frame(players)[3])
data.frame(players)[5]
data.frame(players)[10]
head(data.frame(players)[1:5])
ggplot(players)+
geom_point(aes(TPP_Kyle Lowry,MIN_Pascal Siakam,shape=win,col=win))
ggplot(players)+
geom_point(aes('TPP_Kyle Lowry','MIN_Pascal Siakam',shape=win,col=win))
players %>%
rename('TPP_Kyle_Lowry'='TPP_Kyle Lowry','MIN_Pascal_Siakam'='MIN_Pascal Siakam') %>%
ggplot( +
geom_point(aes('TPP_Kyle_Lowry','MIN_Pascal_Siakam',shape=win,col=win))
players %>%
players %>%
rename('TPP_Kyle_Lowry'='TPP_Kyle Lowry','MIN_Pascal_Siakam'='MIN_Pascal Siakam')
ggplot() +
geom_point(aes('TPP_Kyle_Lowry','MIN_Pascal_Siakam',shape=win,col=win))
players %>%
rename('TPP_Kyle_Lowry'='TPP_Kyle Lowry','MIN_Pascal_Siakam'='MIN_Pascal Siakam') %>%
ggplot() +
geom_point(aes('TPP_Kyle_Lowry','MIN_Pascal_Siakam',shape=win,col=win))
players %>%
rename('TPP_Kyle_Lowry'='TPP_Kyle Lowry','MIN_Pascal_Siakam'='MIN_Pascal Siakam') %>%
ggplot() +
geom_point(aes('TPP_Kyle_Lowry','MIN_Pascal_Siakam',shape=win,col=win))
players %>%
rename('TPP_Kyle_Lowry'='TPP_Kyle Lowry','MIN_Pascal_Siakam'='MIN_Pascal Siakam') %>%
ggplot() +
geom_point(aes(TPP_Kyle_Lowry,MIN_Pascal_Siakam,shape=win,col=win))
setwd('F:\\Mysite\\Mysite')
blogdown:::serve_site()
setwd('F:\\Mysite\\Mysite')
blogdown:::serve_site()
setwd('F:\\Mysite\\Mysite')
blogdown:::serve_site()
