devtools::install_github("gadenbuie/xaringanthemer")
?fortify
?ggplot2::fortify
library(haven)
library(dplyr)
library(plyr)
library(readxl)
china_map_data <- read_dta("E:/R_codes/maps/nomissing/chnprovcd.dta")#底图
library(rgdal)
bottom  <- readOGR(dsn = "E:/R codes/maps/CHN_adm/CHN_adm2.shp",stringsAsFactors=FALSE)
library(rgdal)
bottom  <- readOGR(dsn = "E:/R_codes/maps/CHN_adm/CHN_adm2.shp",stringsAsFactors=FALSE)
library(ggplot2)
bottomdata <- fortify(bottom)
x <- bottom@data
xs <- data.frame(x,id=seq(0:344)-1)
library(plyr)
china_map <- join(bottomdata, xs, type = "full")
library(readxl)
fills <- read_excel("E:/R_codes/maps/pointmap/citydis.xlsx")
china_map <- join(china_map,fills, type = "full")
table(china_map$freq)
point <- china_map
point <- na.omit(point)
midpos <- function(x) mean(range(x,na.rm=TRUE)) #???????????????????????????
centres <- ddply(china_map,.(NAME_2),colwise(midpos,.(long,lat)))
center <- join(centres, jin, type = "full")
library(rgdal)
bottom  <- readOGR(dsn = "E:/R_codes/maps/CHN_adm/CHN_adm2.shp",stringsAsFactors=FALSE)
library(ggplot2)
bottomdata <- fortify(bottom)
x <- bottom@data
xs <- data.frame(x,id=seq(0:344)-1)
library(plyr)
china_map <- join(bottomdata, xs, type = "full")
library(readxl)
fills <- read_excel("E:/R_codes/maps/pointmap/citydis.xlsx")
china_map <- join(china_map,fills, type = "full")
table(china_map$freq)
point <- china_map
point <- na.omit(point)
midpos <- function(x) mean(range(x,na.rm=TRUE)) #???????????????????????????
centres <- ddply(china_map,.(NAME_2),colwise(midpos,.(long,lat)))
center <- join(centres,fills, type = "full")
center  <- na.omit(center)
library(ggplot2)
ggplot(china_map,aes(x=long,y=lat)) +
geom_polygon(aes(group = group),fill="white",color="black",size=0.1) + #?????????,NA???????????? +
geom_point(mapping = aes(x=long, y=lat, size = freq),data = center, colour = "steelblue") +
coord_map("polyconic") +
theme(
panel.grid = element_blank(),
panel.background = element_blank(),
axis.text = element_blank(),
axis.ticks = element_blank(),
axis.title = element_blank(),
legend.position = c(0.85,0.5)
)
library(rgdal)
bottom  <- readOGR(dsn = "E:/R_codes/maps/CHN_adm/CHN_adm2.shp",stringsAsFactors=FALSE)
library(ggplot2)
bottomdata <- fortify(bottom)
x <- bottom@data
xs <- data.frame(x,id=seq(0:344)-1)
library(plyr)
china_map <- join(bottomdata, xs, type = "full")
library(readxl)
fills <- read_excel("E:/R_codes/maps/pointmap/citydis.xlsx")
china_map <- join(china_map,fills, type = "full")
ggplot(china_map,aes(x=long,y=lat)) +
geom_polygon(aes(group = group),fill="white",color="black",size=0.1) +
geom_point(mapping = aes(x=long, y=lat, size = freq),data = center, colour = "sky blue") +
coord_map("polyconic")
rm(list=ls())
#help("subset")
library(rgdal)
ks  <- readOGR(dsn = "E:/R codes/maps/CHN_adm/CHN_adm2.shp",stringsAsFactors=FALSE)
china_map <- readOGR(dsn = "E:/R codes/maps/china-province-border-data/bou2_4p.shp",stringsAsFactors=FALSE)#??ȡ?й???ͼ?ռ?????
library(ggplot2)
china_map <- fortify(china_map) #??????????????????
taiwan <-subset(china_map, long < 124.34 & long > 119.18 &
lat<25.56 & lat>21.45, select = c(long, lat, group))
taiwan$NAME_1 <- "Taiwan"
library(rgdal)
bottom  <- readOGR(dsn = "E:/R codes/maps/CHN_adm/CHN_adm2.shp",stringsAsFactors=FALSE)
library(ggplot2)
bottomdata <- fortify(bottom)
x <- bottom@data
xs <- data.frame(x,id=seq(0:344)-1)
library(plyr)
china_map <- join(bottomdata, xs, type = "full")
china_map <-subset(china_map, select = c(long, lat, group,NAME_1))
taiwan <- rbind(china_map, taiwan)
ggplot(taiwan,aes(x=long,y=lat)) +
geom_polygon(aes(group = group),fill="white",color="black",size=0.1) + #?????????,NA???????????? +
coord_map("polyconic") +
theme(
panel.grid = element_blank(),
panel.background = element_blank(),
axis.text = element_blank(),
axis.ticks = element_blank(),
axis.title = element_blank(),
legend.position = c(0.3,0.1)
)
china_map <- readOGR(dsn = "E:/R_codes/maps/china-province-border-data/bou2_4p.shp",stringsAsFactors=FALSE)#??ȡ?й???ͼ?ռ?????
##???????????????
rm(list=ls())
#help("subset")
library(rgdal)
ks  <- readOGR(dsn = "E:/R_codes/maps/CHN_adm/CHN_adm2.shp",stringsAsFactors=FALSE)
china_map <- readOGR(dsn = "E:/R_codes/maps/china-province-border-data/bou2_4p.shp",stringsAsFactors=FALSE)#??ȡ?й???ͼ?ռ?????
library(ggplot2)
china_map <- fortify(china_map) #??????????????????
taiwan <-subset(china_map, long < 124.34 & long > 119.18 &
lat<25.56 & lat>21.45, select = c(long, lat, group))
taiwan$NAME_1 <- "Taiwan"
library(rgdal)
bottom  <- readOGR(dsn = "E:/R codes/maps/CHN_adm/CHN_adm2.shp",stringsAsFactors=FALSE)
library(ggplot2)
bottomdata <- fortify(bottom)
x <- bottom@data
xs <- data.frame(x,id=seq(0:344)-1)
library(plyr)
china_map <- join(bottomdata, xs, type = "full")
china_map <-subset(china_map, select = c(long, lat, group,NAME_1))
taiwan <- rbind(china_map, taiwan)
ggplot(taiwan,aes(x=long,y=lat)) +
geom_polygon(aes(group = group),fill="white",color="black",size=0.1) + #?????????,NA???????????? +
coord_map("polyconic") +
theme(
panel.grid = element_blank(),
panel.background = element_blank(),
axis.text = element_blank(),
axis.ticks = element_blank(),
axis.title = element_blank(),
legend.position = c(0.3,0.1)
)
ggplot(bottomdata,aes(x=long,y=lat)) +
geom_polygon(aes(group = group),fill="white",color="black",size=0.1) + #?????????,NA???????????? +
coord_map("polyconic") +
theme(
panel.grid = element_blank(),
panel.background = element_blank(),
axis.text = element_blank(),
axis.ticks = element_blank(),
axis.title = element_blank(),
legend.position = c(0.3,0.1)
)
##???????????????
rm(list=ls())
#help("subset")
library(rgdal)
ks  <- readOGR(dsn = "E:/R_codes/maps/CHN_adm/CHN_adm2.shp",stringsAsFactors=FALSE)
china_map <- readOGR(dsn = "E:/R_codes/maps/china-province-border-data/bou2_4p.shp",stringsAsFactors=FALSE)#??ȡ?й???ͼ?ռ?????
library(ggplot2)
china_map <- fortify(china_map) #??????????????????
taiwan <-subset(china_map, long < 124.34 & long > 119.18 &
lat<25.56 & lat>21.45, select = c(long, lat, group))
taiwan$NAME_1 <- "Taiwan"
library(rgdal)
bottom  <- readOGR(dsn = "E:/R codes/maps/CHN_adm/CHN_adm2.shp",stringsAsFactors=FALSE)
library(ggplot2)
bottomdata <- fortify(bottom)
x <- bottom@data
xs <- data.frame(x,id=seq(0:344)-1)
library(plyr)
china_map <- join(bottomdata, xs, type = "full")
china_map <-subset(china_map, select = c(long, lat, group,NAME_1))
taiwan <- rbind(china_map, taiwan)
ggplot(taiwan,aes(x=long,y=lat)) +
geom_polygon(aes(group = group),fill="white",color="black",size=0.1) + #?????????,NA???????????? +
coord_map("polyconic") +
theme(
panel.grid = element_blank(),
panel.background = element_blank(),
axis.text = element_blank(),
axis.ticks = element_blank(),
axis.title = element_blank(),
legend.position = c(0.3,0.1)
)
##???????????????
rm(list=ls())
#help("subset")
library(rgdal)
ks  <- readOGR(dsn = "E:/R_codes/maps/CHN_adm/CHN_adm2.shp",stringsAsFactors=FALSE)
china_map <- readOGR(dsn = "E:/R_codes/maps/china-province-border-data/bou2_4p.shp",stringsAsFactors=FALSE)#??ȡ?й???ͼ?ռ?????
library(ggplot2)
china_map <- fortify(china_map) #??????????????????
taiwan <-subset(china_map, long < 124.34 & long > 119.18 &
lat<25.56 & lat>21.45, select = c(long, lat, group))
taiwan$NAME_1 <- "Taiwan"
library(rgdal)
bottom  <- readOGR(dsn = "E:/R codes/maps/CHN_adm/CHN_adm2.shp",stringsAsFactors=FALSE)
library(ggplot2)
bottomdata <- fortify(bottom)
x <- bottom@data
xs <- data.frame(x,id=seq(0:344)-1)
library(plyr)
china_map <- join(bottomdata, xs, type = "full")
#china_map <-subset(china_map, select = c(long, lat, group,NAME_1))
taiwan <- rbind(china_map, taiwan)
ggplot(taiwan,aes(x=long,y=lat)) +
geom_polygon(aes(group = group),fill="white",color="black",size=0.1) + #?????????,NA???????????? +
coord_map("polyconic") +
theme(
panel.grid = element_blank(),
panel.background = element_blank(),
axis.text = element_blank(),
axis.ticks = element_blank(),
axis.title = element_blank(),
legend.position = c(0.3,0.1)
)
library(haven)
bottom <- read_dta("E:/R_codes/maps/nomissing/taiwan_nomissing.dta")
library(ggplot2)
bottomdata <- fortify(bottom)
x <- bottom@data
library(haven)
bottom <- read_dta("E:/R_codes/maps/nomissing/taiwan_nomissing.dta")
library(ggplot2)
bottom <- fortify(bottom)
x <- bottom@data
library(rgdal)
bottom  <- readOGR(dsn = "E:/R codes/maps/CHN_adm/CHN_adm2.shp",stringsAsFactors=FALSE)
library(ggplot2)
bottomdata <- fortify(bottom)
x <- bottom@data
xs <- data.frame(x,id=seq(0:344)-1)
library(plyr)
china_map <- join(bottomdata, xs, type = "full")
china_map <-subset(china_map, select = c(long, lat, group,NAME_1))
taiwan <- rbind(china_map, taiwan)
rm(list=ls())
#help("subset")
library(rgdal)
ks  <- readOGR(dsn = "E:/R_codes/maps/CHN_adm/CHN_adm2.shp",stringsAsFactors=FALSE)
china_map <- readOGR(dsn = "E:/R_codes/maps/china-province-border-data/bou2_4p.shp",stringsAsFactors=FALSE)#??ȡ?й???ͼ?ռ?????
library(ggplot2)
china_map <- fortify(china_map) #??????????????????
taiwan <-subset(china_map, long < 124.34 & long > 119.18 &
lat<25.56 & lat>21.45, select = c(long, lat, group))
taiwan$NAME_1 <- "Taiwan"
library(rgdal)
bottom  <- readOGR(dsn = "E:/R codes/maps/CHN_adm/CHN_adm2.shp",stringsAsFactors=FALSE)
library(ggplot2)
bottomdata <- fortify(bottom)
rm(list=ls())
#help("subset")
library(rgdal)
ks  <- readOGR(dsn = "E:/R_codes/maps/CHN_adm/CHN_adm2.shp",stringsAsFactors=FALSE)
china_map <- readOGR(dsn = "E:/R_codes/maps/china-province-border-data/bou2_4p.shp",stringsAsFactors=FALSE)#??ȡ?й???ͼ?ռ?????
library(ggplot2)
china_map <- fortify(china_map) #??????????????????
taiwan <-subset(china_map, long < 124.34 & long > 119.18 &
lat<25.56 & lat>21.45, select = c(long, lat, group))
taiwan$NAME_1 <- "Taiwan"
library(rgdal)
bottom  <- readOGR(dsn = "E:/R codes/maps/CHN_adm/CHN_adm2.shp",stringsAsFactors=FALSE)
library(ggplot2)
bottomdata <- fortify(bottom)
x <- bottom@data
xs <- data.frame(x,id=seq(0:344)-1)
library(plyr)
china_map <- join(bottomdata, xs, type = "full")
china_map <-subset(china_map, select = c(long, lat, group,NAME_1))
taiwan <- rbind(china_map, taiwan)
rm(list=ls())
#help("subset")
library(rgdal)
ks  <- readOGR(dsn = "E:/R_codes/maps/CHN_adm/CHN_adm2.shp",stringsAsFactors=FALSE)
china_map <- readOGR(dsn = "E:/R_codes/maps/china-province-border-data/bou2_4p.shp",stringsAsFactors=FALSE)#??ȡ?й???ͼ?ռ?????
library(ggplot2)
china_map <- fortify(china_map) #??????????????????
taiwan <-subset(china_map, long < 124.34 & long > 119.18 &
lat<25.56 & lat>21.45, select = c(long, lat, group))
taiwan$NAME_1 <- "Taiwan"
library(rgdal)
bottom  <- readOGR(dsn = "E:/R codes/maps/CHN_adm/CHN_adm2.shp",stringsAsFactors=FALSE)
library(ggplot2)
bottomdata <- fortify(bottom)
x <- bottomdata@data
xs <- data.frame(x,id=seq(0:344)-1)
library(plyr)
china_map <- join(bottomdata, xs, type = "full")
china_map <-subset(china_map, select = c(long, lat, group,NAME_1))
taiwan <- rbind(china_map, taiwan)
rm(list=ls())
#install.packages("maps")
#library(maps)
#map()
#install.packages("tibble")
#install.packages("mapproj")
library(maptools)
library(rgdal)
china_map <- readOGR(dsn =
"E:/R_codes/maps/china-province-border-data/bou2_4p.shp"
,stringsAsFactors=FALSE)
#plot(china_map)
x <- china_map@data
xs <- data.frame(x,id=seq(0:924)-1)
library(haven)
provcd <- read_dta("E:/R_codes/maps/china-province-border-data/provcd.dta")
#merge standard province code
cs <- join(provcd,xs, type = "full")
library(ggplot2)
china_map1 <- fortify(china_map)
library(plyr)
library(tibble)
china_map_data <- join(china_map1,cs, type = "full")
china_map_data <- select(china_map_data,-(name)) #reverse selection
setwd("E:/R_codes/maps/nomissing")
library(foreign)
write.dta(`china_map_data`, "chn_province_provcd.dta")
# prepare work data, which needed to be filled in the map
library(readxl)
library(tidyverse)
mapdata <- read_excel("E:/land/plot/geodata0131.xlsx")
mapdata <- as.data.frame(mapdata)
mapdata <- select(mapdata,-(NAME)) #reverse selection
china_data <- join(china_map_data, mapdata, type="full")
library(ggplot2)
ggplot(china_data, aes(x = long, y = lat, group = group,fill= out12)) +
geom_polygon(colour="brown",size=0.2) +
scale_fill_gradient(low="yellow",high="red",na.value = "white") +
coord_map("polyconic") +
theme(
panel.grid = element_blank(),
panel.background = element_blank(),
axis.text = element_blank(),
axis.ticks = element_blank(),
axis.title = element_blank(),
legend.position = c(0.9,0.6),
plot.title = element_text(hjust = 0.5),
legend.title = element_text(size=10)
) +
theme(plot.margin = unit(c(0.001,0.001,0.001,0.001), "cm")) +
labs(fill=" ")
fills <- read_excel("E:/R_codes/maps/pointmap/citydis.xlsx")
#library(maptools)
#bottom <- readShapePoly("E:/R codes/maps/CHN_adm/CHN_adm2.shp")
library(rgdal)
bottom  <- readOGR(dsn = "E:/R codes/maps/CHN_adm/CHN_adm2.shp",stringsAsFactors=FALSE)
library(ggplot2)
bottomdata <- fortify(bottom)
x <- bottom@data
xs <- data.frame(x,id=seq(0:344)-1)
library(plyr)
china_map <- join(bottomdata, xs, type = "full")
table(china_map$NAME_2)
library(readxl)
fills <- read_excel("E:/R_codes/maps/pointmap/citydis.xlsx")
china_map <- join(china_map,fills, type = "full")
table(china_map$freq)
point <- china_map
point <- na.omit(point)
midpos <- function(x) mean(range(x,na.rm=TRUE)) #???????????????????????????
centres <- ddply(china_map,.(NAME_2),colwise(midpos,.(long,lat)))
center <- join(centres, jin, type = "full")
center  <- na.omit(center)
library(ggplot2)
ggplot(china_map,aes(x=long,y=lat)) +
geom_polygon(aes(group = group),fill="white",color="black",size=0.1) + #?????????,NA???????????? +
geom_point(mapping = aes(x=long, y=lat, size = freq),data = center, colour = "steelblue") +
coord_map("polyconic") +
theme(
panel.grid = element_blank(),
panel.background = element_blank(),
axis.text = element_blank(),
axis.ticks = element_blank(),
axis.title = element_blank(),
legend.position = c(0.85,0.5)
)
#library(maptools)
#bottom <- readShapePoly("E:/R codes/maps/CHN_adm/CHN_adm2.shp")
library(rgdal)
bottom  <- readOGR(dsn = "E:/R codes/maps/CHN_adm/CHN_adm2.shp",stringsAsFactors=FALSE)
library(ggplot2)
bottomdata <- fortify(bottom)
x <- bottom@data
xs <- data.frame(x,id=seq(0:344)-1)
library(plyr)
china_map <- join(bottomdata, xs, type = "full")
table(china_map$NAME_2)
library(readxl)
fills <- read_excel("E:/R_codes/maps/pointmap/citydis.xlsx")
china_map <- join(china_map,fills, type = "full")
table(china_map$freq)
point <- china_map
point <- na.omit(point)
midpos <- function(x) mean(range(x,na.rm=TRUE)) #???????????????????????????
centres <- ddply(china_map,.(NAME_2),colwise(midpos,.(long,lat)))
center <- join(centres,fills, type = "full")
center  <- na.omit(center)
library(ggplot2)
ggplot(china_map,aes(x=long,y=lat)) +
geom_polygon(aes(group = group),fill="white",color="black",size=0.1) + #?????????,NA???????????? +
geom_point(mapping = aes(x=long, y=lat, size = freq),data = center, colour = "steelblue") +
coord_map("polyconic") +
theme(
panel.grid = element_blank(),
panel.background = element_blank(),
axis.text = element_blank(),
axis.ticks = element_blank(),
axis.title = element_blank(),
legend.position = c(0.85,0.5)
)
library(rgdal)
bottom  <- readOGR(dsn = "E:/R_codes/maps/CHN_adm/CHN_adm2.shp",stringsAsFactors=FALSE)
library(ggplot2)
bottomdata <- fortify(bottom)
x <- bottom@data
xs <- data.frame(x,id=seq(0:344)-1)
library(plyr)
china_map <- join(bottomdata, xs, type = "full")
library(readxl)
fills <- read_excel("E:/R_codes/maps/pointmap/citydis.xlsx")
china_map <- join(china_map,fills, type = "full")
ggplot(china_map,aes(x=long,y=lat)) +
geom_polygon(aes(group = group),fill="white",color="black",size=0.1) +
geom_point(mapping = aes(x=long, y=lat, size = freq),data = center, colour = "sky blue") +
coord_map("polyconic")
library(rgdal)
bottom  <- readOGR(dsn = "E:/R_codes/maps/CHN_adm/CHN_adm2.shp",stringsAsFactors=FALSE)
library(ggplot2)
bottomdata <- fortify(bottom)
x <- bottom@data
xs <- data.frame(x,id=seq(0:344)-1)
library(plyr)
china_map <- join(bottomdata, xs, type = "full")
library(readxl)
fills <- read_excel("E:/R_codes/maps/pointmap/citydis.xlsx")
china_map <- join(china_map,fills, type = "full")
point <- china_map
point <- na.omit(point)
midpos <- function(x) mean(range(x,na.rm=TRUE)) #???????????????????????????
centres <- ddply(china_map,.(NAME_2),colwise(midpos,.(long,lat)))
center <- join(centres,fills, type = "full")
center  <- na.omit(center)
library(ggplot2)
ggplot(china_map,aes(x=long,y=lat)) +
geom_polygon(aes(group = group),fill="white",color="black",size=0.1) +
geom_point(mapping = aes(x=long, y=lat, size = freq),data = center, colour = "sky blue") +
coord_map("polyconic")
library(rgdal)
bottom  <- readOGR(dsn = "E:/R_codes/maps/CHN_adm/CHN_adm2.shp",stringsAsFactors=FALSE)
library(ggplot2)
bottomdata <- fortify(bottom)
x <- bottom@data
xs <- data.frame(x,id=seq(0:344)-1)
library(plyr)
china_map <- join(bottomdata, xs, type = "full")
library(readxl)
fills <- read_excel("E:/R_codes/maps/pointmap/citydis.xlsx")
china_map <- join(china_map,fills, type = "full")
point <- china_map
point <- na.omit(point)
midpos <- function(x) mean(range(x,na.rm=TRUE))
centres <- ddply(china_map,.(NAME_2),colwise(midpos,.(long,lat)))
center <- join(centres,fills, type = "full")
center  <- na.omit(center)
ggplot(china_map,aes(x=long,y=lat)) +
geom_polygon(aes(group = group),fill="white",color="black",size=0.1) +
geom_point(mapping = aes(x=long, y=lat, size = freq),data = center, colour = "sky blue") +
coord_map("polyconic") +
xlab('经度') +
ylab('纬度') +
theme(legend.title=element_blank()) #去除图例标题
setwd('F:\\Mysite\\Mysite')
blogdown:::serve_site()
?blogdown:::serve_site()
blogdown:::stop_server()
library(rgdal)
bottom  <- readOGR(dsn = "E:/R_codes/maps/CHN_adm/CHN_adm2.shp",stringsAsFactors=F)
library(ggplot2)
bottomdata <- fortify(bottom)
x <- bottom@data
xs <- data.frame(x,id=seq(0:344)-1)
library(plyr)
china_map <- join(bottomdata, xs, type = "full")
library(readxl)
fills <- read_excel("E:/R_codes/maps/pointmap/citydis.xlsx")
china_map <- join(china_map,fills, type = "full")
point <- china_map
point <- na.omit(point)
midpos <- function(x) mean(range(x,na.rm=TRUE))
centres <- ddply(china_map,.(NAME_2),colwise(midpos,.(long,lat)))
center <- join(centres,fills, type = "full")
center  <- na.omit(center)
ggplot(china_map,aes(x=long,y=lat)) +
geom_polygon(aes(group = group),fill="white",color="black",size=0.1) +
geom_point(mapping = aes(x=long, y=lat, size = freq),data = center, colour = "steelblue") +
coord_map("polyconic") +
xlab('经度') +
ylab('纬度') +
theme(legend.title=element_blank()) #去除图例标题
