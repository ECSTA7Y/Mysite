plot(density(rep(0, 1000)))
set.seed(711)
x = seq(0, 4, length = 100)
y = -x + jitter(rep(1:5, each = 20), 2)
z = rep(1:5, each = 20)
par(mar = c(4, 4, 0.1, 0.1))
plot(x, y)
abline(lm(y ~ x), col = "red")
plot(x, y, pch = 20, col = z)
lines(lowess(x, y, f = 0.1), col = "red")
summary(lm(y ~ x))
summary(lm(y ~ x + z))
install.packages("adabag")
warnings()
install.packages('bayesSurv')
install.packages('BMA')
library(survival)
data(veteran)
test.bic.surv<- bic.surv(Surv(time,status) ~ ., data = veteran,
factor.type = TRUE)
summary(test.bic.surv, conditional=FALSE, digits=2)
plot(test.bic.surv)
imageplot.bma(test.bic.surv)
library(survival)
data(veteran)
library(BMA)
test.bic.surv<- bic.surv(Surv(time,status) ~ ., data = veteran,
factor.type = TRUE)
summary(test.bic.surv, conditional=FALSE, digits=2)
plot(test.bic.surv)
imageplot.bma(test.bic.surv)
vignette(, package = "survival")
vignette('survival', package = "survival")
vignette('timedep', package = "survival")
vignette('tests', package = "survival")
set.seed(711)
x = seq(0, 4, length = 100)
y = -x + jitter(rep(1:5, each = 20), 2)
z = rep(1:5, each = 20)
par(mar = c(4, 4, 0.1, 0.1))
plot(x, y)
abline(lm(y ~ x), col = "red")
set.seed(711)
x = seq(0, 4, length = 100)
y = -x + jitter(rep(1:5, each = 20), 2)
z = rep(1:5, each = 20)
par(mar = c(4, 4, 0.1, 0.1))
plot(x, y)
abline(lm(y ~ x), col = "red")
plot(x, y, pch = 20, col = z)
set.seed(711)
x = seq(0, 4, length = 100)
y = -x + jitter(rep(1:5, each = 20), 2)
z = rep(1:5, each = 20)
par(mar = c(4, 4, 0.1, 0.1))
plot(x, y)
abline(lm(y ~ x), col = "red")
plot(x, y, pch = 20, col = z)
set.seed(711)
x = seq(0, 4, length = 100)
y = -x + jitter(rep(1:5, each = 20), 2)
z = rep(1:5, each = 20)
par(mar = c(4, 4, 0.1, 0.1))
plot(x, y)
abline(lm(y ~ z), col = "red")
set.seed(711)
x = seq(0, 4, length = 100)
y = -x + jitter(rep(1:5, each = 20), 2)
z = rep(1:5, each = 20)
par(mar = c(4, 4, 0.1, 0.1))
plot(x, y)
abline(lm(y ~ z), col = "red")
plot(x, y, pch = 20, col = z)
set.seed(711)
x = seq(0, 4, length = 100)
y = -x + jitter(rep(1:5, each = 20), 2)
z = rep(1:5, each = 20)
par(mar = c(4, 4, 0.1, 0.1))
plot(x, y)
abline(lm(x ~ z), col = "red")
plot(x, y, pch = 20, col = z)
set.seed(711)
x = seq(0, 4, length = 100)
y = -x + jitter(rep(1:5, each = 20), 2)
z = rep(1:5, each = 20)
par(mar = c(4, 4, 0.1, 0.1))
plot(x, y)
abline(lm(x ~ z), col = "red")
set.seed(711)
x = seq(0, 4, length = 100)
y = -x + jitter(rep(1:5, each = 20), 2)
z = rep(1:5, each = 20)
par(mar = c(4, 4, 0.1, 0.1))
plot(x, y)
abline(lm(z ~ x), col = "red")
set.seed(711)
x = seq(0, 4, length = 100)
y = -x + jitter(rep(1:5, each = 20), 2)
z = rep(1:5, each = 20)
par(mar = c(4, 4, 0.1, 0.1))
plot(x, y)
abline(lm(z ~ y), col = "red")
set.seed(711)
x = seq(0, 4, length = 100)
y = -x + jitter(rep(1:5, each = 20), 2)
z = rep(1:5, each = 20)
par(mar = c(4, 4, 0.1, 0.1))
plot(x, y)
abline(lm(y ~ z), col = "red")
set.seed(711)
x = seq(0, 4, length = 100)
y = -x + jitter(rep(1:5, each = 20), 2)
z = rep(1:5, each = 20)
par(mar = c(4, 4, 0.1, 0.1))
plot(x, y)
abline(lm(x ~ z), col = "red")
set.seed(711)
x = seq(0, 4, length = 100)
y = -x + jitter(rep(1:5, each = 20), 2)
z = rep(1:5, each = 20)
par(mar = c(4, 4, 0.1, 0.1))
plot(x, y)
abline(lm(x ~ y), col = "red")
set.seed(711)
x = seq(0, 4, length = 100)
y = -x + jitter(rep(1:5, each = 20), 2)
z = rep(1:5, each = 20)
par(mar = c(4, 4, 0.1, 0.1))
plot(x, y)
abline(lm(y ~ x), col = "red")
plot(x, y, pch = 20, col = z)
set.seed(711)
x = seq(0, 4, length = 100)
y = -x + jitter(rep(1:5, each = 20), 2)
z = rep(1:5, each = 20)
par(mar = c(4, 4, 0.1, 0.1))
plot(x, y)
abline(lm(y ~ x), col = "red")
lm(y ~ z)
lm(y ~ x)
?lm
residuals(lm(y ~ z))
set.seed(711)
x = seq(0, 4, length = 100)
y = -x + jitter(rep(1:5, each = 20), 2)
z = rep(1:5, each = 20)
par(mar = c(4, 4, 0.1, 0.1))
plot(x, y)
abline(lm(y ~ x), col = "red")
lm(y ~ z)
res <- residuals(lm(y ~ z))
abline(lm(res ~ x), col = "red")
lm(y ~ z)
res <- residuals(lm(y ~ z))
abline(lm(res ~ x), col = "red")
set.seed(711)
x = seq(0, 4, length = 100)
y = -x + jitter(rep(1:5, each = 20), 2)
z = rep(1:5, each = 20)
par(mar = c(4, 4, 0.1, 0.1))
plot(x, y)
abline(lm(y ~ x), col = "red")
lm(y ~ z)
res <- residuals(lm(y ~ z))
abline(lm(res ~ x), col = "red")
plot(x, res)
abline(lm(res ~ x), col = "red")
plot(x, y)
abline(lm(res ~ x), col = "red")
abline(lm(res ~ x), col = "red")
abline(lm(res ~ x), col = z)
abline(lm(res ~ x), group = z)
lm(res ~ x)
cc <- data.frame(x,y,z)
View(cc)
ggplot(moto, aes(x, y)) +
geom_point(aes(color = z))
library(ggplot2)
set.seed(711)
x = seq(0, 4, length = 100)
y = -x + jitter(rep(1:5, each = 20), 2)
z = rep(1:5, each = 20)
moto <- data.frame(x,y,z)
ggplot(moto)
ggplot(moto, aes(x, y)) +
geom_point(aes(color = z))
library(ggplot2)
set.seed(711)
x = seq(0, 4, length = 100)
y = -x + jitter(rep(1:5, each = 20), 2)
z = rep(1:5, each = 20)
z <- as.factor(z)
moto <- data.frame(x,y,z)
ggplot(moto)
ggplot(moto, aes(x, y)) +
geom_point(aes(color = z))
ggplot(moto, aes(x, y)) +
geom_line(lm)
ggplot(moto, aes(x, y)) +
geom_line(lm(y~x))
ggplot(moto, aes(x, y)) +
geom_line(lm(y ~ x))
ggplot(moto, aes(x, y)) +
geom_smooth(method='lm')
ggplot(moto, aes(x, y)) +
geom_point(aes(color = z)) +
geom_smooth(method='lm')
lm1 <- lm(y ~ z,moto)
res <- residuals(lm1)
ggplot(moto, aes(x,res)) +
geom_point(aes(color = z))
ggplot(moto, aes(x,res)) +
geom_smooth(method='lm')
ggplot(moto, aes(x,res)) +
geom_point(aes(color = z)) +
geom_smooth(method='lm')
ggplot(moto, aes(x,res)) +
geom_point(aes(color = z)) +
geom_smooth(method='lm',group=z)
ggplot(moto, aes(x,res)) +
geom_point(aes(color = z)) +
geom_smooth(method='lm')
ggplot(moto, aes(x,res),group=z) +
geom_point(aes(color = z)) +
geom_smooth(method='lm')
ggplot(moto, aes(x,res),group=z) +
geom_point(aes(color = z)) +
geom_line()
res <- residuals(lm1)
ggplot(moto, aes(x,res),group=z) +
geom_point(aes(color = z))
ggplot(moto, aes(x,res),group=z) +
geom_point(aes(color = z))
ggplot(subset(moto,z==1), aes(x,res),group=z)
+
geom_smooth(method='lm')
ggplot(subset(moto,z==1), aes(x,res),group=z)+
geom_smooth(method='lm')
moto <- subset(moto,z==1)
library(ggplot2)
set.seed(711)
x = seq(0, 4, length = 100)
y = -x + jitter(rep(1:5, each = 20), 2)
z = rep(1:5, each = 20)
z <- as.factor(z)
moto <- data.frame(x,y,z)
moto1 <- subset(moto,z==1)
ggplot(moto1, aes(x,res),group=z)+
geom_smooth(method='lm')
ggplot(moto1, aes(x,res))+
geom_smooth(method='lm')
View(moto1)
lm1 <- lm(y ~ z,moto)
res <- residuals(lm1)
ggplot(moto1, aes(x,res))+
geom_smooth(method='lm')
moto <- within(moto,res <- residuals(lm1))
View(cc)
View(moto)
moto1 <- subset(moto,z==1)
ggplot(moto1, aes(x,res))+
geom_smooth(method='lm')
geom_smooth(moto1, aes(x,res),method='lm')
ggplot(moto, aes(x,res),group=z)+
geom_smooth(moto1, aes(x,res),method='lm')
ggplot(moto, aes(x,res),group=z)+
geom_smooth(moto1,method='lm')
ggplot(moto, aes(x,res),group=z)+
geom_smooth(moto1,method='lm')
ggplot(moto, aes(x,res),group=z)
ggplot(moto, aes(x,res),group=z)+
geom_point(aes(color = z)) +
geom_smooth(moto1,method='lm')
ggplot(moto, aes(x,res),group=z)+
geom_point(aes(color = z)) +
geom_smooth(data = moto1,method='lm')
ggplot(moto, aes(x, y)) +
geom_point(aes(color = z))
ggplot(moto, aes(x, y)) +
geom_point(aes(color = z)) +
geom_smooth(method='lm')
ggplot(moto, aes(x,res),group=z)+
geom_point(aes(color = z)) +
geom_smooth(data = moto1,method='lm')+
geom_smooth(data = moto2,method='lm')
moto1 <- subset(moto,z==1)
moto2 <- subset(moto,z==2)
moto3 <- subset(moto,z==3)
moto4 <- subset(moto,z==4)
moto5 <- subset(moto,z==5)
ggplot(moto, aes(x,res),group=z)+
geom_point(aes(color = z)) +
geom_smooth(data = moto1,method='lm')+
geom_smooth(data = moto2,method='lm')
ggplot(moto, aes(x,res),group=z)+
geom_point(aes(color = z)) +
geom_smooth(data = moto1,method='lm')+
geom_smooth(data = moto2,method='lm')+
geom_smooth(data = moto3,method='lm')+
geom_smooth(data = moto4,method='lm')+
geom_smooth(data = moto5,method='lm')
ggplot(moto, aes(x,res),group=z)+
geom_point(aes(color = z)) +
geom_smooth(data = moto1,method='lm',se=F)+
geom_smooth(data = moto2,method='lm',se=F)+
geom_smooth(data = moto3,method='lm',se=F)+
geom_smooth(data = moto4,method='lm',se=F)+
geom_smooth(data = moto5,method='lm',se=F)
ggplot(moto, aes(x,res),group=z)+
geom_point(aes(color = z)) +
geom_smooth(data = moto1,method='lm',se=F,color = z)+
geom_smooth(data = moto2,method='lm',se=F)+
geom_smooth(data = moto3,method='lm',se=F)+
geom_smooth(data = moto4,method='lm',se=F)+
geom_smooth(data = moto5,method='lm',se=F)
ggplot(moto, aes(x,res),group=z)+
geom_point(aes(color = z)) +
geom_smooth(data = moto1,method='lm',se=F)+
geom_smooth(data = moto2,method='lm',se=F)+
geom_smooth(data = moto3,method='lm',se=F)+
geom_smooth(data = moto4,method='lm',se=F)+
geom_smooth(data = moto5,method='lm',se=F)
ggplot(moto, aes(x,res),group=z) +
geom_point(aes(color = z))
ggplot(moto, aes(x,y),group=z)+
geom_point(aes(color = z)) +
geom_smooth(data = moto1,method='lm',se=F)+
geom_smooth(data = moto2,method='lm',se=F)+
geom_smooth(data = moto3,method='lm',se=F)+
geom_smooth(data = moto4,method='lm',se=F)+
geom_smooth(data = moto5,method='lm',se=F)
ggplot(moto, aes(x, y)) +
geom_point(aes(color = z)) +
geom_smooth(method='lm')
ggplot(moto, aes(x, y)) +
geom_point(aes(color = z)) +
geom_smooth(method='lm',se=F)
ggplot(moto, aes(x,y),group=z)+
geom_point(aes(color = z)) +
geom_smooth(data = moto1,method='lm',se=F)+
geom_smooth(data = moto2,method='lm',se=F)+
geom_smooth(data = moto3,method='lm',se=F)+
geom_smooth(data = moto4,method='lm',se=F)+
geom_smooth(data = moto5,method='lm',se=F)
library(ggplot2)
set.seed(711)
x = seq(0, 4, length = 100)
y = -x + jitter(rep(1:5, each = 20), 2)
z = rep(1:5, each = 20)
z <- as.factor(z)
moto <- data.frame(x,y,z)
lm1 <- lm(y ~ z,moto)
moto <- within(moto,res <- residuals(lm1))
moto1 <- subset(moto,z==1)
moto2 <- subset(moto,z==2)
moto3 <- subset(moto,z==3)
moto4 <- subset(moto,z==4)
moto5 <- subset(moto,z==5)
#ggplot(moto)
ggplot(moto, aes(x, y)) +
geom_point(aes(color = z))
ggplot(moto, aes(x, y)) +
geom_point(aes(color = z)) +
geom_smooth(method='lm',se=F)
ggplot(moto, aes(x,y),group=z)+
geom_point(aes(color = z)) +
geom_smooth(data = moto1,method='lm',se=F)+
geom_smooth(data = moto2,method='lm',se=F)+
geom_smooth(data = moto3,method='lm',se=F)+
geom_smooth(data = moto4,method='lm',se=F)+
geom_smooth(data = moto5,method='lm',se=F)
library(ggplot2)
set.seed(711)
x = seq(0, 4, length = 100)
y = -x + jitter(rep(1:5, each = 20), 2)
z = rep(1:5, each = 20)
z <- as.factor(z)
moto <- data.frame(x,y,z)
lm1 <- lm(y ~ z,moto)
moto <- within(moto,res <- residuals(lm1))
moto1 <- subset(moto,z==1)
moto2 <- subset(moto,z==2)
moto3 <- subset(moto,z==3)
moto4 <- subset(moto,z==4)
moto5 <- subset(moto,z==5)
ggplot(moto, aes(x, y)) +
geom_point(aes(color = z)) +
geom_smooth(method='lm',se=F)
library(ggplot2)
set.seed(711)
x = seq(0, 4, length = 100)
y = -x + jitter(rep(1:5, each = 20), 2)
z = rep(1:5, each = 20)
z <- as.factor(z)
moto <- data.frame(x,y,z)
lm1 <- lm(y ~ z,moto)
moto <- within(moto,res <- residuals(lm1))
moto1 <- subset(moto,z==1)
moto2 <- subset(moto,z==2)
moto3 <- subset(moto,z==3)
moto4 <- subset(moto,z==4)
moto5 <- subset(moto,z==5)
ggplot(moto, aes(x, y)) +
geom_point(aes(color = z)) +
geom_smooth(method='lm',se=F)
ggplot(moto, aes(x,y),group=z)+
geom_point(aes(color = z)) +
geom_smooth(data = moto1,method='lm',se=F)+
geom_smooth(data = moto2,method='lm',se=F)+
geom_smooth(data = moto3,method='lm',se=F)+
geom_smooth(data = moto4,method='lm',se=F)+
geom_smooth(data = moto5,method='lm',se=F)
setwd('F:\\Mysite\\Mysite')
blogdown:::serve_site()
library(ggplot2)
data(diamonds)
knitr::kable(head(diamonds),caption="数据概要",align='c')
#原始变量关系
ggplot(diamonds, aes(carat,price)) +
geom_bin2d() +
facet_wrap(~cut, nrow = 2)
#y变量取对数
ggplot(diamonds, aes(log(carat),price)) +
geom_point() +
facet_wrap(~cut, nrow = 2)
#x变量取对数
ggplot(diamonds, aes(carat,log(price))) +
geom_bin2d() +
facet_wrap(~cut, nrow = 2)
#都取对数，最终成为线性关系。
ggplot(diamonds, aes(log(carat), log10(price))) +
geom_bin2d(bins = 100) +
facet_wrap(~cut, nrow = 2)
library(haven)
setwd("E:/R_codes/capplot")
X2010 <- read_dta("2010.dta")
xy <- read_dta("id.dta")
hho <- read_dta("aggregrate.dta")
nrow(hho)
set.seed(13)#设置随机数种子
sample <- sample(1:nrow(hho),600,replace = F)#抽取600个样本
hhosampled <- hho[sample,]#抽取
nrow(hhosampled)
library(ggplot2)
scattered <- ggplot(hho,aes(x=agem,y=inc,group=type,shape=type,color=type,weight=fswt_nat)) +
ylim(0, 20000) +
labs(title = " ",x = "年龄",y = "人民币(元）")+
geom_smooth(span = 10,size=1.5) +
geom_point(data = hhosampled, alpha = 4/7,size = 2.5 )  +
annotate("text", x = 70, y = 200, label="数据来源：CFPS,正常散点", size = 4) + #注解
theme(legend.position = c(0.9,0.9))#图例位置
scattered
scattered2 <- ggplot(hho,aes(x=agem,y=inc,weight=fswt_nat)) +
ylim(0, 20000) +
labs(title = " ",x = "年龄",y = "人民币(元）")+
geom_bin2d(bins = 70)  +
geom_smooth(span = 10,size=1.5,colour='red') +
annotate("text", x = 70, y = 200, label=" ", size = 4) + #注解
theme(legend.position = c(0.9,0.9))#图例位置
scattered2
i <- ggplot(economics, aes(date, unemploy))
i + geom_area()
i + geom_line()
setwd('F:\\Mysite\\Mysite')
blogdown:::serve_site()
