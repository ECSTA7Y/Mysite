ps <- paste('Winner:',sub[ ,2], sub[ ,3]) # get every year winner
mtext(ps,side = 1,cex=1.1)
leg.txt <- c("0-25%", "25-50%", "50-75%", "75-100%")
legend("bottomright", leg.txt,
fill = colors,title= "Republican Percent",
cex=0.88)
}
} ,movie.name="election_en.gif",
interval = 2)
library(maps)
library(animation)
library(magrittr)
library(viridis)
library(dplyr)
library(readr)
election <- read_csv("E:/elections.csv") #读入数据
election$sharedem <- election$dem/(election$rep+election$dem+election$other)
election$sharerep <- election$rep/(election$rep+election$dem+election$other)
data(viridis.map)
viridis.map <- viridis.map %>%
filter(opt=='C')
coldt <- viridis.map[election$sharerep*250,] %>%
select(-opt)
election$county.col <- rgb(coldt[,1],coldt[,2],coldt[,3])
one <- viridis.map[0.125*250,]
two <- viridis.map[0.375*250,]
thre <- viridis.map[0.625*250,]
fo <- viridis.map[0.875*250,]
fi <- rgb(one[,1],one[,2],one[,3])
se <- rgb(two[,1],two[,2],two[,3])
thr <- rgb(thre[,1],thre[,2],thre[,3])
fr <- rgb(fo[,1],fo[,2],fo[,3])
library(readr)
setwd('C:/Users/xsong/Desktop/table')
president <- read_csv("president.csv",
locale = locale(encoding = "GB2312")) %>%
as.data.frame()
presidenten <- read_csv("president_en.csv") %>%
as.data.frame()
colors = c(fi,se,thr, fr)
saveGIF({
for (i in seq(1960,2012,4)){         # 1960-2012 loop
thisyear <- subset(election,year == i)
map(database = "county",  # plot by year
col = thisyear$county.col,
fill = T)
tit <- paste('United States Presidential Election:',i) # get every year title
title(tit,cex.main=1.3) # Add title
sub <- subset(presidenten,year == i)
ps <- paste('Winner:',sub[ ,2], sub[ ,3]) # get every year winner
mtext(ps,side = 1,cex=1.1)
leg.txt <- c("0-25%", "25-50%", "50-75%", "75-100%")
legend("bottomright", leg.txt,
fill = colors,title= "Republican Percent",
cex=0.88)
}
} ,movie.name="election_en.gif",
interval = 2)
saveGIF({
for (i in seq(1960,2012,4)){         # 1960-2012 loop
thisyear <- subset(election,year == i)
map(database = "county",  # plot by year
col = thisyear$county.col,
fill = T)
tit <- paste('United States Presidential Election:',i) # get every year title
title(tit,cex.main=1.3) # Add title
sub <- subset(presidenten,year == i)
ps <- paste('Winner:',sub[ ,2], sub[ ,3]) # get every year winner
mtext(ps,side = 1,cex=1.1)
leg.txt <- c("0-25%", "25-50%", "50-75%", "75-100%")
legend("bottomright", leg.txt,
fill = colors,title= "Republican Support",
cex=0.88)
}
} ,movie.name="election_en.gif",
interval = 2)
saveGIF({
for (i in seq(1960,2012,4)){         # 1960-2012 loop
thisyear <- subset(election,year == i)
map(database = "county",  # plot by year
col = thisyear$county.col,
fill = T)
tit <- paste('United States Presidential Election:',i) # get every year title
title(tit,cex.main=1.3) # Add title
sub <- subset(presidenten,year == i)
ps <- paste('Winner:',sub[ ,2],'-',sub[ ,3]) # get every year winner
mtext(ps,side = 1,cex=1.1)
leg.txt <- c("0-25%", "25-50%", "50-75%", "75-100%")
legend("bottomright", leg.txt,
fill = colors,title= "Republican Support",
cex=0.87)
}
} ,movie.name="election_en.gif",
interval = 2)
saveGIF({
for (i in seq(1960,2012,4)){         # 1960-2012 loop
thisyear <- subset(election,year == i)
map(database = "county",  # plot by year
col = thisyear$county.col,
fill = T)
tit <- paste('United States Presidential Election:',i) # get every year title
title(tit,cex.main=1.3) # Add title
sub <- subset(presidenten,year == i)
ps <- paste('Winner:',sub[ ,2],'-',sub[ ,3]) # get every year winner
mtext(ps,side = 1,cex=1.1)
leg.txt <- c("0-25%", "25-50%", "50-75%", "75-100%")
legend("bottomright", leg.txt,
fill = colors,title= "Republican Support",
cex=0.86)
}
} ,movie.name="election_en.gif",
interval = 2) # set every plot time
saveGIF({
for (i in seq(1960,2012,4)){         # 1960-2012 loop
thisyear <- subset(election,year == i)
map(database = "county",  # plot by year
col = thisyear$county.col,
fill = T)
tit <- paste('United States Presidential Election:',i) # get every year title
title(tit,cex.main=1.3) # Add title
sub <- subset(presidenten,year == i)
ps <- paste('Winner:',sub[ ,2],'-',sub[ ,3]) # get every year winner
mtext(ps,side = 1,cex=1.1)
leg.txt <- c("0-25%", "25-50%", "50-75%", "75-100%")
legend("bottomright", leg.txt,
fill = colors,title= "Republican \n
Support",
cex=0.86)
}
} ,movie.name="election_en.gif",
interval = 2) # set every plot time
saveGIF({
for (i in seq(1960,2012,4)){         # 1960-2012 loop
thisyear <- subset(election,year == i)
map(database = "county",  # plot by year
col = thisyear$county.col,
fill = T)
tit <- paste('United States Presidential Election:',i) # get every year title
title(tit,cex.main=1.3) # Add title
sub <- subset(presidenten,year == i)
ps <- paste('Winner:',sub[ ,2],'-',sub[ ,3]) # get every year winner
mtext(ps,side = 1,cex=1.1)
leg.txt <- c("0-25%", "25-50%", "50-75%", "75-100%")
legend("bottomright", leg.txt,
fill = colors,title= "Republican
Support",
cex=0.86)
}
} ,movie.name="election_en.gif",
interval = 2) # set every plot time
saveGIF({
for (i in seq(1960,2012,4)){         # 1960-2012 loop
thisyear <- subset(election,year == i)
map(database = "county",  # plot by year
col = thisyear$county.col,
fill = T)
tit <- paste('United States Presidential Election:',i) # get every year title
title(tit,cex.main=1.3) # Add title
sub <- subset(presidenten,year == i)
ps <- paste('Winner:',sub[ ,2],'-',sub[ ,3]) # get every year winner
mtext(ps,side = 1,cex=1.1)
leg.txt <- c("0-25%", "25-50%", "50-75%", "75-100%")
legend("bottomright", leg.txt,
fill = colors,title= "Republican \n Support",
cex=0.86)
}
} ,movie.name="election_en.gif",
interval = 2) # set every plot time
?v
?legend
## Run the example in '?matplot' or the following:
leg.txt <- c("Setosa     Petals", "Setosa     Sepals",
"Versicolor Petals", "Versicolor Sepals")
y.leg <- c(4.5, 3, 2.1, 1.4, .7)
cexv  <- c(1.2, 1, 4/5, 2/3, 1/2)
matplot(c(1, 8), c(0, 4.5), type = "n", xlab = "Length", ylab = "Width",
main = "Petal and Sepal Dimensions in Iris Blossoms")
for (i in seq(cexv)) {
text  (1, y.leg[i] - 0.1, paste("cex=", formatC(cexv[i])), cex = 0.8, adj = 0)
legend(3, y.leg[i], leg.txt, pch = "sSvV", col = c(1, 3), cex = cexv[i])
}
## cex *vector* [in R <= 3.5.1 has 'if(xc < 0)' w/ length(xc) == 2]
legend(6,1, leg.txt, pch = "sSvV", col = c(1, 3), cex = 1+(-1:2)/8)
## 'merge = TRUE' for merging lines & points:
x <- seq(-pi, pi, len = 65)
plot(x, sin(x), type = "l", ylim = c(-1.2, 1.8), col = 3, lty = 2)
points(x, cos(x), pch = 3, col = 4)
lines(x, tan(x), type = "b", lty = 1, pch = 4, col = 6)
title("legend(..., lty = c(2, -1, 1), pch = c(NA, 3, 4), merge = TRUE)",
cex.main = 1.1)
legend(-1, 1.9, c("sin", "cos", "tan"), col = c(3, 4, 6),
text.col = "green4", lty = c(2, -1, 1), pch = c(NA, 3, 4),
merge = TRUE, bg = "gray90")
## right-justifying a set of labels: thanks to Uwe Ligges
x <- 1:5; y1 <- 1/x; y2 <- 2/x
plot(rep(x, 2), c(y1, y2), type = "n", xlab = "x", ylab = "y")
lines(x, y1); lines(x, y2, lty = 2)
temp <- legend("topright", legend = c(" ", " "),
text.width = strwidth("1,000,000"),
lty = 1:2, xjust = 1, yjust = 1,
title = "Line Types")
text(temp$rect$left + temp$rect$w, temp$text$y,
c("1,000", "1,000,000"), pos = 2)
x <- seq(-pi, pi, len = 65)
plot(x, sin(x), type = "l", col = 2, xlab = expression(phi),
ylab = expression(f(phi)))
abline(h = -1:1, v = pi/2*(-6:6), col = "gray90")
lines(x, cos(x), col = 3, lty = 2)
ex.cs1 <- expression(plain(sin) * phi,  paste("cos", phi))  # 2 ways
utils::str(legend(-3, .9, ex.cs1, lty = 1:2, plot = FALSE,
adj = c(0, 0.6)))  # adj y !
legend(-3, 0.9, ex.cs1, lty = 1:2, col = 2:3,  adj = c(0, 0.6))
require(stats)
x <- rexp(100, rate = .5)
hist(x, main = "Mean and Median of a Skewed Distribution")
abline(v = mean(x),   col = 2, lty = 2, lwd = 2)
abline(v = median(x), col = 3, lty = 3, lwd = 2)
ex12 <- expression(bar(x) == sum(over(x[i], n), i == 1, n),
hat(x) == median(x[i], i == 1, n))
utils::str(legend(4.1, 30, ex12, col = 2:3, lty = 2:3, lwd = 2))
## 'Filled' boxes -- for more, see example(plot.factor)
op <- par(bg = "white") # to get an opaque box for the legend
plot(cut(weight, 3) ~ group, data = PlantGrowth, col = NULL,
density = 16*(1:3))
par(op)
## Using 'ncol' :
x <- 0:64/64
matplot(x, outer(x, 1:7, function(x, k) sin(k * pi * x)),
type = "o", col = 1:7, ylim = c(-1, 1.5), pch = "*")
op <- par(bg = "antiquewhite1")
legend(0, 1.5, paste("sin(", 1:7, "pi * x)"), col = 1:7, lty = 1:7,
pch = "*", ncol = 4, cex = 0.8)
legend(.8,1.2, paste("sin(", 1:7, "pi * x)"), col = 1:7, lty = 1:7,
pch = "*", cex = 0.8)
legend(0, -.1, paste("sin(", 1:4, "pi * x)"), col = 1:4, lty = 1:4,
ncol = 2, cex = 0.8)
legend(0, -.4, paste("sin(", 5:7, "pi * x)"), col = 4:6,  pch = 24,
ncol = 2, cex = 1.5, lwd = 2, pt.bg = "pink", pt.cex = 1:3)
par(op)
saveGIF({
for (i in seq(1960,2012,4)){         # 1960-2012 loop
thisyear <- subset(election,year == i)
map(database = "county",  # plot by year
col = thisyear$county.col,
fill = T)
tit <- paste('United States Presidential Election:',i) # get every year title
title(tit,cex.main=1.3) # Add title
sub <- subset(presidenten,year == i)
ps <- paste('Winner:',sub[ ,2],'-',sub[ ,3]) # get every year winner
mtext(ps,side = 1,cex=1.1)
leg.txt <- c("0-25%", "25-50%", "50-75%", "75-100%")
legend("bottomright", leg.txt,
fill = colors,title= "Republican Support",
cex=0.86)
}
} ,movie.name="election_en.gif",
interval = 2) # set every plot time
saveGIF({
for (i in seq(1960,2012,4)){         # 1960-2012 loop
thisyear <- subset(election,year == i)
map(database = "county",  # plot by year
col = thisyear$county.col,
fill = T)
tit <- paste('United States Presidential Election:',i) # get every year title
title(tit,cex.main=1.3) # Add title
sub <- subset(presidenten,year == i)
ps <- paste('Winner:',sub[ ,2],'-',sub[ ,3]) # get every year winner
mtext(ps,side = 1,cex=1.1)
leg.txt <- c("0-25%", "25-50%", "50-75%", "75-100%")
legend("bottomright", leg.txt,
fill = colors,title= "Republican",sub=' Support',
cex=0.86)
}
} ,movie.name="election_en.gif",
interval = 2) # set every plot time
saveGIF({
for (i in seq(1960,2012,4)){         # 1960-2012 loop
thisyear <- subset(election,year == i)
map(database = "county",  # plot by year
col = thisyear$county.col,
fill = T)
tit <- paste('United States Presidential Election:',i) # get every year title
title(tit,cex.main=1.3) # Add title
sub <- subset(presidenten,year == i)
ps <- paste('Winner:',sub[ ,2],'-',sub[ ,3]) # get every year winner
mtext(ps,side = 1,cex=1.1)
leg.txt <- c("0-25%", "25-50%", "50-75%", "75-100%")
legend("bottomright", leg.txt,
fill = colors,title= "Republican Support",
cex=0.86,title.adj = 0.9)
}
} ,movie.name="election_en.gif",
interval = 2) # set every plot time
saveGIF({
for (i in seq(1960,2012,4)){         # 1960-2012 loop
thisyear <- subset(election,year == i)
map(database = "county",  # plot by year
col = thisyear$county.col,
fill = T)
tit <- paste('United States Presidential Election:',i) # get every year title
title(tit,cex.main=1.3) # Add title
sub <- subset(presidenten,year == i)
ps <- paste('Winner:',sub[ ,2],'-',sub[ ,3]) # get every year winner
mtext(ps,side = 1,cex=1.1)
leg.txt <- c("0-25%", "25-50%", "50-75%", "75-100%")
legend("bottomright", leg.txt,
fill = colors,title= "Republican Support",
cex=0.86,title.adj = 0.1)
}
} ,movie.name="election_en.gif",
interval = 2) # set every plot time
saveGIF({
for (i in seq(1960,2012,4)){         # 1960-2012 loop
thisyear <- subset(election,year == i)
map(database = "county",  # plot by year
col = thisyear$county.col,
fill = T)
tit <- paste('United States Presidential Election:',i) # get every year title
title(tit,cex.main=1.3) # Add title
sub <- subset(presidenten,year == i)
ps <- paste('Winner:',sub[ ,2],'-',sub[ ,3]) # get every year winner
mtext(ps,side = 1,cex=1.1)
leg.txt <- c("0-25%", "25-50%", "50-75%", "75-100%")
legend("bottomright", leg.txt,
fill = colors,title= atop("Republican","Support"),
cex=0.86,title.adj = 0.1)
}
} ,movie.name="election_en.gif",
interval = 2) # set every plot time
??atop
library(grDevices)
saveGIF({
for (i in seq(1960,2012,4)){         # 1960-2012 loop
thisyear <- subset(election,year == i)
map(database = "county",  # plot by year
col = thisyear$county.col,
fill = T)
tit <- paste('United States Presidential Election:',i) # get every year title
title(tit,cex.main=1.3) # Add title
sub <- subset(presidenten,year == i)
ps <- paste('Winner:',sub[ ,2],'-',sub[ ,3]) # get every year winner
mtext(ps,side = 1,cex=1.1)
leg.txt <- c("0-25%", "25-50%", "50-75%", "75-100%")
legend("bottomright", leg.txt,
fill = colors,title= atop("Republican","Support"),
cex=0.86,title.adj = 0.1)
}
} ,movie.name="election_en.gif",
interval = 2) # set every plot time
saveGIF({
for (i in seq(1960,2012,4)){         # 1960-2012 loop
thisyear <- subset(election,year == i)
map(database = "county",  # plot by year
col = thisyear$county.col,
fill = T)
tit <- paste('United States Presidential Election:',i) # get every year title
title(tit,cex.main=1.3) # Add title
sub <- subset(presidenten,year == i)
ps <- paste('Winner:',sub[ ,2],'-',sub[ ,3]) # get every year winner
mtext(ps,side = 1,cex=1.1)
leg.txt <- c("0-25%", "25-50%", "50-75%", "75-100%")
legend("bottomright", leg.txt,
fill = colors,title= expression(atop("Republican","Support")),
cex=0.86,title.adj = 0.1)
}
} ,movie.name="election_en.gif",
interval = 2) # set every plot time
par(lheight=0.2)
saveGIF({
for (i in seq(1960,2012,4)){         # 1960-2012 loop
thisyear <- subset(election,year == i)
map(database = "county",  # plot by year
col = thisyear$county.col,
fill = T)
tit <- paste('United States Presidential Election:',i) # get every year title
title(tit,cex.main=1.3) # Add title
sub <- subset(presidenten,year == i)
ps <- paste('Winner:',sub[ ,2],'-',sub[ ,3]) # get every year winner
mtext(ps,side = 1,cex=1.1)
leg.txt <- c("0-25%", "25-50%", "50-75%", "75-100%")
legend("bottomright", leg.txt,
fill = colors,title= expression(atop("Republican","Support")),
cex=0.86,title.adj = 0.1)
}
} ,movie.name="election_en.gif",
interval = 2) # set every plot time
saveGIF({
for (i in seq(1960,2012,4)){         # 1960-2012 loop
thisyear <- subset(election,year == i)
map(database = "county",  # plot by year
col = thisyear$county.col,
fill = T)
tit <- paste('United States Presidential Election:',i) # get every year title
title(tit,cex.main=1.3) # Add title
sub <- subset(presidenten,year == i)
ps <- paste('Winner:',sub[ ,2],'-',sub[ ,3]) # get every year winner
mtext(ps,side = 1,cex=1.1)
leg.txt <- c("0-25%", "25-50%", "50-75%", "75-100%")
legend("bottomright", leg.txt,
fill = colors,title= ("Republican Support"),
cex=0.83)
}
} ,movie.name="election_en.gif",
interval = 2) # set every plot time
saveGIF({
for (i in seq(1960,2012,4)){         # 1960-2012 loop
thisyear <- subset(election,year == i)
map(database = "county",  # plot by year
col = thisyear$county.col,
fill = T)
tit <- paste('United States Presidential Election:',i) # get every year title
title(tit,cex.main=1.3) # Add title
sub <- subset(presidenten,year == i)
ps <- paste('Winner:',sub[ ,2],'-',sub[ ,3]) # get every year winner
mtext(ps,side = 1,cex=1.1)
leg.txt <- c("0-25%", "25-50%", "50-75%", "75-100%")
legend("bottomleft", leg.txt,
fill = colors,title= ("Republican Support"),
cex=0.83)
}
} ,movie.name="election_en.gif",
interval = 2) # set every plot time
saveGIF({
for (i in seq(1960,2012,4)){         # 1960-2012 loop
thisyear <- subset(election,year == i)
map(database = "county",  # plot by year
col = thisyear$county.col,
fill = T)
tit <- paste('United States Presidential Election:',i) # get every year title
title(tit,cex.main=1.3) # Add title
sub <- subset(presidenten,year == i)
ps <- paste('Winner:',sub[ ,2],'-',sub[ ,3]) # get every year winner
mtext(ps,side = 1,cex=1.1)
leg.txt <- c("0-25%", "25-50%", "50-75%", "75-100%")
legend("bottomright", leg.txt,
fill = colors,title= ("Republican %"),
cex=0.83)
}
} ,movie.name="election_en.gif",
interval = 2) # set every plot time
saveGIF({
for (i in seq(1960,2012,4)){         # 1960-2012 loop
thisyear <- subset(election,year == i)
map(database = "county",  # plot by year
col = thisyear$county.col,
fill = T)
tit <- paste('United States Presidential Election:',i) # get every year title
title(tit,cex.main=1.3) # Add title
sub <- subset(presidenten,year == i)
ps <- paste('Winner:',sub[ ,2],'-',sub[ ,3]) # get every year winner
mtext(ps,side = 1,cex=1.1)
leg.txt <- c("0-25%", "25-50%", "50-75%", "75-100%")
legend("bottomright", leg.txt,
fill = colors,title= ("Republican %"),
cex=0.83)
}
} ,movie.name="election_en.gif",
interval = 2) # set every plot time
library(maps)
library(animation)
library(magrittr)
library(viridis)
library(dplyr)
library(readr)
election <- read_csv("E:/elections.csv") #读入数据
election <- election %>%
mutate(sharedem = dem/(rep+dem+other),
sharerep = rep/(rep+dem+other))
data(viridis.map) # a viridis palette
viridis.map <- viridis.map %>%
filter(opt=='C')
coldt <- viridis.map[election$sharerep*250,] %>%
select(-opt)
election$county.col <- rgb(coldt[,1],coldt[,2],coldt[,3])
one <- viridis.map[0.125*250,]
two <- viridis.map[0.375*250,]
thre <- viridis.map[0.625*250,]
fo <- viridis.map[0.875*250,]
fi <- rgb(one[,1],one[,2],one[,3])
se <- rgb(two[,1],two[,2],two[,3])
thr <- rgb(thre[,1],thre[,2],thre[,3])
fr <- rgb(fo[,1],fo[,2],fo[,3])
library(readr)
setwd('C:/Users/xsong/Desktop/table')
president <- read_csv("president.csv",
locale = locale(encoding = "GB2312")) %>%
as.data.frame()
presidenten <- read_csv("president_en.csv") %>%
as.data.frame()
colors = c(fr,thr,se,fi)
saveGIF({
for (i in seq(1960,2012,4)){         # 1960-2012 loop
thisyear <- subset(election,year == i)
map(database = "county",  # plot by year
col = thisyear$county.col,
fill = T)
tit <- paste('United States Presidential Election:',i) # get every year title
title(tit,cex.main=1.3) # Add title
sub <- subset(presidenten,year == i)
ps <- paste('Winner:',sub[ ,2],'-',sub[ ,3]) # get every year winner
mtext(ps,side = 1,cex=1.1)
leg.txt <- c("75-100%","50-75%","25-50%","0-25%")
legend("bottomright", leg.txt,
fill = colors,title= ("Republican %"),
cex=0.83)
}
} ,movie.name="election_en.gif",
interval = 2) # set every plot time
setwd('F:\\Mysite\\Mysite')
blogdown:::serve_site()
blogdown:::stop_server()
blogdown:::stop_server()
