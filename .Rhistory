stu9 <- stu %>%
group_by(schids,grade9)
stu9 <-   within(stu9,{
matgreat <- NA
matgreat[stdmat > quantile(stdmat,na.rm=T)[4]] <- 1
matgreat[stdmat <= quantile(stdmat,na.rm=T)[4]] <- 0
})
table(stu9$matgreat)
tapply(stu9$stdmat,INDEX=stu9$matgreat, FUN=summary,na.rm = T) #分组统计
class <- within(class, {
subject[subject == 0] <- "Others"
subject[subject == 1] <- "Math"
subject[subject == 2] <- "Literature"
subject[subject == 3] <- "English"
#subject <- factor(subject,levels=c(0:3),labels=c("others","math","liter","english"))#班主任科目
know <- as.factor(know)#认识多少家长
drsmok[drsmok == 1] <- "no"
drsmok[drsmok == 2] <- "yes"
drsmok[drsmok == 3] <- "yes"
drsmok[drsmok == 4] <- "yes"
#drsmok <- factor(drsmok,levels=c(1:4),labels=c("no","yes","yes","yes"), ordered = T)
commhr <-  cmtmhor + cmtmmin/60 #与学生交流时间
cmtmhor <- NULL #删除列
cmtmmin <- NULL #删除列
})
school <- within(school, {
schtype[schtype == 1 ] <- 'Public'
schtype[schtype == 2 ] <- 'Others'
schtype[schtype == 3 ] <- 'Others'
schtype[schtype == 4 ] <- 'Others'
fight[fight == 1] <- 'Never'
fight[fight == 3] <- 'Yes'
fight[fight == 4] <- 'Yes'
fight <- factor(fight,ordered = T)
brkpb[brkpb == 1] <- 'Never'
brkpb[brkpb == 2] <- 'Yes'
brkpb[brkpb == 3] <- 'Yes'
brkpb[brkpb == 4] <- 'Yes'
brkpb  <- factor(brkpb ,ordered = T)
smok[smok == 1] <- 'Never'
smok[smok == 2] <- 'Yes'
smok[smok == 3] <- 'Yes'
smok[smok == 4] <- 'Yes'
smok  <- factor(smok ,ordered = T)
drink[drink == 1] <- 'Never'
drink[drink == 2] <- 'Yes'
drink[drink == 3] <- 'Yes'
drink <- factor(drink,ordered = T)
bknum[bknum > 40000] <- NA
})
parent <- within(parent, {
qianzi <- factor(qianzi,ordered = T)
#rename(money = ba06, clfee = ba03, qianzi = ba05, lifetm = ba13, dial = ba15, chidia = ba16, eduyexp = ba18, futcfd = ba21, huko = bd05, eduy = be07, dangy = be06, houspro = be24)
dial[dial == 1] <- "Mandarin"# 家长说的方言
dial[dial == 2] <- "Both"
dial[dial == 3] <- "Dialect"
dial[dial == 4] <- "Others"
chidia[chidia == 1] <- "Mandarin"#孩子在家说的方言
chidia[chidia == 2] <- "Both"
chidia[chidia == 3] <- "Dialect"
chidia[chidia == 4] <- "Others"
eduyexp[eduyexp == 1] <- 9
eduyexp[eduyexp == 2] <- 9
eduyexp[eduyexp %in% c(3,4,5)] <- 12
eduyexp[eduyexp == 6] <- 15
eduyexp[eduyexp == 7] <- 16
eduyexp[eduyexp == 8] <- 19
eduyexp[eduyexp == 9] <- 22
futcfd <- factor(futcfd,ordered = T)
huko[huko == 1] <- 'Agriculture'
huko[huko == 2] <- 'Non'
huko[huko == 3] <- 'Others'
huko[huko == 4] <- 'Others'
eduy[eduy == 1] <- 0
eduy[eduy == 2] <- 6
eduy[eduy == 3] <- 9
eduy[eduy %in% c(4,5,6)] <- 12
eduy[eduy == 7] <- 15
eduy[eduy == 8] <- 16
eduy[eduy == 9] <- 19
dangy[dangy == 1] <- 'Party member'
dangy[dangy == 2] <- 'Others'
dangy[dangy == 3] <- 'Others'
houspro[houspro == 1] <- 'Yes'
houspro[houspro == 2] <- 'No'
lifetm[lifetm > 15] <- NA
clfee[clfee > 10000] <- NA
money[money > 250] <- NA
})
setwd("E:/edu/data2")
library(foreign)
write.dta(`stu`, "stu.dta")
write.dta(`school`, "school.dta")
write.dta(`class`, "class.dta")
write.dta(`parent`, "parent.dta")
setwd("E:/edu/data2")
ceps <- read_dta("E:/edu/data2/ceps.dta")
ceps <- lapply(ceps, unclass) #解决标签问题
ceps <- data.frame(ceps)
View(ceps)
ceps$matgreat
write.dta(`stu9`, "stu.dta")
setwd("E:/edu/data2")
ceps <- read_dta("E:/edu/data2/ceps.dta")
ceps <- lapply(ceps, unclass) #解决标签问题
ceps <- data.frame(ceps)
ceps$matgreat
write.dta(`stu9`, "stu.dta")
View(stu9)
write.dta(`stu9`, "stu9.dta")
setwd("E:/edu/data2")
write.dta(`stu9`, "stu9.dta")
library(haven)
library(tidyverse)
library(dplyr)
library(lattice)
require(stats)
library(ggplot2)
library(rpart)
library(rpart.plot)
library(foreign)
#导入数据
setwd("E:/edu/data")
library(haven)
stu <- read_dta("E:/edu/data/stu.dta")
stu <- lapply(stu, unclass) #解决标签问题
stu <- data.frame(stu) #Error: `x` and `labels` must be same type
#class(stu) = c("labelled",class(stu))
class <- read_dta("E:/edu/data/class.dta")
class <- lapply(class, unclass)
class <- data.frame(class)
school <- read_dta("E:/edu/data/school.dta")
school <- lapply(school, unclass)
school <- data.frame(school)
parent <- read_dta("E:/edu/data/parent.dta")
parent <- lapply(parent, unclass)
parent <- data.frame(parent)
#筛选学生变量#重命名变量
stu <- stu %>%
select(ids, grade9, clsids, schids, tr_chn, tr_mat, tr_eng, stdchn, stdmat,stdeng,a01, b01, b06, b07, b1001, b1002, b1003, b11, b13, b27, b2201, b2202, b31,sweight) %>%
rename(sex = a01, onechi = b01, maedu = b06, faedu = b07,drunk = b1001, qurel = b1002, relation = b1003, desk = b11, net = b13, dialect = b27, chkhmwk = b2201, chkcouse = b2202, eduexp = b31)
#筛选班级变量#重命名变量
class <- class %>%
select(clsids, schids, hra07, hra08, hra09, hra01, hrb02, hrb06, hrb08a, hrb08b) %>%
rename(classtm = hra07, clpre = hra08, revitm = hra09, subject = hra01, know = hrb02, drsmok = hrb06, cmtmhor = hrb08a, cmtmmin = hrb08b)
school <- school %>%
select(schids, pla01, pla13, pla16, pla17, pla18, plc0102, ple1101, ple1102, ple1103, ple1104, plc0601) %>%
rename(schtype = pla01, schcsrm = pla13, comno = pla16, bknum = pla17, buget = pla18, eduqua = plc0102, fight = ple1101, brkpb = ple1102, smok = ple1103, drink = ple1104, teainc = plc0601)
parent <- parent %>%
select(ids, ba06, ba03, ba05, ba13, ba15, ba16, ba18, ba21, bd05, be07, be06, be24) %>%
rename(money = ba06, clfee = ba03, qianzi = ba05, lifetm = ba13, dial = ba15, chidia = ba16, eduyexp = ba18, futcfd = ba21, huko = bd05, eduy = be07, dangy = be06, houspro = be24)
##
stu <- within(stu, {
sex[sex ==1] <- "Male"   #性别
sex[sex ==2] <- "Female"
onechi[onechi ==1] <- "Yes"   #独生子女
onechi[onechi ==2] <- "No"
#onechi <- factor(onechi,levels=c(1,2),labels=c("yes","no"))
maedu[maedu == 1] <- 0   #母亲教育年限
maedu[maedu == 2] <- 6
maedu[maedu == 3] <- 9
maedu[maedu %in% c(4,5,6)] <- 12
maedu[maedu == 7] <- 15
maedu[maedu == 8] <- 16
maedu[maedu == 9] <- 19
#父亲教育年限
faedu[faedu == 1] <- 0
faedu[faedu == 2] <- 6
faedu[faedu == 3] <- 9
faedu[faedu %in% c(4,5,6)] <- 12
faedu[faedu == 7] <- 15
faedu[faedu == 8] <- 16
faedu[faedu == 9] <- 19
#教育期望
eduexp[eduexp == 1] <- 9
eduexp[eduexp == 2] <- 9
eduexp[eduexp %in% c(3,4,5)] <- 12
eduexp[eduexp == 6] <- 15
eduexp[eduexp == 7] <- 16
eduexp[eduexp == 8] <- 19
eduexp[eduexp == 9] <- 22
eduexp[eduexp == 10] <- 7
drunk[drunk == 1] <- "No"
drunk[drunk == 2] <- "Yes"
qurel[qurel == 1] <- "No"
qurel[qurel == 2] <- "Yes"
relation[relation == 1] <- "No"
relation[relation == 2] <- "Yes"
desk[desk == 1] <- "Yes"
desk[desk == 2] <- "No"
net[net == 0] <- "No"
net[net == 1] <- "No Internet"
net[net == 2] <- "Have Internet"
dialect[dialect == 1] <- "Mandarin"# 家长说的方言
dialect[dialect == 2] <- "Both"
dialect[dialect == 3] <- "Dialect"
dialect[dialect == 4] <- "Others"
chkhmwk[chkhmwk == 1] <- "Never"
chkhmwk[chkhmwk == 2] <- "1to2"
chkhmwk[chkhmwk == 3] <- "3to4"
chkhmwk[chkhmwk == 4] <- "Everyday"
chkcouse[chkcouse == 1] <- "Never"
chkcouse[chkcouse == 2] <- "1to2"
chkcouse[chkcouse == 3] <- "3to4"
chkcouse[chkcouse == 4] <- "Everyday"
#drunk <- factor(drunk,levels=c(1,2),labels=c("no","yes"))#父亲喝醉酒
#qurel <- factor(qurel,levels=c(1,2),labels=c("no","yes"))#父母之间吵架
#relation <- factor(relation,levels=c(1,2),labels=c("no","yes"))#父母关系好
#desk <- factor(desk,levels=c(1,2),labels=c("yes","no"))#独立书桌
#net <- factor(net,levels=c(0:2),labels=c("no","netno","net"))#电脑网络
#dialect <- factor(dialect,levels=c(1:4),labels=c("putong","both","dia","other"))#交流方言
#chkhmwk <- factor(chkhmwk,levels=c(1:4),labels=c("never","1to2","3to4","everyday"), ordered = T)#检查作业
#chkcouse <- factor(chkcouse,levels=c(1:4),labels=c("never","1to2","3to4","everyday"))#督促功课
tr_mat[tr_mat > 150] <- NA
tr_eng[tr_eng > 150] <- NA
tr_chn[tr_chn > 150] <- NA
trtotal <- tr_mat + tr_eng + tr_chn #原始总成绩
trrate <- trtotal / 450 ##得分率(总分其实不得而知)
sdtotal <- stdmat + stdchn + stdeng ##标准化总成绩
#quantile(stdmat,na.rm=T)[4]
})
stu9 <- stu %>%
group_by(schids,grade9)
stu9 <-   within(stu9,{
matgreat <- NA
matgreat[stdmat > quantile(stdmat,na.rm=T)[4]] <- 1
matgreat[stdmat <= quantile(stdmat,na.rm=T)[4]] <- 0
})
table(stu9$matgreat)
tapply(stu9$stdmat,INDEX=stu9$matgreat, FUN=summary,na.rm = T) #分组统计
class <- within(class, {
subject[subject == 0] <- "Others"
subject[subject == 1] <- "Math"
subject[subject == 2] <- "Literature"
subject[subject == 3] <- "English"
#subject <- factor(subject,levels=c(0:3),labels=c("others","math","liter","english"))#班主任科目
know <- as.factor(know)#认识多少家长
drsmok[drsmok == 1] <- "no"
drsmok[drsmok == 2] <- "yes"
drsmok[drsmok == 3] <- "yes"
drsmok[drsmok == 4] <- "yes"
#drsmok <- factor(drsmok,levels=c(1:4),labels=c("no","yes","yes","yes"), ordered = T)
commhr <-  cmtmhor + cmtmmin/60 #与学生交流时间
cmtmhor <- NULL #删除列
cmtmmin <- NULL #删除列
})
school <- within(school, {
schtype[schtype == 1 ] <- 'Public'
schtype[schtype == 2 ] <- 'Others'
schtype[schtype == 3 ] <- 'Others'
schtype[schtype == 4 ] <- 'Others'
fight[fight == 1] <- 'Never'
fight[fight == 3] <- 'Yes'
fight[fight == 4] <- 'Yes'
fight <- factor(fight,ordered = T)
brkpb[brkpb == 1] <- 'Never'
brkpb[brkpb == 2] <- 'Yes'
brkpb[brkpb == 3] <- 'Yes'
brkpb[brkpb == 4] <- 'Yes'
brkpb  <- factor(brkpb ,ordered = T)
smok[smok == 1] <- 'Never'
smok[smok == 2] <- 'Yes'
smok[smok == 3] <- 'Yes'
smok[smok == 4] <- 'Yes'
smok  <- factor(smok ,ordered = T)
drink[drink == 1] <- 'Never'
drink[drink == 2] <- 'Yes'
drink[drink == 3] <- 'Yes'
drink <- factor(drink,ordered = T)
bknum[bknum > 40000] <- NA
})
parent <- within(parent, {
qianzi <- factor(qianzi,ordered = T)
#rename(money = ba06, clfee = ba03, qianzi = ba05, lifetm = ba13, dial = ba15, chidia = ba16, eduyexp = ba18, futcfd = ba21, huko = bd05, eduy = be07, dangy = be06, houspro = be24)
dial[dial == 1] <- "Mandarin"# 家长说的方言
dial[dial == 2] <- "Both"
dial[dial == 3] <- "Dialect"
dial[dial == 4] <- "Others"
chidia[chidia == 1] <- "Mandarin"#孩子在家说的方言
chidia[chidia == 2] <- "Both"
chidia[chidia == 3] <- "Dialect"
chidia[chidia == 4] <- "Others"
eduyexp[eduyexp == 1] <- 9
eduyexp[eduyexp == 2] <- 9
eduyexp[eduyexp %in% c(3,4,5)] <- 12
eduyexp[eduyexp == 6] <- 15
eduyexp[eduyexp == 7] <- 16
eduyexp[eduyexp == 8] <- 19
eduyexp[eduyexp == 9] <- 22
futcfd <- factor(futcfd,ordered = T)
huko[huko == 1] <- 'Agriculture'
huko[huko == 2] <- 'Non'
huko[huko == 3] <- 'Others'
huko[huko == 4] <- 'Others'
eduy[eduy == 1] <- 0
eduy[eduy == 2] <- 6
eduy[eduy == 3] <- 9
eduy[eduy %in% c(4,5,6)] <- 12
eduy[eduy == 7] <- 15
eduy[eduy == 8] <- 16
eduy[eduy == 9] <- 19
dangy[dangy == 1] <- 'Party member'
dangy[dangy == 2] <- 'Others'
dangy[dangy == 3] <- 'Others'
houspro[houspro == 1] <- 'Yes'
houspro[houspro == 2] <- 'No'
lifetm[lifetm > 15] <- NA
clfee[clfee > 10000] <- NA
money[money > 250] <- NA
})
setwd("E:/edu/data2")
write.dta(`stu9`, "stu.dta")
write.dta(`school`, "school.dta")
write.dta(`class`, "class.dta")
write.dta(`parent`, "parent.dta")
setwd("E:/edu/data2")
ceps <- read_dta("E:/edu/data2/ceps.dta")
ceps <- lapply(ceps, unclass) #解决标签问题
ceps <- data.frame(ceps)
View(ceps)
cont <- rpart.control(minsplit=5,maxcompete=100,xval=10,maxdepth=30,cp=0.01)
cltree <- rpart(matgreat ~ schids + sex + onechi +  maedu +  faedu + drunk +
qurel + relation +  desk + net + dialect + chkhmwk + chkcouse +
classtm +  clpre + revitm + subject + know + drsmok + commhr +
schtype + schcsrm +  comno +  bknum + buget +  eduqua + fight +
brkpb + smok +  drink +  teainc + money + clfee + qianzi + lifetm +
dial +  chidia +  futcfd +  huko + eduy +  dangy +  houspro ,data =
subset(ceps,grade9 == 1),weights = sweight,method = "class",parms =
list(split="gini"),control=cont,na.action = na.omit)
cltree
printcp(cltree)
rpart.plot(cltree)
install.packages('blogdown')
blogdown::install_hugo()
install.packages('randomForest')
library(randomForest)
vignette(, package = "randomForest")
data(iris)
set.seed(71)
iris.rf <- randomForest(Species ~ ., data=iris, importance=TRUE,
proximity=TRUE)
print(iris.rf)
setwd("E:/edu/data2")
ceps <- read_dta("E:/edu/data2/ceps.dta")
setwd("E:/edu/data2")
ceps <- read_dta("E:/edu/data2/ceps.dta")
setwd("E:/edu/data2")
library(haven)
library(tidyverse)
ceps <- read_dta("E:/edu/data2/ceps.dta")
ceps <- lapply(ceps, unclass)
ceps <- data.frame(ceps)
ceps$schids <- as.factor(ceps$schids)
library(rpart)
library(rpart.plot)
library(lattice)
require(stats)
attach(ceps)
library(ggplot2)
library(pROC)
histogram(sdtotal,equal.widths = TRUE, nint = 70, xlab = "标准化总成绩",type = "density",ylab = '密度')
set.seed(1212323) #设置随机数种子
sampled <- sample(1:nrow(ceps),nrow(ceps)*0.3,replace=FALSE) #抽取30%样本作为验证集
test <- ceps[sampled,] #验证集
train <- ceps[-sampled,] #训练集
library(randomForest)
setwd("E:/edu/data2")
library(haven)
library(tidyverse)
ceps <- read_dta("E:/edu/data2/ceps.dta")
ceps <- lapply(ceps, unclass)
ceps <- data.frame(ceps)
ceps$schids <- as.factor(ceps$schids)
library(rpart)
library(rpart.plot)
library(lattice)
require(stats)
attach(ceps)
library(ggplot2)
library(pROC)
library(randomForest)
histogram(sdtotal,equal.widths = TRUE, nint = 70, xlab = "标准化总成绩",type = "density",ylab = '密度')
setwd("E:/edu/data2")
library(haven)
library(tidyverse)
library(rpart)
library(rpart.plot)
library(lattice)
require(stats)
attach(ceps)
library(ggplot2)
library(pROC)
library(randomForest)
ceps <- read_dta("E:/edu/data2/ceps.dta")
ceps <- lapply(ceps, unclass)
ceps <- data.frame(ceps)
ceps$schids <- as.factor(ceps$schids)
histogram(sdtotal,equal.widths = TRUE, nint = 70, xlab = "标准化总成绩",type = "density",ylab = '密度')
ratree <- randomForest(matgreat ~  schids + sex + onechi +  maedu +  faedu + drunk + qurel + relation + desk + net + dialect + chkhmwk + chkcouse + classtm +  clpre + revitm + subject + know + drsmok + commhr + schtype + schcsrm + comno + bknum + buget + eduqua + fight + brkpb + smok +  drink +  teainc + money + clfee + qianzi + lifetm +  dial +  chidia +  futcfd + huko + eduy + dangy +  houspro  ,data = subset(train,grade9 == 1),na.action=na.omit,, importance=T,proximity=T)
train$matgreat
matgreat
ratree <- randomForest(matgreat ~ schids + sex + onechi +  maedu +  faedu + drunk + qurel + relation + desk + net + dialect + chkhmwk + chkcouse + classtm +  clpre + revitm + subject + know + drsmok + commhr + schtype + schcsrm + comno + bknum + buget + eduqua + fight + brkpb + smok + drink + teainc + money + clfee + qianzi + lifetm +  dial +  chidia +  futcfd + huko + eduy + dangy +  houspro  ,data = subset(train,grade9 == 1),na.action=na.omit,importance=T,proximity=T)
set.seed(71)
iris.rf <- randomForest(Species ~ ., data=iris, importance=TRUE,
proximity=TRUE)
iris.rf
Species
iris$Species
train$matgreat <- as.factor(train$matgreat)
ratree <- randomForest(matgreat ~ schids + sex + onechi +  maedu +  faedu + drunk + qurel + relation + desk + net + dialect + chkhmwk + chkcouse + classtm +  clpre + revitm + subject + know + drsmok + commhr + schtype + schcsrm + comno + bknum + buget + eduqua + fight + brkpb + smok + drink + teainc + money + clfee + qianzi + lifetm +  dial +  chidia +  futcfd + huko + eduy + dangy +  houspro  ,data = subset(train,grade9 == 1),na.action=na.omit,importance=T,proximity=T)
train <- na.omit(train$matgreat)
train$matgreat
train
setwd("E:/edu/data2")
library(haven)
library(tidyverse)
library(rpart)
library(rpart.plot)
library(lattice)
require(stats)
attach(ceps)
library(ggplot2)
library(pROC)
library(randomForest)
ceps <- read_dta("E:/edu/data2/ceps.dta")
ceps <- lapply(ceps, unclass)
ceps <- data.frame(ceps)
ceps$schids <- as.factor(ceps$schids)
histogram(sdtotal,equal.widths = TRUE, nint = 70, xlab = "标准化总成绩",type = "density",ylab = '密度')
setwd("E:/edu/data2")
ceps <- read_dta("E:/edu/data2/ceps.dta")
ceps1 <- subset(ceps,schids<=30)
ceps1$schids <- as.factor(ceps1$schids)
ggplot(ceps1, aes(schids,tr_mat)) +
geom_boxplot() +
xlab('学校代码') + ylab('数学原始成绩')
ceps <- lapply(ceps, unclass)
ceps <- data.frame(ceps)
set.seed(1212323) #设置随机数种子
sampled <- sample(1:nrow(ceps),nrow(ceps)*0.3,replace=FALSE) #抽取30%样本作为验证集
test <- ceps[sampled,] #验证集
train <- ceps[-sampled,] #训练集
train$matgreat <- as.factor(train$matgreat)
train$matgreat <- na.omit(train$matgreat)
ratree <- randomForest(matgreat ~ schids + sex + onechi +  maedu +  faedu + drunk + qurel + relation + desk + net + dialect + chkhmwk + chkcouse + classtm +  clpre + revitm + subject + know + drsmok + commhr + schtype + schcsrm + comno + bknum + buget + eduqua + fight + brkpb + smok + drink + teainc + money + clfee + qianzi + lifetm +  dial +  chidia +  futcfd + huko + eduy + dangy +  houspro  ,data = subset(train,grade9 == 1),na.action=na.omit,importance=T,proximity=T)
View(train)
ratree <- randomForest(matgreat ~ schids + sex + onechi +  maedu +  faedu + drunk + qurel + relation + desk + net + dialect + chkhmwk + chkcouse + classtm +  clpre + revitm + subject + know + drsmok + commhr + schtype + schcsrm + comno + bknum + buget + eduqua + fight + brkpb + smok + drink + teainc + money + clfee + qianzi + lifetm +  dial +  chidia +  futcfd + huko + eduy + dangy +  houspro  ,data = subset(train,grade9 == 1),importance=T,proximity=T)
train$matgreat <- na.omit(train$matgreat)
train$matgreat
?na.omit
train <- filter(train, is.na(matgreat))
View(train)
set.seed(1212323) #设置随机数种子
sampled <- sample(1:nrow(ceps),nrow(ceps)*0.3,replace=FALSE) #抽取30%样本作为验证集
test <- ceps[sampled,] #验证集
train <- ceps[-sampled,] #训练集
train <- filter(train, is.na(matgreat)==F)
View(train)
train$matgreat
ratree <- randomForest(matgreat ~ schids + sex + onechi +  maedu +  faedu + drunk + qurel + relation + desk + net + dialect + chkhmwk + chkcouse + classtm +  clpre + revitm + subject + know + drsmok + commhr + schtype + schcsrm + comno + bknum + buget + eduqua + fight + brkpb + smok + drink + teainc + money + clfee + qianzi + lifetm +  dial +  chidia +  futcfd + huko + eduy + dangy +  houspro  ,data = subset(train,grade9 == 1),importance=T,proximity=T)
train$matgreat <- as.factor(train$matgreat)
train$matgreat <- na.omit(train$matgreat)
train <- filter(train, is.na(matgreat)==F)
ratree <- randomForest(matgreat ~ schids + sex + onechi +  maedu +  faedu + drunk + qurel + relation + desk + net + dialect + chkhmwk + chkcouse + classtm +  clpre + revitm + subject + know + drsmok + commhr + schtype + schcsrm + comno + bknum + buget + eduqua + fight + brkpb + smok + drink + teainc + money + clfee + qianzi + lifetm +  dial +  chidia +  futcfd + huko + eduy + dangy +  houspro  ,data = subset(train,grade9 == 1),importance=T,proximity=T)
na.omit(train)
train <- filter(train, is.na(matgreat)==F)
ratree <- randomForest(matgreat ~ schids + sex + onechi +  maedu +  faedu + drunk + qurel + relation + desk + net + dialect + chkhmwk + chkcouse + classtm +  clpre + revitm + subject + know + drsmok + commhr + schtype + schcsrm + comno + bknum + buget + eduqua + fight + brkpb + smok + drink + teainc + money + clfee + qianzi + lifetm +  dial +  chidia +  futcfd + huko + eduy + dangy +  houspro  ,data = subset(train,grade9 == 1),importance=T,proximity=T)
View(train)
train <- na.omit(train)
train <- filter(train, is.na(matgreat)==F)
ratree <- randomForest(matgreat ~ schids + sex + onechi +  maedu +  faedu + drunk + qurel + relation + desk + net + dialect + chkhmwk + chkcouse + classtm +  clpre + revitm + subject + know + drsmok + commhr + schtype + schcsrm + comno + bknum + buget + eduqua + fight + brkpb + smok + drink + teainc + money + clfee + qianzi + lifetm +  dial +  chidia +  futcfd + huko + eduy + dangy +  houspro  ,data = subset(train,grade9 == 1),importance=T,proximity=T)
ratree
na.action
?na.action
train$matgreat <- as.factor(train$matgreat)
train$matgreat <- na.omit(train$matgreat)
train <- na.omit(train)
train <- filter(train, is.na(matgreat)==F)
ratree <- randomForest(matgreat ~ schids + sex + onechi +  maedu +  faedu + drunk + qurel + relation + desk + net + dialect + chkhmwk + chkcouse + classtm +  clpre + revitm + subject + know + drsmok + commhr + schtype + schcsrm + comno + bknum + buget + eduqua + fight + brkpb + smok + drink + teainc + money + clfee + qianzi + lifetm +  dial +  chidia +  futcfd + huko + eduy + dangy +  houspro  ,data = subset(train,grade9 == 1),importance=T,proximity=T)
train$matgreat <- as.factor(train$matgreat)
train$matgreat <- na.omit(train$matgreat)
train <- na.omit(train)
train <- filter(train, is.na(matgreat)==F)
ratree <- randomForest(matgreat ~ schids + sex + onechi +  maedu +  faedu + drunk + qurel + relation + desk + net + dialect + chkhmwk + chkcouse + classtm +  clpre + revitm + subject + know + drsmok + commhr + schtype + schcsrm + comno + bknum + buget + eduqua + fight + brkpb + smok + drink + teainc + money + clfee + qianzi + lifetm +  dial +  chidia +  futcfd + huko + eduy + dangy +  houspro  ,data = subset(train,grade9 == 1),importance=T,proximity=T)
ratree
summary(ratree)
MDSplot(ratree)
MDSplot(ratree,matgreat)
MDSplot(ratree,matgreat,palette=NULL)
ratree <- randomForest(matgreat ~ schids + sex + onechi +  maedu +  faedu + drunk + qurel + relation + desk + net + dialect + chkhmwk + chkcouse + classtm +  clpre + revitm + subject + know + drsmok + commhr + schtype + schcsrm + comno + bknum + buget + eduqua + fight + brkpb + smok + drink + teainc + money + clfee + qianzi + lifetm +  dial +  chidia +  futcfd + huko + eduy + dangy +  houspro  ,data = subset(train,grade9 == 1),importance=T,proximity=T,mtry=16)
ratree
summary(ratree)
MDSplot(ratree,matgreat,palette=NULL)
?importance
importance(ratree, type=1, class="NULL", scale=T)
importance(ratree, type=1, scale=T)
?MDSplot
iris.rf <- randomForest(Species ~ ., iris, proximity=TRUE,
keep.forest=FALSE)
MDSplot(iris.rf, iris$Species)
## Using different symbols for the classes:
MDSplot(iris.rf, iris$Species, palette=rep(1, 3), pch=as.numeric(iris$Species))
iris.rf <- randomForest(Species ~ ., iris, proximity=TRUE,
+                         keep.forest=FALSE)
> MDSplot(iris.rf, iris$Species)
iris.rf <- randomForest(Species ~ ., iris, proximity=TRUE,
+                         keep.forest=FALSE)
MDSplot(iris.rf, iris$Species)
importance(ratree, type=2, scale=T)
library(knitr)
setwd('F:\\Mysite\\Mysite')
blogdown:::serve_site()
