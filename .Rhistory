ceps1 <- ceps1$schids
#ceps1
set.seed(133)#设置随机数种子
sample <- sample(1:nrow(ceps1),30,replace = F)#抽取600个样本
setwd("E:/edu/data2")
ceps <- read_dta("E:/edu/data2/ceps.dta")
#抽出30所学校
ceps1 <- ceps %>%
group_by(schids) %>%
summarize(mathmean = mean(tr_mat, na.rm = T))
#ceps1 <- ceps1$schids
#ceps1
set.seed(133)#设置随机数种子
sample <- sample(1:nrow(ceps1),30,replace = F)#抽取600个样本
ceps1 <- ceps1[sample,]#抽取30所学校
cc <- ceps$schids == ceps1
ceps1
setwd("E:/edu/data2")
ceps <- read_dta("E:/edu/data2/ceps.dta")
#抽出30所学校
ceps1 <- ceps %>%
group_by(schids) %>%
summarize(mathmean = mean(tr_mat, na.rm = T))
#ceps1 <- ceps1$schids
#ceps1
set.seed(133)#设置随机数种子
sample <- sample(1:nrow(ceps1),30,replace = F)#抽取600个样本
ceps1 <- ceps1[sample,]#抽取30所学校
cc <- ceps$schids == ceps1$schids
setwd("E:/edu/data2")
ceps <- read_dta("E:/edu/data2/ceps.dta")
#抽出30所学校
ceps1 <- ceps %>%
group_by(schids) %>%
summarize(mathmean = mean(tr_mat, na.rm = T))
#ceps1 <- ceps1$schids
#ceps1
set.seed(133)#设置随机数种子
sample <- sample(1:nrow(ceps1),30,replace = F)#抽取600个样本
ceps1 <- ceps1[sample,]#抽取30所学校
cc <- ceps$schids == ceps1$schids
cc
ceps1$schids
cc <- ceps$schids in ceps1$schids
setwd("E:/edu/data2")
ceps <- read_dta("E:/edu/data2/ceps.dta")
#抽出30所学校
ceps1 <- ceps %>%
group_by(schids) %>%
summarize(mathmean = mean(tr_mat, na.rm = T))
#ceps1 <- ceps1$schids
#ceps1
set.seed(133)#设置随机数种子
sample <- sample(1:nrow(ceps1),30,replace = F)#抽取600个样本
ceps1 <- ceps1[sample,]#抽取30所学校
ceps <- within(ceps, {
chou[ceps$schids == ceps1$schids] <- TRUE
chou[ceps$schids != ceps1$schids] <- FALSE
})
setwd("E:/edu/data2")
ceps <- read_dta("E:/edu/data2/ceps.dta")
#抽出30所学校
ceps1 <- ceps %>%
group_by(schids) %>%
summarize(mathmean = mean(tr_mat, na.rm = T))
#ceps1 <- ceps1$schids
#ceps1
set.seed(133)#设置随机数种子
sample <- sample(1:nrow(ceps1),30,replace = F)#抽取600个样本
ceps1 <- ceps1[sample,]#抽取30所学校
ceps <- within(ceps, {
chou <- 0
chou[ceps$schids == ceps1$schids] <- TRUE
chou[ceps$schids != ceps1$schids] <- FALSE
})
ceps$chou
setwd("E:/edu/data2")
ceps <- read_dta("E:/edu/data2/ceps.dta")
#抽出30所学校
#ceps1 <- ceps %>%
#group_by(schids) %>%
#summarize(mathmean = mean(tr_mat, na.rm = T))
#ceps1 <- ceps1$schids
#ceps1$schids <- as.factor(ceps1$schids)
ggplot(ceps1, aes(schids,tr_mat,group=schids)) +
geom_boxplot() +
xlab('学校代码') + ylab('数学原始成绩')
setwd("E:/edu/data2")
ceps <- read_dta("E:/edu/data2/ceps.dta")
#抽出30所学校
#ceps1 <- ceps %>%
#group_by(schids) %>%
#summarize(mathmean = mean(tr_mat, na.rm = T))
#ceps1 <- ceps1$schids
#ceps1$schids <- as.factor(ceps1$schids)
ggplot(ceps, aes(schids,tr_mat,group=schids)) +
geom_boxplot() +
xlab('学校代码') + ylab('数学原始成绩')
setwd("E:/edu/data2")
ceps <- read_dta("E:/edu/data2/ceps.dta")
#抽出30所学校
#ceps1 <- ceps %>%
#group_by(schids) %>%
#summarize(mathmean = mean(tr_mat, na.rm = T))
#ceps1 <- ceps1$schids
#ceps1$schids <- as.factor(ceps1$schids)
ggplot(ceps, aes(sample(schids,30),tr_mat,group=schids)) +
geom_boxplot() +
xlab('学校代码') + ylab('数学原始成绩')
setwd("E:/edu/data2")
ceps <- read_dta("E:/edu/data2/ceps.dta")
#抽出30所学校
#ceps1 <- ceps %>%
#group_by(schids) %>%
#summarize(mathmean = mean(tr_mat, na.rm = T))
#ceps1 <- ceps1$schids
#ceps1$schids <- as.factor(ceps1$schids)
ggplot(ceps, aes(schids,tr_mat,group=schids)) +
geom_boxplot() +
xlab('学校代码') + ylab('数学原始成绩')
ceps <- lapply(ceps, unclass)
ceps <- data.frame(ceps)
ceps
setwd("E:/edu/data2")
ceps <- read_dta("E:/edu/data2/ceps.dta")
#抽出30所学校
#ceps1 <- ceps %>%
#group_by(schids) %>%
#summarize(mathmean = mean(tr_mat, na.rm = T))
#ceps1 <- ceps1$schids
#ceps1$schids <- as.factor(ceps1$schids)
ggplot(ceps, aes(schids,tr_mat,group=schids)) +
geom_boxplot(size=1) +
xlab('学校代码') + ylab('数学原始成绩')
ceps <- lapply(ceps, unclass)
ceps <- data.frame(ceps)
ceps
setwd("E:/edu/data2")
ceps <- read_dta("E:/edu/data2/ceps.dta")
#抽出30所学校
#ceps1 <- ceps %>%
#group_by(schids) %>%
#summarize(mathmean = mean(tr_mat, na.rm = T))
#ceps1 <- ceps1$schids
#ceps1$schids <- as.factor(ceps1$schids)
ggplot(ceps, aes(schids,tr_mat,group=schids)) +
geom_boxplot(size=0.1) +
xlab('学校代码') + ylab('数学原始成绩')
ceps <- lapply(ceps, unclass)
ceps <- data.frame(ceps)
ceps
setwd("E:/edu/data2")
ceps <- read_dta("E:/edu/data2/ceps.dta")
#抽出30所学校
ceps1 <- ceps %>%
group_by(schids) %>%
summarize(mathmean = mean(tr_mat, na.rm = T))
sample <- sample(1:nrow(ceps1),30,replace = F)#抽取600个样本
sample
ceps$schids[sample,]
cepsw <-  ceps$schids[sample,]
setwd("E:/edu/data2")
ceps <- read_dta("E:/edu/data2/ceps.dta")
#抽出30所学校
ceps1 <- ceps %>%
group_by(schids) %>%
summarize(mathmean = mean(tr_mat, na.rm = T))
sample <- sample(1:nrow(ceps1),30,replace = F)#抽取600个样本
cepsw <-  ceps$schids[sample,]
setwd("E:/edu/data2")
ceps <- read_dta("E:/edu/data2/ceps.dta")
#抽出30所学校
ceps1 <- ceps %>%
group_by(schids) %>%
summarize(mathmean = mean(tr_mat, na.rm = T))
sample <- sample(1:nrow(ceps1),30,replace = F)#抽取600个样本
cepsw <-  ceps[sample,]
#ceps1 <- ceps1$schids
#ceps1$schids <- as.factor(ceps1$schids)
ggplot(ceps, aes(schids,tr_mat,group=schids)) +
geom_boxplot(size=0.1) +
xlab('学校代码') + ylab('数学原始成绩')
ceps1 <- subset(ceps,schids<=30)
ceps <- lapply(ceps, unclass)
ceps <- data.frame(ceps)
ceps
cepsw
setwd("E:/edu/data2")
ceps <- read_dta("E:/edu/data2/ceps.dta")
#抽出30所学校
ceps1 <- ceps %>%
group_by(schids) %>%
summarize(mathmean = mean(tr_mat, na.rm = T))
ceps1 %>%
ungroup()
ceps1
setwd("E:/edu/data2")
ceps <- read_dta("E:/edu/data2/ceps.dta")
#抽出30所学校
ceps1 <- ceps %>%
group_by(schids) %>%
summarize(mathmean = mean(tr_mat, na.rm = T))
ceps1 <- ceps1 %>%
ungroup()
ceps1
setwd("E:/edu/data2")
ceps <- read_dta("E:/edu/data2/ceps.dta")
#抽出30所学校
ceps1 <- ceps %>%
group_by(schids) %>%
summarize(mathmean = mean(tr_mat, na.rm = T))
ceps1 <- ceps1 %>%
ungroup() %>%
summarize(n())
ceps1
??BostonHousing
mlbench::BostonHousing
?mlbench
library(mlbench)
??mlbench
??mlbench
library(mlbench)
setwd("E:/edu/data2")
library(haven)
library(tidyverse)
library(rpart)
library(rpart.plot)
library(lattice)
require(stats)
library(ggplot2)
library(pROC)
library(randomForest)
ceps <- read_dta("E:/edu/data2/ceps.dta")
ceps <- lapply(ceps, unclass)
ceps <- data.frame(ceps)
ceps$schids <- as.factor(ceps$schids)
attach(ceps)
histogram(sdtotal,equal.widths = TRUE, nint = 70, xlab = "标准化总成绩",type = "density",ylab = '密度')
cont <- rpart.control(minsplit=5,maxcompete=100,xval=10,maxdepth=30,cp=0.01)
tree <- rpart(sdtotal ~ schids + sex + onechi +  maedu +  faedu + drunk +
qurel + relation +  desk + net + dialect + chkhmwk + chkcouse +
classtm +  clpre + revitm + subject + know + drsmok + commhr +
schtype + schcsrm +  comno +  bknum + buget +  eduqua + fight +
brkpb + smok +  drink +  teainc + money + clfee + qianzi + lifetm +
dial +  chidia +  futcfd +  huko + eduy +  dangy +  houspro ,data =
subset(ceps,grade9 == 1),weights = sweight,method = "anova",parms =
list(split="gini"),control=cont,na.action = na.omit)
library(caret)
repeatedcv <-trainControl(method ="repeatedcv", number =10,repeats =10, savePredictions=TRUE)
rpartFit <- train(matgreat ~ schids + sex + onechi +  maedu +  faedu + drunk + qurel + relation + desk + net + dialect + chkhmwk + chkcouse + classtm +  clpre + revitm + subject + know + drsmok + commhr + schtype + schcsrm + comno + bknum + buget + eduqua + fight + brkpb + smok + drink + teainc + money + clfee + qianzi + lifetm +  dial +  chidia +  futcfd + huko + eduy + dangy +  houspro  ,
data = subset(train,grade9 == 1),
method = "rpart",
trControl = repeatedcv)
library(caret)
repeatedcv <-trainControl(method ="repeatedcv", number =10,repeats =10, savePredictions=TRUE)
rpartFit <- train(matgreat ~ schids + sex + onechi +  maedu +  faedu + drunk + qurel + relation + desk + net + dialect + chkhmwk + chkcouse + classtm +  clpre + revitm + subject + know + drsmok + commhr + schtype + schcsrm + comno + bknum + buget + eduqua + fight + brkpb + smok + drink + teainc + money + clfee + qianzi + lifetm +  dial +  chidia +  futcfd + huko + eduy + dangy +  houspro  ,
data = ceps,
method = "rpart",
trControl = repeatedcv)
?train
library(caret)
repeatedcv <-trainControl(method ="repeatedcv", number =10,repeats =10, savePredictions=TRUE)
rpartFit <- train(matgreat ~ schids + sex + onechi +  maedu +  faedu + drunk + qurel + relation + desk + net + dialect + chkhmwk + chkcouse + classtm +  clpre + revitm + subject + know + drsmok + commhr + schtype + schcsrm + comno + bknum + buget + eduqua + fight + brkpb + smok + drink + teainc + money + clfee + qianzi + lifetm +  dial +  chidia +  futcfd + huko + eduy + dangy +  houspro  ,
data = ceps,
method = "rpart",
trControl = repeatedcv,
na.action = na.omit)
rpartFit
ceps$matgreat
library(caret)
ceps$matgreat <- as.factor(ceps$matgreat)
repeatedcv <-trainControl(method ="repeatedcv", number =10,repeats =10, savePredictions=TRUE)
rpartFit <- train(matgreat ~ schids + sex + onechi +  maedu +  faedu + drunk + qurel + relation + desk + net + dialect + chkhmwk + chkcouse + classtm +  clpre + revitm + subject + know + drsmok + commhr + schtype + schcsrm + comno + bknum + buget + eduqua + fight + brkpb + smok + drink + teainc + money + clfee + qianzi + lifetm +  dial +  chidia +  futcfd + huko + eduy + dangy +  houspro  ,
data = ceps,
method = "rpart",
trControl = repeatedcv,
na.action = na.omit)
library(caret)
require(e1071)
ceps$matgreat <- as.factor(ceps$matgreat)
repeatedcv <-trainControl(method ="repeatedcv", number =10,repeats =10, savePredictions=TRUE)
rpartFit <- train(matgreat ~ schids + sex + onechi +  maedu +  faedu + drunk + qurel + relation + desk + net + dialect + chkhmwk + chkcouse + classtm +  clpre + revitm + subject + know + drsmok + commhr + schtype + schcsrm + comno + bknum + buget + eduqua + fight + brkpb + smok + drink + teainc + money + clfee + qianzi + lifetm +  dial +  chidia +  futcfd + huko + eduy + dangy +  houspro  ,
data = ceps,
method = "rpart",
trControl = repeatedcv,
na.action = na.omit)
library(caret)
library(e1071)
library(caret)
install.packages('e1071')
library(e1071)
ceps$matgreat <- as.factor(ceps$matgreat)
repeatedcv <-trainControl(method ="repeatedcv", number =10,repeats =10, savePredictions=TRUE)
rpartFit <- train(matgreat ~ schids + sex + onechi +  maedu +  faedu + drunk + qurel + relation + desk + net + dialect + chkhmwk + chkcouse + classtm +  clpre + revitm + subject + know + drsmok + commhr + schtype + schcsrm + comno + bknum + buget + eduqua + fight + brkpb + smok + drink + teainc + money + clfee + qianzi + lifetm +  dial +  chidia +  futcfd + huko + eduy + dangy +  houspro  ,
data = ceps,
method = "rpart",
trControl = repeatedcv,
na.action = na.omit)
rpartFit
install.packages('sampling')
?sampling
library(sampling)
?sampling
??sampling
?rep
rep(1:4, 2)
rep(1:4, each = 2)
setwd("E:/edu/data2")
ceps <- read_dta("E:/edu/data2/ceps.dta")
#抽出30所学校
ceps1 <- ceps %>%
group_by(schids) %>%
summarize(mathmean = mean(tr_mat, na.rm = T))
sample <- sample(1:nrow(ceps1),30,replace = F)#抽取30个样本
ceps1 <- ceps1[sample,]
ceps1
setwd("E:/edu/data2")
ceps <- read_dta("E:/edu/data2/ceps.dta")
#抽出30所学校
ceps1 <- ceps %>%
group_by(schids) %>%
summarize(mathmean = mean(tr_mat, na.rm = T))
set.seed(2019)
sample <- sample(1:nrow(ceps1),30,replace = F)#抽取30个样本
ceps1 <- ceps1[sample,]
ceps1 <- ceps1$schids
ceps1
for (i in ceps1) print(i)
ceps1
for (i in ceps1) print(i)
ceps1[1,]
ceps1[1,1]
ceps1[1,]
setwd("E:/edu/data2")
ceps <- read_dta("E:/edu/data2/ceps.dta")
#抽出30所学校
ceps1 <- ceps %>%
group_by(schids) %>%
summarize(mathmean = mean(tr_mat, na.rm = T))
set.seed(2019)
sample <- sample(1:nrow(ceps1),30,replace = F)#抽取30个样本
ceps1 <- ceps1[sample,]
ceps1 <- ceps1$schids
ceps1
ceps1[1]
ceps1[1]
delte <- subset(ceps$schids == ceps1[1])
delte <- subset(ceps,schids == ceps1[1])
for (i in ceps1) rbind(delte, subset(ceps$schids == i))
for (i in ceps1) rbind(delte, subset(ceps,schids == i))
delte
setwd("E:/edu/data2")
ceps <- read_dta("E:/edu/data2/ceps.dta")
#抽出30所学校
ceps1 <- ceps %>%
group_by(schids) %>%
summarize(mathmean = mean(tr_mat, na.rm = T))
set.seed(2019)
sample <- sample(1:nrow(ceps1),30,replace = F)#抽取30个样本
ceps1 <- ceps1[sample,]
ceps1 <- ceps1$schids
ceps1
#ceps1$schids <- as.factor(ceps1$schids)
#ceps1[1]
delte <- subset(ceps,schids == ceps1[1])
delte
setwd("E:/edu/data2")
ceps <- read_dta("E:/edu/data2/ceps.dta")
#抽出30所学校
ceps1 <- ceps %>%
group_by(schids) %>%
summarize(mathmean = mean(tr_mat, na.rm = T))
set.seed(2019)
sample <- sample(1:nrow(ceps1),30,replace = F)#抽取30个样本
ceps1 <- ceps1[sample,]
ceps1 <- ceps1$schids
ceps1
#ceps1$schids <- as.factor(ceps1$schids)
#ceps1[1]
delte <- subset(ceps,schids == ceps1[1])
ceps1
rbind(delte, subset(ceps,schids == ceps1[2])
rbind(delte, subset(ceps,schids == ceps1[2]))
delte <- rbind(delte, subset(ceps,schids == ceps1[2]))
setwd("E:/edu/data2")
ceps <- read_dta("E:/edu/data2/ceps.dta")
#抽出30所学校
ceps1 <- ceps %>%
group_by(schids) %>%
summarize(mathmean = mean(tr_mat, na.rm = T))
set.seed(2019)
sample <- sample(1:nrow(ceps1),30,replace = F)#抽取30个样本
ceps1 <- ceps1[sample,]
ceps1 <- ceps1$schids
ceps1
#ceps1$schids <- as.factor(ceps1$schids)
#ceps1[1]
delte <- subset(ceps,schids == ceps1[1])
delte <- rbind(delte, subset(ceps,schids == ceps1[2]))
delte
setwd("E:/edu/data2")
ceps <- read_dta("E:/edu/data2/ceps.dta")
#抽出30所学校
ceps1 <- ceps %>%
group_by(schids) %>%
summarize(mathmean = mean(tr_mat, na.rm = T))
set.seed(2019)
sample <- sample(1:nrow(ceps1),30,replace = F)#抽取30个样本
ceps1 <- ceps1[sample,]
ceps1 <- ceps1$schids
ceps1
#ceps1$schids <- as.factor(ceps1$schids)
#ceps1[1]
delte <- subset(ceps,schids == ceps1[1])
rbind(delte, subset(ceps,schids == ceps1[2]))
delte
setwd("E:/edu/data2")
ceps <- read_dta("E:/edu/data2/ceps.dta")
#抽出30所学校
ceps1 <- ceps %>%
group_by(schids) %>%
summarize(mathmean = mean(tr_mat, na.rm = T))
set.seed(2019)
sample <- sample(1:nrow(ceps1),30,replace = F)#抽取30个样本
ceps1 <- ceps1[sample,]
ceps1 <- ceps1$schids
ceps1
#ceps1$schids <- as.factor(ceps1$schids)
#ceps1[1]
delte <- subset(ceps,schids == ceps1[1])
#delte
for (i in ceps1) delte <- rbind(delte, subset(ceps,schids == i))
delte
setwd("E:/edu/data2")
ceps <- read_dta("E:/edu/data2/ceps.dta")
#抽出30所学校
ceps1 <- ceps %>%
group_by(schids) %>%
summarize(mathmean = mean(tr_mat, na.rm = T))
set.seed(2019)
sample <- sample(1:nrow(ceps1),30,replace = F)#抽取30个样本
ceps1 <- ceps1[sample,]
ceps1 <- ceps1$schids
ceps1
#ceps1$schids <- as.factor(ceps1$schids)
#ceps1[1]
delte <- subset(ceps,schids == ceps1[1])
#delte
for (i in ceps1) delte <- rbind(delte, subset(ceps,schids == i))
delte$schids
setwd("E:/edu/data2")
ceps <- read_dta("E:/edu/data2/ceps.dta")
#抽出30所学校
ceps1 <- ceps %>%
group_by(schids) %>%
summarize(mathmean = mean(tr_mat, na.rm = T))
set.seed(2019)
sample <- sample(1:nrow(ceps1),30,replace = F)#抽取30个样本
ceps1 <- ceps1[sample,]
ceps1 <- ceps1$schids
ceps1
#ceps1$schids <- as.factor(ceps1$schids)
#ceps1[1]
delte <- subset(ceps,schids == ceps1[1])
#delte
for (i in ceps1) delte <- rbind(delte, subset(ceps,schids == i))
delte$schids
ggplot(delte, aes(schids,tr_mat)) +
geom_boxplot(size=0.1) +
xlab('学校代码') + ylab('数学原始成绩')
setwd("E:/edu/data2")
ceps <- read_dta("E:/edu/data2/ceps.dta")
#抽出30所学校
ceps1 <- ceps %>%
group_by(schids) %>%
summarize(mathmean = mean(tr_mat, na.rm = T))
set.seed(2019)
sample <- sample(1:nrow(ceps1),30,replace = F)#抽取30个样本
ceps1 <- ceps1[sample,]
ceps1 <- ceps1$schids
ceps1
#ceps1$schids <- as.factor(ceps1$schids)
#ceps1[1]
delte <- subset(ceps,schids == ceps1[1])
#delte
for (i in ceps1) delte <- rbind(delte, subset(ceps,schids == i))
delte$schids
ceps1$schids <- as.factor(ceps1$schids)
setwd("E:/edu/data2")
ceps <- read_dta("E:/edu/data2/ceps.dta")
#抽出30所学校
ceps1 <- ceps %>%
group_by(schids) %>%
summarize(mathmean = mean(tr_mat, na.rm = T))
set.seed(2019)
sample <- sample(1:nrow(ceps1),30,replace = F)#抽取30个样本
ceps1 <- ceps1[sample,]
ceps1 <- ceps1$schids
ceps1
#ceps1$schids <- as.factor(ceps1$schids)
#ceps1[1]
delte <- subset(ceps,schids == ceps1[1])
#delte
for (i in ceps1) delte <- rbind(delte, subset(ceps,schids == i))
delte$schids
delte$schids <- as.factor(delte$schids)
ggplot(delte, aes(schids,tr_mat)) +
geom_boxplot(size=0.1) +
xlab('学校代码') + ylab('数学原始成绩')
ceps1
setwd('F:\\Mysite\\Mysite')
blogdown:::serve_site()
