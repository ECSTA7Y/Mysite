library(magrittr)
raptors_players <- read_csv("E:/MaLearning/nba/raptors_players.csv")
raptors_players <- raptors_players %>%
arrange(DATE) %>%
na_if('-')
#长数据转宽数据
players <- raptors_players %>%
dcast(DATE~PLAYER,value.var=PTS)
library(readr)
library(dplyr)
library(tidyr)
library(reshape2)
library(magrittr)
raptors_players <- read_csv("E:/MaLearning/nba/raptors_players.csv")
raptors_players <- raptors_players %>%
arrange(DATE) %>%
na_if('-')
#长数据转宽数据
players <- raptors_players %>%
dcast(DATE~PLAYER,margins	=PTS)
library(readr)
library(dplyr)
library(tidyr)
library(reshape2)
library(magrittr)
raptors_players <- read_csv("E:/MaLearning/nba/raptors_players.csv")
raptors_players <- raptors_players %>%
arrange(DATE) %>%
na_if('-')
#长数据转宽数据
players <- raptors_players %>%
dcast(DATE~PLAYER,margins	=T)
library(readr)
library(dplyr)
library(tidyr)
library(reshape2)
library(magrittr)
raptors_players <- read_csv("E:/MaLearning/nba/raptors_players.csv")
raptors_players <- raptors_players %>%
arrange(DATE) %>%
na_if('-')
#长数据转宽数据
players <- raptors_players %>%
dcast(DATE~PLAYER,value.var=guess_value(raptors_players))
library(readr)
library(dplyr)
library(tidyr)
library(reshape2)
library(magrittr)
raptors_players <- read_csv("E:/MaLearning/nba/raptors_players.csv")
raptors_players <- raptors_players %>%
arrange(DATE) %>%
na_if('-')
#长数据转宽数据
players <- raptors_players %>%
dcast(DATE~PLAYER,value.var=guess_value(raptors_players)
library(readr)
library(dplyr)
library(tidyr)
library(reshape2)
library(magrittr)
raptors_players <- read_csv("E:/MaLearning/nba/raptors_players.csv")
raptors_players <- raptors_players %>%
arrange(DATE) %>%
na_if('-')
#长数据转宽数据
players <- raptors_players %>%
dcast(DATE~PLAYER,value.var=guess_value(raptors_players))
library(readr)
library(dplyr)
library(tidyr)
library(reshape2)
library(magrittr)
raptors_players <- read_csv("E:/MaLearning/nba/raptors_players.csv")
raptors_players <- raptors_players %>%
arrange(DATE) %>%
na_if('-')
#长数据转宽数据
players <- raptors_players %>%
dcast(DATE~PLAYER,value.var=MIN)
raptorsreg <- read_csv("E:/MaLearning/nba/raptors_regulars.csv")
library(readr)
library(dplyr)
library(tidyr)
library(reshape2)
library(magrittr)
raptors_players <- read_csv("E:/MaLearning/nba/raptors_players.csv")
raptors_players <- raptors_players %>%
arrange(DATE) %>%
na_if('-')
#long to wide
players <- raptors_players %>%
dcast(DATE~PLAYER)
library(readr)
library(party)
raptorsplayoffs <- read_csv("E:/MaLearning/nba/raptorsplayoffs.csv")
playoffs <- raptorsplayoffs %>%
arrange(DATE) %>%
na_if('-') %>%
rename('TPP'='3P%','FTP'='FT%','FGP'='FG%','win'='W/L') %>%
mutate_if(sapply(.,is.character),as.factor)
tree <- ctree(win~MIN+PTS+FGM+FGA+FTM+FTA+OREB+DREB+REB+AST+STL+BLK+TOV+PF+FTP+TPP+FGP,playoffs,controls = ctree_control(mincriterion = 0.01,minsplit=3))
plot(tree)
library(rpart)
library(rpart.plot)
treept <- rpart(win~MIN+PTS+FGM+FGA+FTM+FTA+OREB+DREB+REB+AST+STL+BLK+TOV+PF+FTP+TPP+FGP,playoffs,control = rpart.control(cp=0.001,minsplit=3))
rpart.plot(treept)
View(playoffs)
raptorsreg <- read_csv("E:/MaLearning/nba/raptors_regulars.csv")
regular<- raptorsreg %>%
arrange(DATE) %>%
na_if('-') %>%
rename('TPP'='3P%','FTP'='FT%','FGP'='FG%','win'='W/L') %>%
mutate_if(sapply(.,is.character),as.factor)
tree <- ctree(win~MIN+PTS+FGM+FGA+FTM+FTA+OREB+DREB+REB+AST+STL+BLK+TOV+PF+FTP+TPP+FGP,regular,controls = ctree_control(mincriterion = 0.01,minsplit=3))
plot(tree)
library(rpart)
library(rpart.plot)
treept <- rpart(win~MIN+PTS+FGM+FGA+FTM+FTA+OREB+DREB+REB+AST+STL+BLK+TOV+PF+FTP+TPP+FGP,regular,control = rpart.control(cp=0.001,minsplit=3))
rpart.plot(treept)
View(regular)
?party
library(party)
?party
?ctree
?rpart
library(rpart)
?rpart
stagec
library(survival)
library(haven)
library(ggplot2)
library(dplyr)
library(ggfortify)
library(stargazer)
library(rpart)
library(rpart.plot)
fit < - rpart(Surv(pgtime , pgstat)~age +
eet + g2 + grade + gleason + ploidy ,data =
stagec, method ='exp')
fit <- rpart(Surv(pgtime , pgstat)~age +
eet + g2 + grade + gleason + ploidy ,data =
stagec, method ='exp')
fit <- rpart(Surv(pgtime , pgstat)~age +
eet + g2 + grade + gleason + ploidy ,stagec, method ='exp')
fit <- rpart(Surv(pgtime , pgstat)~age +
eet + g2 + grade + gleason + ploidy,stagec,method='exp')
rpart.plot(fit)
fit <- rpart(Surv(pgtime , pgstat)~age +
eet + g2 + grade + gleason + ploidy,stagec,method='exp')
rpart.plot(fit)
print(pfit)
fit <- rpart(Surv(pgtime , pgstat)~age +
eet + g2 + grade + gleason + ploidy,stagec,method='exp')
rpart.plot(fit)
print(fit)
print(fit)
fit2 <- prune(fit, cp = 0.016)
rpart.plot(fit2)
temp <- snip.rpart(pfit2, 6)
temp <- snip.rpart(fit2, 6)
km <- survfit(Surv(pgtime, pgstat) ~ temp$where, stagec)
autoplot(km)
?autoplot()
library(rpart)
library(rpart.plot)
treept <- rpart(win~PTS+FGM+FGA+FTM+FTA+OREB+DREB+REB+AST+STL+BLK+TOV+PF+FTP+TPP+FGP,regular,control = rpart.control(cp=0.004,minsplit=3))
?rpart.plot
old.par <- par(mfrow=c(2,2))            # put 4 figures on one page
data(ptitanic)
#---------------------------------------------------------------------------
binary.model <- rpart(survived ~ ., data = ptitanic, cp = .02)
# cp = .02 for small demo tree
rpart.plot(binary.model,
main = "titanic survived\n(binary response)")
rpart.plot(binary.model, type = 3, clip.right.labs = FALSE,
branch = .4,
box.palette = "Grays",       # override default GnBu palette
main = "type = 3, clip.right.labs = FALSE, ...\n")
anova.model <- rpart(Mileage ~ ., data = cu.summary)
rpart.plot(anova.model,
shadow.col = "gray",         # add shadows just for kicks
main = "miles per gallon\n(continuous response)\n")
multi.class.model <- rpart(Reliability ~ ., data = cu.summary)
rpart.plot(multi.class.model,
main = "vehicle reliability\n(multi class response)")
par(old.par)
print(fit)
fit2 <- prune(fit, cp = 0.016)
rpart.plot(fit2,shadow.col = 'gray')
print(fit)
fit2 <- prune(fit, cp = 0.016)
rpart.plot(fit2,shadow.col = 'gray')
library(survival)
library(haven)
library(ggplot2)
library(dplyr)
library(ggfortify)
library(stargazer)
library(rpart)
library(rpart.plot)
fit <- rpart(Surv(pgtime , pgstat)~age +
eet + g2 + grade + gleason + ploidy,stagec,method='exp')
fit
rpart.plot(fit,shadow.col = 'gray',branch = 0.4)
aaregfit <-aareg(km ~ ec + age + female +black + minc, data = cwg)
fit2 <- prune(fit, cp = 0.016)
fit2$cptable
rpart.plot(fit2,shadow.col = 'gray',branch = 0.4)
temp <- snip.rpart(fit2, 6)
km <- survfit(Surv(pgtime, pgstat) ~ temp$where, stagec)
autoplot(km)
temp$where
fit2
stagec
fit2
autoplot(km)
#temp <- snip.rpart(fit2, 6)
fit2
km <- survfit(Surv(pgtime, pgstat) ~ fit2$where, stagec)
autoplot(km)
temp$where
fit2 <- prune(fit, cp = 0.017)
fit2$cptable
rpart.plot(fit2,shadow.col = 'gray',branch = 0.4)
#temp <- snip.rpart(fit2, 6)
fit2
km <- survfit(Surv(pgtime, pgstat) ~ fit2$where, stagec)
autoplot(km)
temp$where
?snip.rpart
fit2 <- prune(fit, cp = 0.017)
fit2$cptable
rpart.plot(fit2,shadow.col = 'gray',branch = 0.4)
temp <- snip.rpart(fit2,5)
fit2
km <- survfit(Surv(pgtime, pgstat) ~ fit2$where, stagec)
autoplot(km)
temp$where
temp <- snip.rpart(fit2,5)
fit2
km <- survfit(Surv(pgtime, pgstat) ~ temp$where, stagec)
autoplot(km)
temp$where
temp <- snip.rpart(fit2,7)
fit2
km <- survfit(Surv(pgtime, pgstat) ~ temp$where, stagec)
autoplot(km)
temp$where
temp <- snip.rpart(fit2,6)
fit2
km <- survfit(Surv(pgtime, pgstat) ~ temp$where, stagec)
autoplot(km)
temp$where
temp <- snip.rpart(fit2,9)
fit2
km <- survfit(Surv(pgtime, pgstat) ~ temp$where, stagec)
autoplot(km)
temp$where
temp <- snip.rpart(fit2,6)
fit2
km <- survfit(Surv(pgtime, pgstat) ~ temp$where, stagec)
autoplot(km)
temp$where
ggplot(stagec)+
geom_point(aes(age,g2,
shape=pgstat,col=pgstat))
ggplot(stagec)+
geom_point(aes(age,g2,
shape=factor(pgstat),col=factor(pgstat))
ggplot(stagec)+
ggplot(stagec)+
geom_point(aes(age,g2,shape=factor(pgstat),
col=factor(pgstat)))
ggplot(stagec)+
geom_point(aes(age,g2,shape=factor(pgstat),
col=factor(pgstat)))+
facet_wrap(~grade)
knitr::opts_chunk$set(comment=NA,error=T,message = F,warning = F,fig.align='center',out.width ='100%')
library(readr)
library(dplyr)
library(tidyr)
library(reshape2)
library(magrittr)
library(party)
library(rpart)
library(rpart.plot)
library(ggplot2)
raptorsplayoffs <- read_csv("E:/MaLearning/nba/raptorsplayoffs.csv")
raptorsreg <- read_csv("E:/MaLearning/nba/raptors_regulars.csv")
regular<- raptorsreg %>%
arrange(DATE) %>%
na_if('-') %>%
rename('TPP'='3P%','FTP'='FT%',
'FGP'='FG%','win'='W/L') %>%
mutate_if(sapply(.,is.character),as.factor)
tree <- ctree(formula,regular,
controls = ctree_control(mincriterion = 0.01,minsplit=3))
playoffs <- raptorsplayoffs %>%
arrange(DATE) %>%
na_if('-') %>%
rename('TPP'='3P%','FTP'='FT%',
'FGP'='FG%','win'='W/L') %>%
mutate_if(sapply(.,is.character),as.factor)
formula <- win~PTS+FGM+FGA+FTM+FTA+OREB+DREB+REB+AST+STL+BLK+TOV+PF+FTP+TPP+FGP
tree <- ctree(formula,playoffs,
controls = ctree_control(mincriterion = 0.01,minsplit=3))
plot(tree)
treept <- rpart(formula,playoffs,
control = rpart.control(cp=0.001,minsplit=3))
rpart.plot(treept, branch = 0.4)
regular<- raptorsreg %>%
arrange(DATE) %>%
na_if('-') %>%
rename('TPP'='3P%','FTP'='FT%',
'FGP'='FG%','win'='W/L') %>%
mutate_if(sapply(.,is.character),as.factor)
tree <- ctree(formula,regular,
controls = ctree_control(mincriterion = 0.01,minsplit=3))
#plot(tree)
plot(tree,type = "simple")
treept <- rpart(formula,regular,
control = rpart.control(cp=0.05,minsplit=3))
rpart.plot(treept, branch = 0.4)
ggplot(regular)+
geom_point(aes(PTS,FGA,
shape=win,col=win)) +
geom_segment(aes(111,81,
xend = 111,yend = 110),
col='red') +
geom_segment(aes(111,81,
xend = 141,yend = 81),
col='red')+
annotate('text', x =70, y = 100, label='Win', size =4) +
labs(x='Points',y='Field Goals Attempted')
ggplot(regular)+
geom_point(aes(PTS,FGA,
shape=win,col=win)) +
geom_segment(aes(111,81,
xend = 111,yend = 110),
col='red') +
geom_segment(aes(111,81,
xend = 141,yend = 81),
col='red')+
annotate('text', x =139,y=95, label='Win', size=15,color='blue') +
labs(x='Points',y='Field Goals Attempted')
ggplot(regular)+
geom_point(aes(PTS,FGA,
shape=win,col=win)) +
geom_segment(aes(111,81,
xend = 111,yend = 110),
col='red') +
geom_segment(aes(111,81,
xend = 141,yend = 81),
col='red')+
annotate('text', x =120,y=95, label='Win', size=15,color='blue') +
labs(x='Points',y='Field Goals Attempted')
ggplot(regular)+
geom_point(aes(PTS,FGA,
shape=win,col=win)) +
geom_segment(aes(111,81,
xend = 111,yend = 110),
col='red') +
geom_segment(aes(111,81,
xend = 141,yend = 81),
col='red')+
annotate('text', x =130,y=95, label='Win', size=15,color='blue') +
labs(x='Points',y='Field Goals Attempted')
ggplot(regular)+
geom_point(aes(PTS,FGA,
shape=win,col=win)) +
geom_segment(aes(111,81,
xend = 111,yend = 110),
col='red') +
geom_segment(aes(111,81,
xend = 141,yend = 81),
col='red')+
annotate('text', x =130,y=95, label='Win', size=10,color='blue') +
annotate('text', x =95,y=85, label='Lose', size=10,color='red') +
labs(x='Points',y='Field Goals Attempted')
ggplot(regular)+
geom_point(aes(PTS,FGA,
shape=win,col=win)) +
geom_segment(aes(111,81,
xend = 111,yend = 110),
col='red') +
geom_segment(aes(111,81,
xend = 141,yend = 81),
col='red')+
annotate('text', x =130,y=95, label='Win', size=10,color='blue') +
annotate('text', x =95,y=85, label='Lose', size=10,color='potatoe') +
labs(x='Points',y='Field Goals Attempted')
ggplot(regular)+
geom_point(aes(PTS,FGA,
shape=win,col=win)) +
geom_segment(aes(111,81,
xend = 111,yend = 110),
col='red') +
geom_segment(aes(111,81,
xend = 141,yend = 81),
col='red')+
annotate('text', x =130,y=95, label='Win', size=10,color='blue') +
annotate('text', x =95,y=85, label='Lose', size=10,color='potatoes') +
labs(x='Points',y='Field Goals Attempted')
ggplot(regular)+
geom_point(aes(PTS,FGA,
shape=win,col=win)) +
geom_segment(aes(111,81,
xend = 111,yend = 110),
col='red') +
geom_segment(aes(111,81,
xend = 141,yend = 81),
col='red')+
annotate('text', x =130,y=95, label='Win', size=10,color='blue') +
annotate('text', x =95,y=85, label='Lose', size=10,color='tomatoes') +
labs(x='Points',y='Field Goals Attempted')
ggplot(regular)+
geom_point(aes(PTS,FGA,
shape=win,col=win)) +
geom_segment(aes(111,81,
xend = 111,yend = 110),
col='red') +
geom_segment(aes(111,81,
xend = 141,yend = 81),
col='red')+
annotate('text', x =130,y=95, label='Win', size=10,color='blue') +
annotate('text', x =95,y=85, label='Lose', size=10,color='tomatoe') +
labs(x='Points',y='Field Goals Attempted')
ggplot(regular)+
geom_point(aes(PTS,FGA,
shape=win,col=win)) +
geom_segment(aes(111,81,
xend = 111,yend = 110),
col='red') +
geom_segment(aes(111,81,
xend = 141,yend = 81),
col='red')+
annotate('text', x =130,y=95, label='Win', size=10,color='blue') +
annotate('text', x =95,y=85, label='Lose', size=10,color='tomato') +
labs(x='Points',y='Field Goals Attempted')
ggplot(regular)+
geom_point(aes(PTS,FGA,
shape=win,col=win)) +
geom_segment(aes(111,81,
xend = 111,yend = 110),
col='purple') +
geom_segment(aes(111,81,
xend = 141,yend = 81),
col='purple')+
annotate('text', x =130,y=95, label='Win', size=10,color='blue') +
annotate('text', x =95,y=85, label='Lose', size=10,color='tomato') +
labs(x='Points',y='Field Goals Attempted')
ggplot(regular)+
geom_point(aes(PTS,FGA,
shape=win,col=win)) +
geom_segment(aes(111,81,
xend = 111,yend = 110),
col='purple') +
geom_segment(aes(111,81,
xend = 141,yend = 81),
col='purple')+
annotate('text', x =130,y=95, label='Win', size=10,color='violet') +
annotate('text', x =95,y=85, label='Lose', size=10,color='tomato') +
labs(x='Points',y='Field Goals Attempted')
ggplot(regular)+
geom_point(aes(PTS,FGA,
shape=win,col=win)) +
geom_segment(aes(111,81,
xend = 111,yend = 110),
col='purple') +
geom_segment(aes(111,81,
xend = 141,yend = 81),
col='purple')+
annotate('text', x =130,y=95, label='Win', size=10,color='turquoise') +
annotate('text', x =95,y=85, label='Lose', size=10,color='tomato') +
labs(x='Points',y='Field Goals Attempted')
ggplot(regular)+
geom_point(aes(PTS,FGA,
shape=win,col=win)) +
geom_segment(aes(111,81,
xend = 111,yend = 110),
col='purple') +
geom_segment(aes(111,81,
xend = 141,yend = 81),
col='purple')+
annotate('text', x =130,y=95, label='Win', size=10,color='turquoise4') +
annotate('text', x =95,y=85, label='Lose', size=10,color='tomato') +
labs(x='Points',y='Field Goals Attempted')
setwd('F:\\Mysite\\Mysite')
blogdown:::serve_site()
data('Grunfeld', package = 'plm')
Grunfeld <- Grunfeld %>%
filter(year<1940,firm<6) %>%
mutate(year=as.factor(year),
firm=as.factor(firm))
plta <- ggplot(Grunfeld, aes(value,capital)) +
geom_point(aes(col=firm,shape=year),size=2) +
geom_smooth(method='lm',se=F,col='red') +
theme_bw() +
theme(legend.position = 'none')+
ylim(0,400)
pltb <- ggplot(Grunfeld, aes(value,capital,group=year)) +
geom_point(aes(col=firm,shape=year),size=2) +
geom_smooth(method='lm',se=F,col='red') +
theme_bw() +
theme(legend.position = 'none')+
ylim(0,400)
moda <- lm(capital ~ value + firm,Grunfeld)
grid <- Grunfeld %>%
data_grid(value,firm) %>%
gather_predictions(moda)
blogdown:::stop_server()
