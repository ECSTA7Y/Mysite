---
title: "使用R Studio运行LaTeX"
author: " "
date: 2019-06-08
categories: ["R"]
slug: rsweave
tags: ["R Markdown"]
---


我平时喜欢使用LaTeX写文档。而因为种种原因，我一直以来用的是[MikTeX](https://miktex.org/)（虽然它常常因为简陋的功能为人诟病）。

而之所以不使用[TeXmaker](http://www.xm1math.net/texmaker/)或是[CTeX](http://www.ctex.org/HomePage)是因为它们容易出Bug而且不简约（主要是因为懒得花时间学）。个人认为MikTeX是最轻量级的TeX了。然而，MikTeX的界面过于简单粗暴，并且无法更换背景颜色（我喜欢使用深色界面保护视力，但MikTeX无法修改）。

```{r sur22, echo=F, fig.cap=" ", out.width = '60%',fig.align='center',fig.cap='MikTeX界面'}
knitr::include_graphics("/img/sweave/mmk.jpg")

```

然而，R Studio的界面漂亮简单。也可以选择保护视力的深色主题。况且作为R用户，将写作、制作幻灯片、统计分析等工作整合到R Studio也大大提升了工作效率。如何做到这一点呢？

首先要安装LaTeX环境。安装后R会自动识别这个环境。Windows用户请注意，**MikTeX一定要安装在全英文路径下！** **MikTeX一定要安装在全英文路径下！** **MikTeX一定要安装在全英文路径下！**

后续需要安装一些R包，如`Knitr`，`tinytex`等（具体的R包我就不列出了，如果你没有安装，R会提示你的）。

然后需要配置一下R Studio的环境:

```{r sur1, echo=F, fig.cap=" ", out.width = '60%',fig.align='center',fig.cap='依次点击Tools - Global Options - Sweave配置Sweave环境'}
knitr::include_graphics("/img/sweave/tempsnip.png")
```

其中，`Weave Rnw files using`选`knitr`。想要写中文LaTeX文档必须选`XeLaTeX`环境。

我们点击`Open File`打开一个LaTeX文档：

```{r spdf, echo=F, fig.cap=" ", out.width = '70%',fig.align='center',fig.cap='点击Open File打开一个LaTeX文档'}
knitr::include_graphics("/img/sweave/cut.JPG")
```

打开后，可以直接在R Studio中进行编辑写作。完成后，点击上方Complie PDF编译LaTeX文档，如图：

```{r click, echo=F, fig.cap=" ", out.width = '70%',fig.align='center',fig.cap='点击Complie PDF编译LaTeX文档'}
knitr::include_graphics("/img/sweave/tempsnip2.png")
```


编译成功的PDF文档（是我用于某课程pre的[LaTeX Beamer](http://deic.uab.es/~iblanes/beamer_gallery/index_by_theme.html)）如图：

```{r click2, echo=F, fig.cap=" ", out.width = '70%',fig.align='center',fig.cap='编译好的PDF文档'}
knitr::include_graphics("/img/sweave/beamer.jpg")
```

编辑公式我使用[Mathtype](http://www.mathtype.cn/)。它的好处在于可以直接将公式复制为LaTeX代码(需要事先设置好`剪切和复制预置`选项)：


```{r type, echo=F, fig.cap=" ", out.width = '80%',fig.align='center',fig.cap='Mathtype编辑器'}
knitr::include_graphics("/img/sweave/mathtype.jpg")
```

如，以上的公式可以直接复制为如下的纯文本LaTeX公式：

```python
$$\ln {h_i}(t) = \ln {h_0}(t) + {\beta _1}{X_1} + {\beta _2}{X_2} +  \cdot  \cdot  \cdot  + {\beta _p}{X_p}$$
```

---

## 使用R Sweave

另一个方案是使用[R Sweave](https://cosx.org/2010/11/reproducible-research-in-statistics)。


R Sweave的主要功能并不是一个写纯LaTeX文档，而是为了将R代码嵌入LaTeX形成动态PDF报告。当然，作为日常工作，使用R Sweave写文档而不运行代码是完全可以的(只不过有点大材小用)。

方法很简单，新建一个R Sweave文档，然后在里面编辑LaTeX，之后运行就可以了。

```{r rnw, echo=F, fig.cap=" ", out.width = '25%',fig.align='center',fig.cap='新建一个R Sweave文档'}
knitr::include_graphics("/img/sweave/rnw.png")
```

R Sweave文档以.Rnw为后缀，它可以将R代码整合到LaTeX中去。当然，因为语法的复杂性，R Sweave的功能很大程度上被[R Markdown](https://rmarkdown.rstudio.com/)代替了。

有关R Sweave的一个较为详细的介绍参见[这里](https://cosx.org/2010/11/reproducible-research-in-statistics)。

很久以前的公众号文章《使用R Sweave运行LaTeX》请点击[这里](https://mp.weixin.qq.com/s/1JU2ILRt9E7jYyUKilDX8A)。



