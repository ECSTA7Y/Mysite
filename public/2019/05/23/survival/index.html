<!DOCTYPE html>
<html lang="en-us">
  <head>
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Hugo 0.55.5" />


<title>生存分析云笔记 - Xiao Song </title>
<meta property="og:title" content="生存分析云笔记 - Xiao Song ">


  <link href='../../../../favicon.ico' rel='icon' type='image/x-icon'/>



  







<link rel="stylesheet" href="../../../../css/fonts.css" media="all">
<link rel="stylesheet" href="../../../../css/main.css" media="all">



  </head>
  <body>
    <div class="wrapper">
      <header class="header">
        <nav class="nav">
  <a href="../../../../" class="nav-logo">
    <img src="../../../../images/logo.png"
         width="50"
         height="50"
         alt="Logo">
  </a>

  <ul class="nav-links">
    
    <li><a href="../../../../">Home</a></li>
    
    <li><a href="../../../../englishresume/">Resume</a></li>
    
    <li><a href="../../../../chnresume/">Chinese Resume</a></li>
    
    <li><a href="https://github.com/ECSTA7Y">GitHub</a></li>
    
  </ul>
</nav>

      </header>

<link rel="stylesheet">

<main class="content" role="main">

  <article class="article">

    <h1 class="article-title">生存分析云笔记</h1>

    
    <span class="article-date">2019-05-23</span>
    

    <div class="article-content">
      


<p>本文来源于复旦大学人口学系<a href="http://www.ssdpp.fudan.edu.cn/portal/1e2812ee711c4175a3304c7dbc7071e0/70VhqG.html">张震</a>老师的数据分析课程笔记。</p>
<p>一个R生存分析应用的介绍网页<a href="https://rviews.rstudio.com/2017/09/25/survival-analysis-with-r/">Survival Analysis with R</a></p>
<p>两篇重要的中文文献：</p>
<p>李强, 张震. (2009). 生存分析中时间变量的选择[J]. 中国人口科学(6), 88-95.</p>
<p>李强, 徐刚, 陈丽梅.(2019) 生存分析的应用误区[J]. 中国人口科学(01):101-112.</p>
<div id="-" class="section level2">
<h2>第一讲: 基本概念</h2>
<ul>
<li>社会调查只能观察到状态。人口学关心从一个状态到另一个状态转移的风险。试想每一种状态是一个格子，格子内部是人口频数。人口学能通过数频数的方式估计状态转移的风险。<strong>在一个状态内待的时间和风险有着密切的关系</strong>。</li>
</ul>
<p><span class="math inline">\(T\)</span>为随机变量，上帝也不知道</p>
<p>生存函数：<span class="math inline">\(S(t) = P(T &gt; t)\)</span>。是存活概率也是存活百分比。</p>
<p>失效函数(Failure Function)：<span class="math inline">\(F(t)\)</span>,<span class="math inline">\(S(t) = 1 - F(t)\)</span>, <span class="math inline">\(F(t)\)</span>是T的累积分布函数。</p>
<p><span class="math inline">\(f(t) = \frac{{dF(t)}}{{dt}}\)</span>，即<span class="math inline">\(S(t)\)</span>的斜率。等价于生存时间的概率密度函数(直方图)。是无条件的风险。</p>
<p>风险函数: <span class="math display">\[h(t) = \mathop {\lim }\limits_{\Delta t \to 0} \frac{{P(t \le T &lt; t + \Delta t|T \ge t)}}{{\Delta t}},0 &lt; h(t) &lt;  + \infty \]</span></p>
<p><span class="math inline">\(h(t)\)</span>不是密度也不是概率。</p>
<ul>
<li>censor(删截): 知道事件发生，但不知道事件何时发生。事件观测期内无法观测。</li>
<li><p>truncate(截平): 只有在给定观测期内的个体才会被观测到的状况。样本选择问题。生存函数对应于某种条件概率。</p></li>
<li><p>censor涉及到事件，truncate涉及到暴露量。</p></li>
<li><p>能活到预期寿命者总是62%</p></li>
</ul>
<hr />
</div>
<div id="-mle" class="section level2">
<h2>第二讲: 最大似然估计(MLE)</h2>
<p>Cox回归避开了模型分布假定的问题。</p>
<ul>
<li><p>假定数据独立同分布。</p>
<p>似然函数：</p></li>
</ul>
<p><span class="math display">\[{\rm{L}}(\lambda ){\rm{ = }}\prod\limits_{i = 1}^\pi  {P(T = t)}  = \prod {f({t_i})}\]</span><br />
<span class="math inline">\(\delta\)</span>是积分小区间</p>
<p><span class="math display">\[P(T = t) \approx 2\delta f(t)\]</span></p>
<ul>
<li>发生风险率(Occurrence-exposure rate) <span class="math display">\[\widehat \lambda  = \frac{1}{{\bar t }} = \frac{n}{{\sum\limits_{}^{} {{t_i}} }}\]</span> <span class="math inline">\(\sum\limits_{}^{} {{t_i}}\)</span>是历险人年数。<span class="math inline">\(n\)</span>是事件发生数。<br />
<span class="math inline">\(\lambda\)</span>是个概率估计。</li>
</ul>
<div id="censored" class="section level3">
<h3>删截(Censored)样本的似然函数</h3>
<ul>
<li>完全样本的似然函数是在该时点t的密度函数<span class="math inline">\(f({t_i})\)</span>。右删截数据是生存函数<span class="math inline">\(S({C_r})\)</span>。左删截数据为累计分布函数<span class="math inline">\(1 - S({C_l})\)</span>。区间删截为在该时段内的发生概率<span class="math inline">\(S(L) - S(R)\)</span>。</li>
</ul>
<p>右删截： <span class="math display">\[P({t_i} &gt; 40) = S(40)\]</span></p>
<ul>
<li>40岁删截</li>
</ul>
<p><span class="math display">\[L(\lambda ) = \prod\limits_{observed} {f({t_i})}  \cdot \prod\limits_{censored} {S(40)}\]</span></p>
<p>Assume the first <span class="math inline">\(d\)</span> individuals died, <span class="math inline">\((n-d)\)</span> ware alive at 40:</p>
<p><span class="math display">\[\hat \lambda  = \frac{d}{{\sum {{t_i} - (n - d) \cdot 40} }}\]</span></p>
<p>分子为事件发生数。</p>
<p>人口学、医学中最多的情况是left-truncated &amp; right-cencored(LT-RC)数据。</p>
<p>非参数模型Aalen’s additive regression model可以替代Cox模型。R的<code>survival</code>包的<code>aareg</code>函数可以进行拟合。</p>
</div>
</div>

    </div>
  </article>

  
<section id="comments">
  <div id="disqus_thread"></div>
  <script>
  var disqus_config = function () {
  
  };
  (function() {
    var inIFrame = function() {
      var iframe = true;
      try { iframe = window.self !== window.top; } catch (e) {}
      return iframe;
    };
    if (inIFrame()) return;
    var d = document, s = d.createElement('script');
    s.src = '//Xiao Song.disqus.com/embed.js'; s.async = true;
    s.setAttribute('data-timestamp', +new Date());
    (d.head || d.body).appendChild(s);
  })();
  </script>
  <noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</section>



</main>

      <footer class="footer">
        <ul class="footer-links">
          
        </ul>
      </footer>

    </div>
    

    
<script src="../../../../js/math-code.js"></script>
<script async src="//cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML"></script>


    
  </body>
</html>

