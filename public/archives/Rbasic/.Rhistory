install.packages('psych')
library(psych)
data(USJudgeRatings)
USJudgeRatings
View(USJudgeRatings)
USJudgeRatings
head(USJudgeRatings)
knitr::kable(head(USJudgeRatings))
library(psych)
fa.parallel(USJudgeRatings[,-1], fa="pc", n.iter=100,
show.legend=FALSE, main="Scree plot with parallel analysis")
fa.parallel(USJudgeRatings[,-1], fa="pc", n.iter=100,
show.legend=FALSE, main="碎石图")
library(psych)
fa.parallel(USJudgeRatings[,-1], fa="pc", n.iter=100,
show.legend=F, main="碎石图")
pc <- principal(USJudgeRatings[,-1], nfactors=1, rotate="varimax", score=T) #方差极大旋转
pc
USJudgeRatings$score <- pc$scores
knitr::kable(head(USJudgeRatings$score))
View(USJudgeRatings)
library(haven)
V1_0718 <- read_sav("C:/Users/xsong/Desktop/V1-0718.sav")
View(V1_0718)
WWD <- read.csv("C:/Users/xsong/Desktop/WWD.csv")
View(WWD)
dt.car <- read.csv("C:/Users/xsong/Desktop/WWD.csv")
head(dt.car)
View(dt.car)
in the map
library(readxl)
mapdata <- read_excel("E:/R_codes/ggplot2map/geodata0131.xlsx")
View(mapdata)
library(reshape2)
long<- melt(china_data, id=c("long", "lat","group"))
rm(list=ls())
library(haven)
china_map_data <- read_dta("E:/R_codes/maps/nomissing/chnprovcd.dta")
library(plyr); library(dplyr)
# prepare work data, which needed to be filled in the map
library(readxl)
mapdata <- read_excel("E:/R_codes/ggplot2map/geodata0131.xlsx")
mapdata <- as.data.frame(mapdata)
mapdata <- select(mapdata,-(NAME)) #reverse selection
china_data <- join(china_map_data, mapdata, type="full")
china_data <- select(china_data,long,lat,group,out12,in12,out14,in14,out16,in16)
library(reshape2)
long<- melt(china_data, id=c("long", "lat","group"))
View(long)
long %>%
mutate(variable=ifelse(variable=='12out','2012土地流出',variable))
library(tidyverse)
long %>%
mutate(variable=ifelse(variable=='12out','2012土地流出',variable))
?within
library(tidyverse)
dta <- dt.car %>%
select(S5,S6__1__open,D5,D6,D3,S10B,Q7__1:Q7__35,A0__1:A0__27)
dt.car <- read.csv("C:/Users/xsong/Desktop/table/WWD.csv")
library(tidyverse)
dta <- dt.car %>%
select(S5,S6__1__open,D5,D6,D3,S10B,Q7__1:Q7__35,A0__1:A0__27)
View(dta)
View(dt.car)
dta <- dt.car %>%
select(S5,S6__1__open,D5,D6,D3,S10B,Q7__1:Q7__35,A0__1:A0__27) %>% #筛选列
rename(age=S6__1__open,)#重命名
View(dta)
dta <- within(dta,{
eduy <- NA
eduy[edu=='初中'] <- 9
eduy[edu=='大学本科 - 国内'| edu=='大学本科 - 国外'] <- 16
eduy[edu=='大专'] <- 15
eduy[edu=='高中'] <- 12
eduy[edu=='技术/职业学校/中专'] <- 12
eduy[edu=='研究生或以上 - 国内'] <- 20
})
dta <- dt.car %>%
select(S5,S6__1__open,D5,D6,D3,S10B,Q7__1:Q7__35,A0__1:A0__27) %>% #筛选列
rename(age=S6__1__open,edu=D3)#重命名
#
dta <- within(dta,{
eduy <- NA
eduy[edu=='初中'] <- 9
eduy[edu=='大学本科 - 国内'| edu=='大学本科 - 国外'] <- 16
eduy[edu=='大专'] <- 15
eduy[edu=='高中'] <- 12
eduy[edu=='技术/职业学校/中专'] <- 12
eduy[edu=='研究生或以上 - 国内'] <- 20
})
dta <- dta %>%
select(edu,eduy,everything())
library(dplyr)
?recode
dt.car <- read.csv("C:/Users/xsong/Desktop/table/WWD.csv")
dta <- dt.car %>%
select(S5,S6__1__open,D5,D6,D3,S10B,Q7__1:Q7__35,A0__1:A0__27) %>% #筛选列
rename(age=S6__1__open,edu=D3) %>%#重命名
mutate(eduy=recode(edu,'初中'=9,'大学本科 - 国内'=16,'大专'=15,'高中'=12,'研究生或以上 - 国内'=20))
#
dta <- dta %>%
select(edu,eduy,everything())
dt.car <- read.csv("C:/Users/xsong/Desktop/table/WWD.csv")
dta <- dt.car %>%
select(S5,S6__1__open,D5,D6,D3,S10B,Q7__1:Q7__35,A0__1:A0__27) %>% #筛选列
rename(age=S6__1__open,edu=D3) %>%#重命名
mutate(eduy=fct_recode(edu,'初中'=9,'大学本科 - 国内'=16,'大专'=15,'高中'=12,'研究生或以上 - 国内'=20))
dt.car <- read.csv("C:/Users/xsong/Desktop/table/WWD.csv")
dta <- dt.car %>%
select(S5,S6__1__open,D5,D6,D3,S10B,Q7__1:Q7__35,A0__1:A0__27) %>% #筛选列
rename(age=S6__1__open,edu=D3) %>%#重命名
mutate(eduy=recode(edu,'初中'=9,'大学本科 - 国内'=16,'大学本科 - 国外'=16,'大专'=15,'高中'=12,'技术/职业学校/中专'=12,'研究生或以上 - 国内'=20))
dta <- dta %>%
select(edu,eduy,everything())
dta[Q7__1:Q7__35]
dta[Q7__1]
dta[Q7_1]
library(tidyverse)
dt.car <- read.csv("C:/Users/xsong/Desktop/table/WWD.csv")
dta <- dt.car %>%
select(S5,S6__1__open,D5,D6,D3,S10B,Q7__1:Q7__35,A0__1:A0__27) %>% #筛选列
rename(age=S6__1__open,edu=D3) %>% #重命名
mutate(eduy=recode(edu,'初中'=9,
'大学本科 - 国内'=16,
'大学本科 - 国外'=16,
'大专'=15,
'高中'=12,
'技术/职业学校/中专'=12,
'研究生或以上 - 国内'=20)) %>% #重编码
select(edu,eduy,everything()) #
dta[Q7__1]
dta[,Q7__1:Q7__35]
dta[,c(Q7__1:Q7__35)]
?lapply
lapply(pcdata,mean)
pcdata <- dta %>% #ctrl+shift+m
select(Q7__1:Q7__35)
lapply(pcdata,mean)
?aggregate
?lapply
pcdata <- dta %>% #ctrl+shift+m
select(Q7__1:Q7__35)
for(i in 1:ncol(pcdata)) pcdata <- within(pcdata,{
pcdata[pcdata[,i]=='非常同意'] <- 1
pcdata[pcdata[,i]=='比较同意'] <- 2
pcdata[pcdata[,i]=='谈不上同不同意'] <- 3
pcdata[pcdata[,i]=='比较不同意'] <- 4
pcdata[pcdata[,i]=='完全不同意'] <- 5
})
for(i in 1:ncol(pcdata)) pcdata <- within(pcdata,{
pcdata[pcdata[,i]=='非常同意1'] <- 1
pcdata[pcdata[,i]=='比较同意2'] <- 2
pcdata[pcdata[,i]=='谈不上同不同意3'] <- 3
pcdata[pcdata[,i]=='比较不同意4'] <- 4
pcdata[pcdata[,i]=='完全不同意5'] <- 5
})
View(pcdata)
for(i in 1:ncol(pcdata)){pcdata <- within(pcdata,{
pcdata[pcdata[,i]=='非常同意1'] <- 1
pcdata[pcdata[,i]=='比较同意2'] <- 2
pcdata[pcdata[,i]=='谈不上同不同意3'] <- 3
pcdata[pcdata[,i]=='比较不同意4'] <- 4
pcdata[pcdata[,i]=='完全不同意5'] <- 5
})}
for(i in 1:ncol(pcdata)) pcdata <- within(pcdata,{
pcdata[,i][pcdata[,i]=='非常同意1'] <- 1
pcdata[,i][pcdata[,i]=='比较同意2'] <- 2
pcdata[,i][pcdata[,i]=='谈不上同不同意3'] <- 3
pcdata[,i][pcdata[,i]=='比较不同意4'] <- 4
pcdata[,i][pcdata[,i]=='完全不同意5'] <- 5
})
pcdata <- within(pcdata,{
pcdata[,1][pcdata[,1]=='非常同意1'] <- 1
})
for(i in 1:ncol(pcdata)) pcdata[,i][pcdata[,i]=='非常同意1'] <- 1
pcdata <- dta %>% #ctrl+shift+m
select(Q7__1:Q7__35)
for(i in 1:ncol(pcdata)) pcdata[,i][pcdata[,i]=='非常同意1'] <- 1
pcdata <- dta %>% #ctrl+shift+m
select(Q7__1:Q7__35)
for(i in 1:ncol(pcdata))
pcdata[,i][pcdata[,i]=='非常同意1'] <- 1
pcdata[,i][pcdata[,i]=='比较同意2'] <- 2
pcdata[,i][pcdata[,i]=='谈不上同不同意3'] <- 3
pcdata <- dta %>% #ctrl+shift+m
select(Q7__1:Q7__35)
for(i in 1:ncol(pcdata))
pcdata[,i+35][pcdata[,i]=='非常同意1'] <- 1
pcdata <- dta %>% #ctrl+shift+m
select(Q7__1:Q7__35)
for(i in 1:ncol(pcdata))
pcdata[,i+35] <- 0
pcdata[,i+35][pcdata[,i]=='非常同意1'] <- 1
pcdata[,i+35][pcdata[,i]=='比较同意2'] <- 2
pcdata[,i+35][pcdata[,i]=='谈不上同不同意3'] <- 3
pcdata <- dta %>% #ctrl+shift+m
select(Q7__1:Q7__35)
for(i in 1:ncol(pcdata)) {
pcdata[,i+35] <- 0
pcdata[,i+35][pcdata[,i]=='非常同意1'] <- 1
pcdata[,i+35][pcdata[,i]=='比较同意2'] <- 2
pcdata[,i+35][pcdata[,i]=='谈不上同不同意3'] <- 3
}
pcdata <- dta %>% #ctrl+shift+m
select(Q7__1:Q7__35)
for(i in 1:ncol(pcdata)) {
pcdata[,i][pcdata[,i]=='非常同意1'] <- 1
pcdata[,i][pcdata[,i]=='比较同意2'] <- 2
pcdata[,i][pcdata[,i]=='谈不上同不同意3'] <- 3
}
pcdata <- dta %>% #ctrl+shift+m
select(Q7__1:Q7__35)
for(i in 1:ncol(pcdata)) {
pcdata[,i+35] <- 0
pcdata[,i+35][pcdata[,i]=='非常同意1'] <- 1
pcdata[,i+35][pcdata[,i]=='比较同意2'] <- 2
pcdata[,i+35][pcdata[,i]=='谈不上同不同意3'] <- 3
pcdata[,i+35][pcdata[,i]=='比较不同意4'] <- 4
pcdata[,i+35][pcdata[,i]=='完全不同意5'] <- 5
}
pcdata <- dta %>% #ctrl+shift+m
select(-(Q7__1:Q7__35))
pcdata <- dta %>% #ctrl+shift+m
select(Q7__1:Q7__35)
for(i in 1:ncol(pcdata)) {
pcdata[,i+35] <- 0
pcdata[,i+35][pcdata[,i]=='非常同意1'] <- 1
pcdata[,i+35][pcdata[,i]=='比较同意2'] <- 2
pcdata[,i+35][pcdata[,i]=='谈不上同不同意3'] <- 3
pcdata[,i+35][pcdata[,i]=='比较不同意4'] <- 4
pcdata[,i+35][pcdata[,i]=='完全不同意5'] <- 5
}
pcdata <- pcdata %>% #ctrl+shift+m
select(-(Q7__1:Q7__35))
pcdata <- dta %>% #ctrl+shift+m
select(Q7__1:Q7__35)
for(i in 1:ncol(pcdata)) {
pcdata[,i+35] <- 0
pcdata[,i+35][pcdata[,i]=='非常同意1'] <- 1
pcdata[,i+35][pcdata[,i]=='比较同意2'] <- 2
pcdata[,i+35][pcdata[,i]=='谈不上同不同意3'] <- 3
pcdata[,i+35][pcdata[,i]=='比较不同意4'] <- 4
pcdata[,i+35][pcdata[,i]=='完全不同意5'] <- 5
}
pcdata <- pcdata %>% #ctrl+shift+m
select(-(Q7__1:Q7__35))
pcdata <- dta %>% #ctrl+shift+m
select(Q7__1:Q7__35)
for(i in 1:35) {
pcdata[,i+35] <- 0
pcdata[,i+35][pcdata[,i]=='非常同意1'] <- 1
pcdata[,i+35][pcdata[,i]=='比较同意2'] <- 2
pcdata[,i+35][pcdata[,i]=='谈不上同不同意3'] <- 3
pcdata[,i+35][pcdata[,i]=='比较不同意4'] <- 4
pcdata[,i+35][pcdata[,i]=='完全不同意5'] <- 5
}
pcdata <- pcdata %>% #ctrl+shift+m
select(-(Q7__1:Q7__35))
ncol(pcdata)
